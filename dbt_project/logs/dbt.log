[0m16:57:46.729639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fc9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3fdf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3fe230>]}


============================== 16:57:46.735261 | fb26e286-2d62-429e-b8d3-47dace3a60c4 ==============================
[0m16:57:46.735261 [info ] [MainThread]: Running with dbt=1.7.14
[0m16:57:46.736585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt dbt debug --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'send_anonymous_usage_stats': 'True'}
[0m16:57:46.738500 [info ] [MainThread]: dbt version: 1.7.14
[0m16:57:46.739239 [info ] [MainThread]: python version: 3.10.14
[0m16:57:46.740344 [info ] [MainThread]: python path: /Users/patrickroch/.vscode/extensions/.turntable-venv/bin/python
[0m16:57:46.741864 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m16:57:48.412541 [info ] [MainThread]: Using profiles dir at /Users/patrickroch/Documents/pocdbt/dbt_project
[0m16:57:48.413477 [info ] [MainThread]: Using profiles.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/profiles.yml
[0m16:57:48.414425 [info ] [MainThread]: Using dbt_project.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml
[0m16:57:48.415528 [info ] [MainThread]: adapter type: postgres
[0m16:57:48.416342 [info ] [MainThread]: adapter version: 1.7.14
[0m16:57:48.617003 [info ] [MainThread]: Configuration:
[0m16:57:48.617796 [info ] [MainThread]:   profiles.yml file [OK found and valid]
[0m16:57:48.618451 [info ] [MainThread]:   dbt_project.yml file [ERROR invalid]
[0m16:57:48.619120 [info ] [MainThread]: Required dependencies:
[0m16:57:48.619887 [debug] [MainThread]: Executing "git --help"
[0m16:57:48.641244 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:57:48.642875 [debug] [MainThread]: STDERR: "b''"
[0m16:57:48.643985 [info ] [MainThread]:  - git [OK found]

[0m16:57:48.644903 [info ] [MainThread]: Connection:
[0m16:57:48.645815 [info ] [MainThread]:   host: postgres-dev
[0m16:57:48.646526 [info ] [MainThread]:   port: 5432
[0m16:57:48.647162 [info ] [MainThread]:   user: user
[0m16:57:48.647800 [info ] [MainThread]:   database: dev_db
[0m16:57:48.648446 [info ] [MainThread]:   schema: public
[0m16:57:48.649236 [info ] [MainThread]:   connect_timeout: 10
[0m16:57:48.649919 [info ] [MainThread]:   role: None
[0m16:57:48.650567 [info ] [MainThread]:   search_path: None
[0m16:57:48.651204 [info ] [MainThread]:   keepalives_idle: 0
[0m16:57:48.651844 [info ] [MainThread]:   sslmode: None
[0m16:57:48.652477 [info ] [MainThread]:   sslcert: None
[0m16:57:48.653124 [info ] [MainThread]:   sslkey: None
[0m16:57:48.653793 [info ] [MainThread]:   sslrootcert: None
[0m16:57:48.654422 [info ] [MainThread]:   application_name: dbt
[0m16:57:48.655075 [info ] [MainThread]:   retries: 1
[0m16:57:48.656149 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m16:57:48.766682 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:57:48.768496 [debug] [MainThread]: Using postgres connection "debug"
[0m16:57:48.769264 [debug] [MainThread]: On debug: select 1 as id
[0m16:57:48.769965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:49.134615 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known

[0m16:57:49.138539 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m16:57:49.139340 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:57:49.140085 [debug] [MainThread]: On debug: No close available on handle
[0m16:57:49.140839 [info ] [MainThread]:   Connection test: [ERROR]

[0m16:57:49.141771 [info ] [MainThread]: 2 checks failed:
[0m16:57:49.142618 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['name']: 'dbt-poc' does not match '^[^\\d\\W]\\w*$'

Error encountered in /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml


[0m16:57:49.143404 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:57:49.250044 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.6751895, "process_user_time": 5.024893, "process_kernel_time": 0.856373, "process_mem_max_rss": "157036544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:49.251351 [debug] [MainThread]: Command `cli debug` failed at 16:57:49.251057 after 2.68 seconds
[0m16:57:49.252142 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:57:49.252993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fc9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b837790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b8375b0>]}
[0m16:57:49.253984 [debug] [MainThread]: Flushing usage events
[0m18:44:15.652452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f8d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263c1f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263c2230>]}


============================== 18:44:15.658536 | 1c3eb7e5-f937-4ecb-b4da-bd38048ca72c ==============================
[0m18:44:15.658536 [info ] [MainThread]: Running with dbt=1.7.14
[0m18:44:15.659582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt dbt debug --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:15.661122 [info ] [MainThread]: dbt version: 1.7.14
[0m18:44:15.661841 [info ] [MainThread]: python version: 3.10.14
[0m18:44:15.662476 [info ] [MainThread]: python path: /Users/patrickroch/.vscode/extensions/.turntable-venv/bin/python
[0m18:44:15.663103 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:44:15.827529 [info ] [MainThread]: Using profiles dir at /Users/patrickroch/Documents/pocdbt/dbt_project
[0m18:44:15.828355 [info ] [MainThread]: Using profiles.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/profiles.yml
[0m18:44:15.829027 [info ] [MainThread]: Using dbt_project.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml
[0m18:44:15.830340 [info ] [MainThread]: adapter type: postgres
[0m18:44:15.831019 [info ] [MainThread]: adapter version: 1.7.14
[0m18:44:16.057435 [info ] [MainThread]: Configuration:
[0m18:44:16.058239 [info ] [MainThread]:   profiles.yml file [OK found and valid]
[0m18:44:16.058888 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
[0m18:44:16.059530 [info ] [MainThread]: Required dependencies:
[0m18:44:16.060278 [debug] [MainThread]: Executing "git --help"
[0m18:44:16.081857 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:44:16.083612 [debug] [MainThread]: STDERR: "b''"
[0m18:44:16.084447 [info ] [MainThread]:  - git [OK found]

[0m18:44:16.085147 [info ] [MainThread]: Connection:
[0m18:44:16.085889 [info ] [MainThread]:   host: postgres-dev
[0m18:44:16.086523 [info ] [MainThread]:   port: 5432
[0m18:44:16.087140 [info ] [MainThread]:   user: user
[0m18:44:16.087745 [info ] [MainThread]:   database: dev_db
[0m18:44:16.088360 [info ] [MainThread]:   schema: public
[0m18:44:16.088973 [info ] [MainThread]:   connect_timeout: 10
[0m18:44:16.089807 [info ] [MainThread]:   role: None
[0m18:44:16.090512 [info ] [MainThread]:   search_path: None
[0m18:44:16.091155 [info ] [MainThread]:   keepalives_idle: 0
[0m18:44:16.091779 [info ] [MainThread]:   sslmode: None
[0m18:44:16.092393 [info ] [MainThread]:   sslcert: None
[0m18:44:16.093010 [info ] [MainThread]:   sslkey: None
[0m18:44:16.093623 [info ] [MainThread]:   sslrootcert: None
[0m18:44:16.094363 [info ] [MainThread]:   application_name: dbt
[0m18:44:16.095168 [info ] [MainThread]:   retries: 1
[0m18:44:16.096166 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m18:44:16.110177 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:44:16.111927 [debug] [MainThread]: Using postgres connection "debug"
[0m18:44:16.112649 [debug] [MainThread]: On debug: select 1 as id
[0m18:44:16.113514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:16.331690 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known

[0m18:44:16.335627 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m18:44:16.336373 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:44:16.337111 [debug] [MainThread]: On debug: No close available on handle
[0m18:44:16.338179 [info ] [MainThread]:   Connection test: [ERROR]

[0m18:44:16.339132 [info ] [MainThread]: 1 check failed:
[0m18:44:16.339900 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:44:16.344054 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.8516882, "process_user_time": 5.239322, "process_kernel_time": 0.841882, "process_mem_max_rss": "157368320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:44:16.345634 [debug] [MainThread]: Command `cli debug` failed at 18:44:16.345308 after 0.85 seconds
[0m18:44:16.346530 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:44:16.347646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f8d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126742350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126778e20>]}
[0m18:44:16.348887 [debug] [MainThread]: Flushing usage events
[0m19:02:40.925395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126122920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12753df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12753e290>]}


============================== 19:02:40.932175 | 487d990b-a8e3-4feb-b68e-d69c58d0b9e6 ==============================
[0m19:02:40.932175 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:02:40.933264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt dbt debug --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:40.934407 [info ] [MainThread]: dbt version: 1.7.14
[0m19:02:40.935110 [info ] [MainThread]: python version: 3.10.14
[0m19:02:40.935783 [info ] [MainThread]: python path: /Users/patrickroch/.vscode/extensions/.turntable-venv/bin/python
[0m19:02:40.936888 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m19:02:41.123383 [info ] [MainThread]: Using profiles dir at /Users/patrickroch/Documents/pocdbt/dbt_project
[0m19:02:41.124406 [info ] [MainThread]: Using profiles.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/profiles.yml
[0m19:02:41.125221 [info ] [MainThread]: Using dbt_project.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml
[0m19:02:41.126496 [info ] [MainThread]: adapter type: postgres
[0m19:02:41.127170 [info ] [MainThread]: adapter version: 1.7.14
[0m19:02:41.358621 [info ] [MainThread]: Configuration:
[0m19:02:41.359437 [info ] [MainThread]:   profiles.yml file [OK found and valid]
[0m19:02:41.360080 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
[0m19:02:41.360719 [info ] [MainThread]: Required dependencies:
[0m19:02:41.361461 [debug] [MainThread]: Executing "git --help"
[0m19:02:41.383347 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:02:41.384959 [debug] [MainThread]: STDERR: "b''"
[0m19:02:41.385746 [info ] [MainThread]:  - git [OK found]

[0m19:02:41.386448 [info ] [MainThread]: Connection:
[0m19:02:41.387269 [info ] [MainThread]:   host: postgres-dev
[0m19:02:41.388021 [info ] [MainThread]:   port: 5432
[0m19:02:41.388683 [info ] [MainThread]:   user: user
[0m19:02:41.389318 [info ] [MainThread]:   database: dev_db
[0m19:02:41.389985 [info ] [MainThread]:   schema: public
[0m19:02:41.390631 [info ] [MainThread]:   connect_timeout: 10
[0m19:02:41.391269 [info ] [MainThread]:   role: None
[0m19:02:41.391912 [info ] [MainThread]:   search_path: None
[0m19:02:41.392677 [info ] [MainThread]:   keepalives_idle: 0
[0m19:02:41.393383 [info ] [MainThread]:   sslmode: None
[0m19:02:41.394022 [info ] [MainThread]:   sslcert: None
[0m19:02:41.394648 [info ] [MainThread]:   sslkey: None
[0m19:02:41.395267 [info ] [MainThread]:   sslrootcert: None
[0m19:02:41.395889 [info ] [MainThread]:   application_name: dbt
[0m19:02:41.396510 [info ] [MainThread]:   retries: 1
[0m19:02:41.397473 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:02:41.410658 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:02:41.412416 [debug] [MainThread]: Using postgres connection "debug"
[0m19:02:41.413172 [debug] [MainThread]: On debug: select 1 as id
[0m19:02:41.413838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:41.629186 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known

[0m19:02:41.633584 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m19:02:41.634468 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m19:02:41.635478 [debug] [MainThread]: On debug: No close available on handle
[0m19:02:41.636361 [info ] [MainThread]:   Connection test: [ERROR]

[0m19:02:41.637419 [info ] [MainThread]: 1 check failed:
[0m19:02:41.638201 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:02:41.644122 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.8882759, "process_user_time": 5.258857, "process_kernel_time": 0.680054, "process_mem_max_rss": "158769152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:02:41.645958 [debug] [MainThread]: Command `cli debug` failed at 19:02:41.645547 after 0.89 seconds
[0m19:02:41.646956 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:02:41.647797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126122920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275dfc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274b6e30>]}
[0m19:02:41.648849 [debug] [MainThread]: Flushing usage events
[0m19:03:08.029398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e3e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123255f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123256290>]}


============================== 19:03:08.035513 | 43104c39-c02b-4944-89df-820b38669d15 ==============================
[0m19:03:08.035513 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:03:08.036908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt dbt debug --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:03:08.038231 [info ] [MainThread]: dbt version: 1.7.14
[0m19:03:08.038947 [info ] [MainThread]: python version: 3.10.14
[0m19:03:08.039605 [info ] [MainThread]: python path: /Users/patrickroch/.vscode/extensions/.turntable-venv/bin/python
[0m19:03:08.040264 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m19:03:08.188091 [info ] [MainThread]: Using profiles dir at /Users/patrickroch/Documents/pocdbt/dbt_project
[0m19:03:08.188922 [info ] [MainThread]: Using profiles.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/profiles.yml
[0m19:03:08.189618 [info ] [MainThread]: Using dbt_project.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml
[0m19:03:08.190886 [info ] [MainThread]: adapter type: postgres
[0m19:03:08.191590 [info ] [MainThread]: adapter version: 1.7.14
[0m19:03:08.420140 [info ] [MainThread]: Configuration:
[0m19:03:08.420937 [info ] [MainThread]:   profiles.yml file [OK found and valid]
[0m19:03:08.421607 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
[0m19:03:08.422286 [info ] [MainThread]: Required dependencies:
[0m19:03:08.423078 [debug] [MainThread]: Executing "git --help"
[0m19:03:08.457357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:03:08.459067 [debug] [MainThread]: STDERR: "b''"
[0m19:03:08.459936 [info ] [MainThread]:  - git [OK found]

[0m19:03:08.460662 [info ] [MainThread]: Connection:
[0m19:03:08.461542 [info ] [MainThread]:   host: postgres-dev
[0m19:03:08.462353 [info ] [MainThread]:   port: 5432
[0m19:03:08.462991 [info ] [MainThread]:   user: user
[0m19:03:08.463619 [info ] [MainThread]:   database: dev_db
[0m19:03:08.464245 [info ] [MainThread]:   schema: public
[0m19:03:08.464871 [info ] [MainThread]:   connect_timeout: 10
[0m19:03:08.465510 [info ] [MainThread]:   role: None
[0m19:03:08.466132 [info ] [MainThread]:   search_path: None
[0m19:03:08.466777 [info ] [MainThread]:   keepalives_idle: 0
[0m19:03:08.467412 [info ] [MainThread]:   sslmode: None
[0m19:03:08.468045 [info ] [MainThread]:   sslcert: None
[0m19:03:08.468672 [info ] [MainThread]:   sslkey: None
[0m19:03:08.469286 [info ] [MainThread]:   sslrootcert: None
[0m19:03:08.469910 [info ] [MainThread]:   application_name: dbt
[0m19:03:08.470531 [info ] [MainThread]:   retries: 1
[0m19:03:08.471522 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:03:08.484782 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:03:08.486291 [debug] [MainThread]: Using postgres connection "debug"
[0m19:03:08.487061 [debug] [MainThread]: On debug: select 1 as id
[0m19:03:08.487722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:08.494709 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known

[0m19:03:08.498496 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m19:03:08.499342 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m19:03:08.500102 [debug] [MainThread]: On debug: No close available on handle
[0m19:03:08.500880 [info ] [MainThread]:   Connection test: [ERROR]

[0m19:03:08.501694 [info ] [MainThread]: 1 check failed:
[0m19:03:08.502386 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres-dev" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:03:08.506627 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.63290924, "process_user_time": 5.038145, "process_kernel_time": 0.833762, "process_mem_max_rss": "156479488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:03:08.507966 [debug] [MainThread]: Command `cli debug` failed at 19:03:08.507655 after 0.63 seconds
[0m19:03:08.508803 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:03:08.509623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e3e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12359fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231cee30>]}
[0m19:03:08.510575 [debug] [MainThread]: Flushing usage events
[0m19:06:05.363355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e736860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb4df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb4e260>]}


============================== 19:06:05.369144 | 622bc3d0-a025-4bb0-9e5a-90d8a3f984a1 ==============================
[0m19:06:05.369144 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:06:05.370290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt dbt debug --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:05.371408 [info ] [MainThread]: dbt version: 1.7.14
[0m19:06:05.372130 [info ] [MainThread]: python version: 3.10.14
[0m19:06:05.372767 [info ] [MainThread]: python path: /Users/patrickroch/.vscode/extensions/.turntable-venv/bin/python
[0m19:06:05.373398 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m19:06:05.517067 [info ] [MainThread]: Using profiles dir at /Users/patrickroch/Documents/pocdbt/dbt_project
[0m19:06:05.517879 [info ] [MainThread]: Using profiles.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/profiles.yml
[0m19:06:05.518543 [info ] [MainThread]: Using dbt_project.yml file at /Users/patrickroch/Documents/pocdbt/dbt_project/dbt_project.yml
[0m19:06:05.519759 [info ] [MainThread]: adapter type: postgres
[0m19:06:05.520426 [info ] [MainThread]: adapter version: 1.7.14
[0m19:06:05.758665 [info ] [MainThread]: Configuration:
[0m19:06:05.759546 [info ] [MainThread]:   profiles.yml file [OK found and valid]
[0m19:06:05.760202 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
[0m19:06:05.760853 [info ] [MainThread]: Required dependencies:
[0m19:06:05.761613 [debug] [MainThread]: Executing "git --help"
[0m19:06:05.792392 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:06:05.794109 [debug] [MainThread]: STDERR: "b''"
[0m19:06:05.794903 [info ] [MainThread]:  - git [OK found]

[0m19:06:05.795671 [info ] [MainThread]: Connection:
[0m19:06:05.796434 [info ] [MainThread]:   host: localhost
[0m19:06:05.797085 [info ] [MainThread]:   port: 5432
[0m19:06:05.797712 [info ] [MainThread]:   user: user
[0m19:06:05.798341 [info ] [MainThread]:   database: dev_db
[0m19:06:05.798970 [info ] [MainThread]:   schema: public
[0m19:06:05.799595 [info ] [MainThread]:   connect_timeout: 10
[0m19:06:05.800225 [info ] [MainThread]:   role: None
[0m19:06:05.800865 [info ] [MainThread]:   search_path: None
[0m19:06:05.801489 [info ] [MainThread]:   keepalives_idle: 0
[0m19:06:05.802140 [info ] [MainThread]:   sslmode: None
[0m19:06:05.802764 [info ] [MainThread]:   sslcert: None
[0m19:06:05.803387 [info ] [MainThread]:   sslkey: None
[0m19:06:05.804016 [info ] [MainThread]:   sslrootcert: None
[0m19:06:05.804646 [info ] [MainThread]:   application_name: dbt
[0m19:06:05.805268 [info ] [MainThread]:   retries: 1
[0m19:06:05.806326 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:06:05.819769 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:06:05.821445 [debug] [MainThread]: Using postgres connection "debug"
[0m19:06:05.822199 [debug] [MainThread]: On debug: select 1 as id
[0m19:06:05.822873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:05.940027 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:06:05.942501 [debug] [MainThread]: On debug: Close
[0m19:06:05.943567 [info ] [MainThread]:   Connection test: [OK connection ok]

[0m19:06:05.944471 [info ] [MainThread]: All checks passed!
[0m19:06:05.948660 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7367742, "process_user_time": 5.07968, "process_kernel_time": 0.84338, "process_mem_max_rss": "158539776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:05.949967 [debug] [MainThread]: Command `cli debug` succeeded at 19:06:05.949671 after 0.74 seconds
[0m19:06:05.950740 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:06:05.951546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e736860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff5f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe97940>]}
[0m19:06:05.952439 [debug] [MainThread]: Flushing usage events
[0m19:06:11.425485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206d2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121aa5fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121aa62f0>]}


============================== 19:06:11.430565 | f3cf284f-3ba5-4521-b324-f89c4913fac0 ==============================
[0m19:06:11.430565 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:06:11.431917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:11.797272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3cf284f-3ba5-4521-b324-f89c4913fac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219db310>]}
[0m19:06:12.070812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3cf284f-3ba5-4521-b324-f89c4913fac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a258d0>]}
[0m19:06:12.072115 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:06:12.102676 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:06:12.118930 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:06:12.119800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3cf284f-3ba5-4521-b324-f89c4913fac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e68c10>]}
[0m19:06:13.974270 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m19:06:13.983397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3cf284f-3ba5-4521-b324-f89c4913fac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122968f40>]}
[0m19:06:13.985444 [info ] [MainThread]: Performance info: /Users/patrickroch/Documents/pocdbt/dbt_project/target/perf_info.json
[0m19:06:14.006398 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 2.7327888, "process_user_time": 7.138135, "process_kernel_time": 0.960083, "process_mem_max_rss": "171212800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:14.008309 [debug] [MainThread]: Command `cli parse` succeeded at 19:06:14.007876 after 2.73 seconds
[0m19:06:14.009385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206d2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121eb0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f63460>]}
[0m19:06:14.010296 [debug] [MainThread]: Flushing usage events
[0m19:06:19.467441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7d2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbf21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbf2500>]}


============================== 19:06:19.473061 | b4f30ec6-9f37-417c-86ae-2116dcf66282 ==============================
[0m19:06:19.473061 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:06:19.474429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/patrickroch/Documents/pocdbt/dbt_project', 'log_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs-generate --project-dir=/Users/patrickroch/Documents/pocdbt/dbt_project --target-dir=/Users/patrickroch/Documents/pocdbt/dbt_project/target --dialect=postgres --version=1.7', 'target_path': '/Users/patrickroch/Documents/pocdbt/dbt_project/target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:19.837211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f30ec6-9f37-417c-86ae-2116dcf66282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc979a0>]}
[0m19:06:20.100384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f30ec6-9f37-417c-86ae-2116dcf66282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db27d30>]}
[0m19:06:20.101668 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:06:20.132390 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:06:20.199936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:20.200869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:20.202201 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m19:06:20.212338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f30ec6-9f37-417c-86ae-2116dcf66282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7fc100>]}
[0m19:06:20.217404 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:06:20.218121 [info ] [MainThread]: Building catalog
[0m19:06:20.220714 [debug] [ThreadPool]: Acquiring new postgres connection 'dev_db.information_schema'
[0m19:06:20.247676 [debug] [ThreadPool]: Using postgres connection "dev_db.information_schema"
[0m19:06:20.248583 [debug] [ThreadPool]: On dev_db.information_schema: BEGIN
[0m19:06:20.249306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:20.340268 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:06:20.341479 [debug] [ThreadPool]: Using postgres connection "dev_db.information_schema"
[0m19:06:20.343077 [debug] [ThreadPool]: On dev_db.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "dev_db.information_schema"} */

    
    

    select
        'dev_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:06:20.350962 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:06:20.355210 [debug] [ThreadPool]: On dev_db.information_schema: ROLLBACK
[0m19:06:20.357460 [debug] [ThreadPool]: On dev_db.information_schema: Close
[0m19:06:20.360797 [info ] [MainThread]: Catalog written to /Users/patrickroch/Documents/pocdbt/dbt_project/target/catalog.json
[0m19:06:20.364267 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.055613, "process_user_time": 5.524344, "process_kernel_time": 0.90626, "process_mem_max_rss": "165462016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:20.365649 [debug] [MainThread]: Command `cli docs generate` succeeded at 19:06:20.365315 after 1.06 seconds
[0m19:06:20.366552 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:06:20.367215 [debug] [MainThread]: Connection 'dev_db.information_schema' was properly closed.
[0m19:06:20.367942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7d2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db27d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e6a2f20>]}
[0m19:06:20.368714 [debug] [MainThread]: Flushing usage events
[0m17:14:10.913502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f389fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f3851710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f3853450>]}


============================== 17:14:10.928740 | 06d03f3e-aaad-4492-b9c8-400d64bfd4d3 ==============================
[0m17:14:10.928740 [info ] [MainThread]: Running with dbt=1.7.14
[0m17:14:10.931242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:14:11.185756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f1f8aad0>]}
[0m17:14:11.271522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f3847d90>]}
[0m17:14:11.273287 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m17:14:11.288125 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m17:14:11.303567 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:14:11.305111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f1f4fc10>]}
[0m17:14:12.822545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m17:14:12.831596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f3ebac90>]}
[0m17:14:12.858870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f1ec6410>]}
[0m17:14:12.860201 [info ] [MainThread]: Found 1 model, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:14:12.861445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d03f3e-aaad-4492-b9c8-400d64bfd4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f1f11b90>]}
[0m17:14:12.864679 [info ] [MainThread]: 
[0m17:14:12.866840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:12.869301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m17:14:12.885078 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m17:14:12.886232 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m17:14:12.887195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:12.890495 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:14:12.892284 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m17:14:12.893360 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:14:12.894401 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:14:12.895307 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:14:12.896445 [debug] [ThreadPool]: On list_dev_db: No close available on handle
[0m17:14:12.898889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:12.899725 [debug] [MainThread]: Connection 'list_dev_db' was properly closed.
[0m17:14:12.900640 [info ] [MainThread]: 
[0m17:14:12.902065 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m17:14:12.903845 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m17:14:12.907559 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.0864146, "process_user_time": 4.662788, "process_kernel_time": 0.206943, "process_mem_max_rss": "106400", "process_in_blocks": "3616", "process_out_blocks": "1216", "command_success": false}
[0m17:14:12.908946 [debug] [MainThread]: Command `dbt seed` failed at 17:14:12.908740 after 2.09 seconds
[0m17:14:12.910017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f7828d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f76a6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f1e7cfd0>]}
[0m17:14:12.911103 [debug] [MainThread]: Flushing usage events
[0m19:35:37.035823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecac7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecb1ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecb1e150>]}


============================== 19:35:37.045317 | 015e766f-600d-4e94-b37e-c11e820ff0c6 ==============================
[0m19:35:37.045317 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:35:37.047318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:37.274206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb42b250>]}
[0m19:35:37.362963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecafc490>]}
[0m19:35:37.365113 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:35:37.379654 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:35:37.395886 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:35:37.397408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb1d8150>]}
[0m19:35:39.036415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m19:35:39.046642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae9781b50>]}
[0m19:35:39.074473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb41ac90>]}
[0m19:35:39.075660 [info ] [MainThread]: Found 1 model, 1 test, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:35:39.076878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb0c0950>]}
[0m19:35:39.080331 [info ] [MainThread]: 
[0m19:35:39.082605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:39.085236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m19:35:39.102714 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m19:35:39.103874 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m19:35:39.105074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:39.146955 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:35:39.149533 [debug] [ThreadPool]: On list_dev_db: Close
[0m19:35:39.153293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m19:35:39.162803 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:35:39.164008 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:35:39.164895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:39.183760 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:39.185187 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:35:39.186332 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:35:39.217087 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:35:39.219705 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:35:39.221116 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:35:39.229264 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:39.230563 [debug] [MainThread]: On master: BEGIN
[0m19:35:39.231424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:39.247596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:39.248705 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:39.249836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:39.266262 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:35:39.269609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae980eb10>]}
[0m19:35:39.271085 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:39.272519 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:39.273828 [debug] [MainThread]: On master: BEGIN
[0m19:35:39.275871 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:39.277157 [debug] [MainThread]: On master: COMMIT
[0m19:35:39.278441 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:39.279570 [debug] [MainThread]: On master: COMMIT
[0m19:35:39.280898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:39.282064 [debug] [MainThread]: On master: Close
[0m19:35:39.283837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:39.287221 [info ] [MainThread]: 
[0m19:35:39.301628 [debug] [Thread-1 (]: Began running node seed.dbt_poc.episode
[0m19:35:39.303484 [info ] [Thread-1 (]: 1 of 2 START seed file public.episode .......................................... [RUN]
[0m19:35:39.306083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now seed.dbt_poc.episode)
[0m19:35:39.307771 [debug] [Thread-1 (]: Began compiling node seed.dbt_poc.episode
[0m19:35:39.309742 [debug] [Thread-1 (]: Timing info for seed.dbt_poc.episode (compile): 19:35:39.309341 => 19:35:39.309347
[0m19:35:39.311846 [debug] [Thread-1 (]: Began executing node seed.dbt_poc.episode
[0m19:35:39.368602 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.episode"
[0m19:35:39.370273 [debug] [Thread-1 (]: On seed.dbt_poc.episode: BEGIN
[0m19:35:39.371518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:39.389452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:39.390680 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.episode"
[0m19:35:39.391813 [debug] [Thread-1 (]: On seed.dbt_poc.episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "seed.dbt_poc.episode"} */

    create table "dev_db"."public"."episode" ("uid" integer,"createdatetime" text,"updatedatetime" text,"structuraltype" text,"referenttype" text,"episodeclass" text,"episodenumber" integer,"title120" text,"titleclass" text,"titlelanguage" integer,"emm_episode_uid" text,"emm_parent_uid" text,"series_uid" integer,"season_uid" integer,"countryoforigin" integer,"primarygenre" text,"secondarygenre" text,"distribution_number" integer,"approximate_length" text,"eidrid" text,"entity_type" text,"primary_mode" text,"primary_language" text,"secondary_language" integer,"synopsisshort" integer,"synopsislong" text,"published_status" text,"deletedatetime" integer,"is_deleted" boolean,"title19" integer,"title" text,"titlelong" integer,"keyword_mood" integer,"keyword_time_period" integer,"keyword_theme" text,"keyword_characters" integer,"keyword_setting" integer,"keyword_subject" text,"keyword_general" integer,"episode_number" integer,"additional_data_created_by" integer,"additional_data_updated_by" integer,"additional_data_deleted_by" integer,"additional_data_source" integer,"is_eidr_duplicate_record_found" integer,"tv_rating" integer,"contentid_list" text,"release_date" timestamp without time zone)
  
[0m19:35:39.432437 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m19:35:39.802396 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.episode"
[0m19:35:39.803797 [debug] [Thread-1 (]: On seed.dbt_poc.episode: 
          insert into "dev_db"."public"."episode" ("uid", "createdatetime", "updatedatetime", "structuraltype", "referenttype", "episodeclass", "episodenumber", "title120", "titleclass", "titlelanguage", "emm_episode_uid", "emm_parent_uid", "series_uid", "season_uid", "countryoforigin", "primarygenre", "secondarygenre", "distribution_number", "approximate_length", "eidrid", "entity_type", "primary_mode", "primary_language", "secondary_language", "synopsisshort", "synopsislong", "published_status", "deleted...
[0m19:35:39.812097 [debug] [Thread-1 (]: SQL status: INSERT 0 20 in 0.0 seconds
[0m19:35:39.820855 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_poc.episode"
[0m19:35:39.854159 [debug] [Thread-1 (]: On seed.dbt_poc.episode: COMMIT
[0m19:35:39.855461 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.episode"
[0m19:35:39.856673 [debug] [Thread-1 (]: On seed.dbt_poc.episode: COMMIT
[0m19:35:39.860171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:39.862252 [debug] [Thread-1 (]: Timing info for seed.dbt_poc.episode (execute): 19:35:39.313310 => 19:35:39.861859
[0m19:35:39.863501 [debug] [Thread-1 (]: On seed.dbt_poc.episode: Close
[0m19:35:39.865292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb1b5510>]}
[0m19:35:39.866624 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.episode ...................................... [[32mINSERT 20[0m in 0.56s]
[0m19:35:39.868717 [debug] [Thread-1 (]: Finished running node seed.dbt_poc.episode
[0m19:35:39.870275 [debug] [Thread-1 (]: Began running node seed.dbt_poc.manifestation
[0m19:35:39.871558 [info ] [Thread-1 (]: 2 of 2 START seed file public.manifestation .................................... [RUN]
[0m19:35:39.874745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_poc.episode, now seed.dbt_poc.manifestation)
[0m19:35:39.876113 [debug] [Thread-1 (]: Began compiling node seed.dbt_poc.manifestation
[0m19:35:39.877340 [debug] [Thread-1 (]: Timing info for seed.dbt_poc.manifestation (compile): 19:35:39.876968 => 19:35:39.876974
[0m19:35:39.878546 [debug] [Thread-1 (]: Began executing node seed.dbt_poc.manifestation
[0m19:35:39.892748 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.manifestation"
[0m19:35:39.894461 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: BEGIN
[0m19:35:39.895857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:39.913648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:39.915202 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.manifestation"
[0m19:35:39.916375 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "seed.dbt_poc.manifestation"} */

    create table "dev_db"."public"."manifestation" ("uid" integer,"createdatetime" text,"updatedatetime" text,"emm_manifestation_uid" text,"episode_uid" integer,"parent_manifestation_id" integer,"manifestationclass" text,"emm_parent_uid" text,"title" text,"entity_type" text,"eidrid" integer,"structuraltype" text,"referenttype" text,"actual_length" text,"edit_use" text,"edit_class" text,"audio_closedcaption" text,"audio_type" text,"video_vchip" text,"video_ei" boolean,"published_status" text,"deletedatetime" integer,"is_deleted" boolean,"title_old" text,"title_old2" text,"video_hidef" integer,"additional_data_created_by" integer,"additional_data_updated_by" integer,"additional_data_deleted_by" integer,"additional_data_source" integer,"contentid_list" text,"release_date" integer)
  
[0m19:35:39.928526 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m19:35:40.203325 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.manifestation"
[0m19:35:40.205164 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: 
          insert into "dev_db"."public"."manifestation" ("uid", "createdatetime", "updatedatetime", "emm_manifestation_uid", "episode_uid", "parent_manifestation_id", "manifestationclass", "emm_parent_uid", "title", "entity_type", "eidrid", "structuraltype", "referenttype", "actual_length", "edit_use", "edit_class", "audio_closedcaption", "audio_type", "video_vchip", "video_ei", "published_status", "deletedatetime", "is_deleted", "title_old", "title_old2", "video_hidef", "additional_data_created_by", "addi...
[0m19:35:40.213221 [debug] [Thread-1 (]: SQL status: INSERT 0 20 in 0.0 seconds
[0m19:35:40.215217 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_poc.manifestation"
[0m19:35:40.222437 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: COMMIT
[0m19:35:40.223815 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_poc.manifestation"
[0m19:35:40.225129 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: COMMIT
[0m19:35:40.228163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:40.231710 [debug] [Thread-1 (]: Timing info for seed.dbt_poc.manifestation (execute): 19:35:39.879886 => 19:35:40.231172
[0m19:35:40.233179 [debug] [Thread-1 (]: On seed.dbt_poc.manifestation: Close
[0m19:35:40.235346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015e766f-600d-4e94-b37e-c11e820ff0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae96acfd0>]}
[0m19:35:40.236936 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file public.manifestation ................................ [[32mINSERT 20[0m in 0.36s]
[0m19:35:40.239599 [debug] [Thread-1 (]: Finished running node seed.dbt_poc.manifestation
[0m19:35:40.245521 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:40.246902 [debug] [MainThread]: On master: BEGIN
[0m19:35:40.248574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:40.272403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:40.274136 [debug] [MainThread]: On master: COMMIT
[0m19:35:40.275491 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:40.276880 [debug] [MainThread]: On master: COMMIT
[0m19:35:40.279405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:40.281220 [debug] [MainThread]: On master: Close
[0m19:35:40.283085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:40.284382 [debug] [MainThread]: Connection 'seed.dbt_poc.manifestation' was properly closed.
[0m19:35:40.287440 [info ] [MainThread]: 
[0m19:35:40.289259 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m19:35:40.292244 [debug] [MainThread]: Command end result
[0m19:35:40.314436 [info ] [MainThread]: 
[0m19:35:40.316313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:40.318362 [info ] [MainThread]: 
[0m19:35:40.320646 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:35:40.323293 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.3641853, "process_user_time": 6.040854, "process_kernel_time": 0.215891, "process_mem_max_rss": "115316", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m19:35:40.324817 [debug] [MainThread]: Command `dbt seed` succeeded at 19:35:40.324597 after 3.37 seconds
[0m19:35:40.326389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecb1fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0b88450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0abf4d0>]}
[0m19:35:40.327817 [debug] [MainThread]: Flushing usage events
[0m19:37:33.077950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384f5c1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384e6c1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384e7247d0>]}


============================== 19:37:33.087991 | a48cb001-e877-4fe1-a463-1293f269f05c ==============================
[0m19:37:33.087991 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:37:33.091471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:37:33.334475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384e10cb50>]}
[0m19:37:33.421503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ca24210>]}
[0m19:37:33.423400 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:37:33.437718 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:37:33.490378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:37:33.492002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:37:33.493505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m19:37:33.502174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384f74cf90>]}
[0m19:37:33.525021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384c915410>]}
[0m19:37:33.526257 [info ] [MainThread]: Found 1 model, 1 test, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:37:33.527451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384c904110>]}
[0m19:37:33.530480 [info ] [MainThread]: 
[0m19:37:33.532347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:33.534569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m19:37:33.552271 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m19:37:33.553500 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:33.554753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:33.575415 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:37:33.577974 [debug] [ThreadPool]: On list_dev_db: Close
[0m19:37:33.581439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m19:37:33.590481 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:37:33.591606 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:37:33.592778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:33.609415 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:33.610684 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:37:33.611695 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:37:33.620715 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:37:33.623307 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:37:33.624931 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:37:33.633087 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.634211 [debug] [MainThread]: On master: BEGIN
[0m19:37:33.635154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:33.650805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:33.651855 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.652986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:33.664795 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:33.667379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ef3b810>]}
[0m19:37:33.668744 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:33.669947 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.670804 [debug] [MainThread]: On master: BEGIN
[0m19:37:33.672299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:33.673296 [debug] [MainThread]: On master: COMMIT
[0m19:37:33.674347 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.675301 [debug] [MainThread]: On master: COMMIT
[0m19:37:33.676801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:33.677743 [debug] [MainThread]: On master: Close
[0m19:37:33.679303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:33.680620 [info ] [MainThread]: 
[0m19:37:33.693088 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m19:37:33.694695 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m19:37:33.697006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m19:37:33.698230 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m19:37:33.709993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m19:37:33.714878 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 19:37:33.699321 => 19:37:33.714391
[0m19:37:33.716131 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m19:37:33.768950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m19:37:33.773918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m19:37:33.774994 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m19:37:33.776112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:33.792931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:33.794267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m19:37:33.795374 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    e.*, -- Include all columns from episode
    m.title as manifestation_title,
    m.entity_type as manifestation_entity_type,
    m.eidrid as manifestation_eidrid,
    -- Exclude m.structuraltype as manifestation_structuraltype,
    -- Exclue m.referenttype as manifestation_referenttype,
    m.actual_length as manifestation_actual_length,
    m.edit_use as manifestation_edit_use,
    m.edit_class as manifestation_edit_class,
    -- Exclude m.audio_closedcaption,
    -- Exclude m.audio_type,
    -- Exclude m.video_vchip,
    m.video_ei as manifestation_video_ei,
    m.published_status as manifestation_published_status,
    -- m.deletedatetime as manifestation_deletedatetime,
    -- m.is_deleted as manifestation_is_deleted,
    -- m.title_old as manifestation_title_old,
    -- m.title_old2 as manifestation_title_old2,
    m.video_hidef as manifestation_video_hidef,
    m.release_date as manifestation_release_date
from
    episode e
left join
    manifestation m
on
    e.uid = m.episode_uid
  );
[0m19:37:33.812882 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:33.822740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m19:37:33.823936 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */
alter table "dev_db"."public"."merged_episode__dbt_tmp" rename to "merged_episode"
[0m19:37:33.826394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:33.848414 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: COMMIT
[0m19:37:33.849902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m19:37:33.851168 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: COMMIT
[0m19:37:33.854623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:33.866817 [debug] [Thread-1 (]: Applying DROP to: "dev_db"."public"."merged_episode__dbt_backup"
[0m19:37:33.876054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m19:37:33.877407 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */
drop view if exists "dev_db"."public"."merged_episode__dbt_backup" cascade
[0m19:37:33.879267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:33.882789 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 19:37:33.717231 => 19:37:33.882339
[0m19:37:33.883860 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m19:37:33.885568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a48cb001-e877-4fe1-a463-1293f269f05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384c894d90>]}
[0m19:37:33.887151 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.merged_episode ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m19:37:33.889713 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m19:37:33.893769 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.894796 [debug] [MainThread]: On master: BEGIN
[0m19:37:33.895765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:33.915474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:33.916787 [debug] [MainThread]: On master: COMMIT
[0m19:37:33.917769 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:33.918943 [debug] [MainThread]: On master: COMMIT
[0m19:37:33.920481 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:33.921696 [debug] [MainThread]: On master: Close
[0m19:37:33.923251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:33.924636 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m19:37:33.925793 [info ] [MainThread]: 
[0m19:37:33.927242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m19:37:33.929263 [debug] [MainThread]: Command end result
[0m19:37:33.946298 [info ] [MainThread]: 
[0m19:37:33.947733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:33.949187 [info ] [MainThread]: 
[0m19:37:33.950889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:37:33.953453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97327006, "process_user_time": 3.735889, "process_kernel_time": 0.242481, "process_mem_max_rss": "107140", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m19:37:33.955222 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:33.955015 after 0.98 seconds
[0m19:37:33.956268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38520bb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38520b8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3852214a50>]}
[0m19:37:33.957322 [debug] [MainThread]: Flushing usage events
[0m19:47:59.452423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc083bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc0d04510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc088b950>]}


============================== 19:47:59.462446 | c872f9ce-42cf-4e2a-80b4-0993354275f9 ==============================
[0m19:47:59.462446 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:47:59.463965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:59.678717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbefa1790>]}
[0m19:47:59.770634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc083be50>]}
[0m19:47:59.772287 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:47:59.787342 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:47:59.834580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:59.835705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:59.837043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m19:47:59.845759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbef0f6d0>]}
[0m19:47:59.871869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbee95410>]}
[0m19:47:59.872965 [info ] [MainThread]: Found 1 model, 1 test, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:47:59.873972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbee80190>]}
[0m19:47:59.877198 [info ] [MainThread]: 
[0m19:47:59.878991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:59.881671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m19:47:59.901915 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:47:59.903078 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:47:59.903999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:59.924519 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:47:59.925900 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:47:59.927172 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:47:59.938190 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:47:59.941689 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:47:59.943400 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:47:59.952691 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:59.953981 [debug] [MainThread]: On master: BEGIN
[0m19:47:59.955133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:59.973780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:59.975229 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:59.977425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:59.994977 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:47:59.999213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c872f9ce-42cf-4e2a-80b4-0993354275f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbefcac50>]}
[0m19:48:00.000937 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:00.002746 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:00.004099 [debug] [MainThread]: On master: BEGIN
[0m19:48:00.006398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:00.008070 [debug] [MainThread]: On master: COMMIT
[0m19:48:00.009190 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:00.010352 [debug] [MainThread]: On master: COMMIT
[0m19:48:00.012231 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:00.013650 [debug] [MainThread]: On master: Close
[0m19:48:00.015638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:00.017247 [info ] [MainThread]: 
[0m19:48:00.032257 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m19:48:00.033789 [info ] [Thread-1 (]: 1 of 1 START test merged_episode_test .......................................... [RUN]
[0m19:48:00.036135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m19:48:00.037501 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m19:48:00.056527 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m19:48:00.064803 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 19:48:00.039254 => 19:48:00.063919
[0m19:48:00.067360 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m19:48:00.111256 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m19:48:00.123106 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:48:00.125339 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m19:48:00.128453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:00.159871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:00.161993 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:48:00.163720 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid
select episode_id, manifestation_eidrid, count(*) as count
from "dev_db"."public"."merged_episode"
group by episode_id, manifestation_eidrid
having count(*) > 1

-- Test for non-null values in key columns
select *
from "dev_db"."public"."merged_episode"
where episode_id is null
   or manifestation_eidrid is null

-- Test for referential integrity with manifestation table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid
where m.eidrid is null

-- Test for referential integrity with episode table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
where e.episode_id is null

-- Test for matching episode uid between episode and manifestation tables
select e.uid as episode_uid, m.episode_uid as manifestation_episode_uid
from "dev_db"."public"."merged_episode" me
join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid
where e.uid <> m.episode_uid
      
    ) dbt_internal_test
[0m19:48:00.168556 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select *
         ^

[0m19:48:00.170739 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m19:48:00.174811 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 19:48:00.069631 => 19:48:00.174114
[0m19:48:00.178757 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m19:48:00.189177 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "select"
  LINE 16: select *
           ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:48:00.192065 [error] [Thread-1 (]: 1 of 1 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.16s]
[0m19:48:00.196682 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m19:48:00.204796 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:00.206785 [debug] [MainThread]: On master: BEGIN
[0m19:48:00.208440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:00.239682 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:00.241272 [debug] [MainThread]: On master: COMMIT
[0m19:48:00.243731 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:00.245348 [debug] [MainThread]: On master: COMMIT
[0m19:48:00.248587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:00.249989 [debug] [MainThread]: On master: Close
[0m19:48:00.252983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:00.255674 [debug] [MainThread]: Connection 'test.dbt_poc.merged_episode_test' was properly closed.
[0m19:48:00.258212 [info ] [MainThread]: 
[0m19:48:00.261393 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:48:00.264780 [debug] [MainThread]: Command end result
[0m19:48:00.291292 [info ] [MainThread]: 
[0m19:48:00.293038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:48:00.294928 [info ] [MainThread]: 
[0m19:48:00.297376 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "select"
  LINE 16: select *
           ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:48:00.299889 [info ] [MainThread]: 
[0m19:48:00.301684 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:48:00.304025 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.9244987, "process_user_time": 3.550253, "process_kernel_time": 0.262044, "process_mem_max_rss": "107804", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m19:48:00.305635 [debug] [MainThread]: Command `dbt test` failed at 19:48:00.305345 after 0.93 seconds
[0m19:48:00.306986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc088d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc0840bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc498d890>]}
[0m19:48:00.308336 [debug] [MainThread]: Flushing usage events
[0m19:51:58.835197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a127d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a12c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2562b50>]}


============================== 19:51:58.844370 | bdb6dab2-5e74-401f-9880-ecf53e9e5816 ==============================
[0m19:51:58.844370 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:51:58.845959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:59.082407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a1304650>]}
[0m19:51:59.172197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a12b3450>]}
[0m19:51:59.173915 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:51:59.188334 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:51:59.241133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:59.242724 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m19:51:59.399947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m19:51:59.408741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69f947d50>]}
[0m19:51:59.432841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69f8503d0>]}
[0m19:51:59.434504 [info ] [MainThread]: Found 1 model, 2 seeds, 1 test, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:51:59.435826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69f9f3dd0>]}
[0m19:51:59.438951 [info ] [MainThread]: 
[0m19:51:59.441297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:59.443849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m19:51:59.460235 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:51:59.461368 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:51:59.462257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:59.480542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:51:59.481687 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:51:59.482770 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:51:59.492464 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:51:59.495421 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:51:59.496721 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:51:59.504862 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.505969 [debug] [MainThread]: On master: BEGIN
[0m19:51:59.507135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:59.522694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:59.523867 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.525011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:59.535209 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:51:59.538724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb6dab2-5e74-401f-9880-ecf53e9e5816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa69fa74450>]}
[0m19:51:59.539941 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:59.541701 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.542710 [debug] [MainThread]: On master: BEGIN
[0m19:51:59.544620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:59.545645 [debug] [MainThread]: On master: COMMIT
[0m19:51:59.546590 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.548179 [debug] [MainThread]: On master: COMMIT
[0m19:51:59.549406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:51:59.550278 [debug] [MainThread]: On master: Close
[0m19:51:59.551815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:59.553420 [info ] [MainThread]: 
[0m19:51:59.566174 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m19:51:59.567366 [info ] [Thread-1 (]: 1 of 1 START test merged_episode_test .......................................... [RUN]
[0m19:51:59.569554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m19:51:59.570647 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m19:51:59.585905 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m19:51:59.590742 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 19:51:59.571453 => 19:51:59.590275
[0m19:51:59.591863 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m19:51:59.616830 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m19:51:59.620284 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:51:59.621322 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m19:51:59.622485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:59.639727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:51:59.641665 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:51:59.643431 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid
select episode_id, manifestation_eidrid, count(*) as count
from "dev_db"."public"."merged_episode"
group by episode_id, manifestation_eidrid
having count(*) > 1;

-- Test for non-null values in key columns
select *
from "dev_db"."public"."merged_episode"
where episode_id is null
   or manifestation_eidrid is null;

-- Test for referential integrity with manifestation table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid
where m.eidrid is null;

-- Test for referential integrity with episode table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
where e.episode_id is null;

-- Test for matching episode uid between episode and manifestation tables
select e.uid as episode_uid, m.episode_uid as manifestation_episode_uid
from "dev_db"."public"."merged_episode" me
join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid;
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid
select episode_id, manifestation_eidrid, count(*) as count
from "dev_db"."public"."merged_episode"
group by episode_id, manifestation_eidrid
having count(*) > 1

-- Test for non-null values in key columns
select *
from "dev_db"."public"."merged_episode"
where episode_id is null
   or manifestation_eidrid is null
      
    ) dbt_internal_test
[0m19:51:59.645771 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 13: having count(*) > 1;
                            ^

[0m19:51:59.647378 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m19:51:59.649327 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 19:51:59.593053 => 19:51:59.648856
[0m19:51:59.650496 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m19:51:59.656455 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ";"
  LINE 13: having count(*) > 1;
                              ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:51:59.657938 [error] [Thread-1 (]: 1 of 1 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m19:51:59.659772 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m19:51:59.664472 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.665435 [debug] [MainThread]: On master: BEGIN
[0m19:51:59.666605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:59.682858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:59.684155 [debug] [MainThread]: On master: COMMIT
[0m19:51:59.685125 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:59.686072 [debug] [MainThread]: On master: COMMIT
[0m19:51:59.687215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:51:59.688133 [debug] [MainThread]: On master: Close
[0m19:51:59.689814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:59.690954 [debug] [MainThread]: Connection 'test.dbt_poc.merged_episode_test' was properly closed.
[0m19:51:59.692222 [info ] [MainThread]: 
[0m19:51:59.693660 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:51:59.695485 [debug] [MainThread]: Command end result
[0m19:51:59.713158 [info ] [MainThread]: 
[0m19:51:59.714622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:51:59.715927 [info ] [MainThread]: 
[0m19:51:59.717730 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ";"
  LINE 13: having count(*) > 1;
                              ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:51:59.719467 [info ] [MainThread]: 
[0m19:51:59.720832 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:51:59.722961 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.95625556, "process_user_time": 4.009354, "process_kernel_time": 0.24077, "process_mem_max_rss": "109696", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m19:51:59.724423 [debug] [MainThread]: Command `dbt test` failed at 19:51:59.724225 after 0.96 seconds
[0m19:51:59.725627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a1908310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a12c6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a12c6d50>]}
[0m19:51:59.726815 [debug] [MainThread]: Flushing usage events
[0m19:57:02.880824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb14f78650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1495a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1495a190>]}


============================== 19:57:02.889019 | be40bc73-08b2-42ab-a51c-0e74b7df4cf8 ==============================
[0m19:57:02.889019 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:57:02.890404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:03.105574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1326f510>]}
[0m19:57:03.192511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1324c890>]}
[0m19:57:03.194265 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:57:03.207883 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:57:03.253101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:03.254328 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m19:57:03.401921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m19:57:03.410289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb130fdcd0>]}
[0m19:57:03.432985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb12ef4ed0>]}
[0m19:57:03.434112 [info ] [MainThread]: Found 1 model, 2 seeds, 1 test, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:57:03.435161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1320eb90>]}
[0m19:57:03.438216 [info ] [MainThread]: 
[0m19:57:03.440070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:57:03.442357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m19:57:03.459721 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:57:03.461268 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:57:03.462355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:03.483835 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:57:03.485291 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:57:03.486242 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:57:03.497080 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:57:03.499591 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:57:03.501213 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:57:03.510957 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.511854 [debug] [MainThread]: On master: BEGIN
[0m19:57:03.512565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:03.529452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:03.530363 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.531407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:57:03.541504 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:57:03.544918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be40bc73-08b2-42ab-a51c-0e74b7df4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb12ee3e90>]}
[0m19:57:03.545966 [debug] [MainThread]: On master: ROLLBACK
[0m19:57:03.547035 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.547814 [debug] [MainThread]: On master: BEGIN
[0m19:57:03.549068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:03.549755 [debug] [MainThread]: On master: COMMIT
[0m19:57:03.550432 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.551315 [debug] [MainThread]: On master: COMMIT
[0m19:57:03.552230 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:57:03.553003 [debug] [MainThread]: On master: Close
[0m19:57:03.554384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:03.555418 [info ] [MainThread]: 
[0m19:57:03.568264 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m19:57:03.570086 [info ] [Thread-1 (]: 1 of 1 START test merged_episode_test .......................................... [RUN]
[0m19:57:03.572392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m19:57:03.575461 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m19:57:03.593094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m19:57:03.601985 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 19:57:03.576681 => 19:57:03.601429
[0m19:57:03.603235 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m19:57:03.629444 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m19:57:03.633868 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:57:03.634978 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m19:57:03.636031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:03.652385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:03.653515 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:57:03.654575 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid
select episode_id, manifestation_eidrid, count(*) as count
from "dev_db"."public"."merged_episode"
group by episode_id, manifestation_eidrid
having count(*) > 1

-- Test for non-null values in key columns
select *
from "dev_db"."public"."merged_episode"
where episode_id is null
   or manifestation_eidrid is null

-- Test for referential integrity with manifestation table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid
where m.eidrid is null

-- Test for referential integrity with episode table
select me.*
from "dev_db"."public"."merged_episode" me
left join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
where e.episode_id is null

-- Test for matching episode uid between episode and manifestation tables
select e.uid as episode_uid, m.episode_uid as manifestation_episode_uid
from "dev_db"."public"."merged_episode" me
join "dev_db"."public"."episode" e on me.episode_id = e.episode_id
join "dev_db"."public"."manifestation" m on me.manifestation_eidrid = m.eidrid
where e.uid != m.episode_uid
      
    ) dbt_internal_test
[0m19:57:03.656402 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select *
         ^

[0m19:57:03.657738 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m19:57:03.659273 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 19:57:03.604229 => 19:57:03.658940
[0m19:57:03.660270 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m19:57:03.666251 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "select"
  LINE 16: select *
           ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:57:03.667531 [error] [Thread-1 (]: 1 of 1 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.10s]
[0m19:57:03.669076 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m19:57:03.673551 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.674415 [debug] [MainThread]: On master: BEGIN
[0m19:57:03.675195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:03.691008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:03.692115 [debug] [MainThread]: On master: COMMIT
[0m19:57:03.693132 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:03.693955 [debug] [MainThread]: On master: COMMIT
[0m19:57:03.695142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:57:03.695967 [debug] [MainThread]: On master: Close
[0m19:57:03.697360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:03.698224 [debug] [MainThread]: Connection 'test.dbt_poc.merged_episode_test' was properly closed.
[0m19:57:03.699048 [info ] [MainThread]: 
[0m19:57:03.700068 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m19:57:03.702031 [debug] [MainThread]: Command end result
[0m19:57:03.717731 [info ] [MainThread]: 
[0m19:57:03.718804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:57:03.720194 [info ] [MainThread]: 
[0m19:57:03.721288 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "select"
  LINE 16: select *
           ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:57:03.722904 [info ] [MainThread]: 
[0m19:57:03.724442 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:57:03.726840 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.91147465, "process_user_time": 3.907029, "process_kernel_time": 0.24504, "process_mem_max_rss": "109256", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m19:57:03.728300 [debug] [MainThread]: Command `dbt test` failed at 19:57:03.728091 after 0.91 seconds
[0m19:57:03.729167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1495ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb14910a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb18a64f50>]}
[0m19:57:03.730146 [debug] [MainThread]: Flushing usage events
[0m19:58:54.674858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76e11390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76e5ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a77389a50>]}


============================== 19:58:54.684500 | 94ac60e2-1f65-4f00-b6dd-352ef105a15a ==============================
[0m19:58:54.684500 [info ] [MainThread]: Running with dbt=1.7.14
[0m19:58:54.686765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:58:54.924961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a757491d0>]}
[0m19:58:55.012908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a78102090>]}
[0m19:58:55.015595 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m19:58:55.032693 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m19:58:55.084796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:58:55.086348 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m19:58:55.241652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m19:58:55.249571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7540a950>]}
[0m19:58:55.314836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a753d11d0>]}
[0m19:58:55.316052 [info ] [MainThread]: Found 1 model, 2 seeds, 1 test, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:58:55.317302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76e38c90>]}
[0m19:58:55.320240 [info ] [MainThread]: 
[0m19:58:55.322035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:58:55.324872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m19:58:55.340819 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:58:55.341988 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m19:58:55.343234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:55.360792 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:58:55.362017 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m19:58:55.363449 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:58:55.373912 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:58:55.376551 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m19:58:55.377804 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m19:58:55.386027 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.387057 [debug] [MainThread]: On master: BEGIN
[0m19:58:55.388018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:58:55.404410 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:55.405581 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.406869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:58:55.416744 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:58:55.420081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ac60e2-1f65-4f00-b6dd-352ef105a15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a753c2d10>]}
[0m19:58:55.421401 [debug] [MainThread]: On master: ROLLBACK
[0m19:58:55.422632 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.423549 [debug] [MainThread]: On master: BEGIN
[0m19:58:55.425011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:55.425917 [debug] [MainThread]: On master: COMMIT
[0m19:58:55.426872 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.427823 [debug] [MainThread]: On master: COMMIT
[0m19:58:55.428940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:58:55.429786 [debug] [MainThread]: On master: Close
[0m19:58:55.431482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:55.432683 [info ] [MainThread]: 
[0m19:58:55.445315 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m19:58:55.446495 [info ] [Thread-1 (]: 1 of 1 START test merged_episode_test .......................................... [RUN]
[0m19:58:55.448456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m19:58:55.449636 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m19:58:55.465951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m19:58:55.469881 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 19:58:55.450534 => 19:58:55.469455
[0m19:58:55.470975 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m19:58:55.496676 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m19:58:55.500180 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:58:55.501529 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m19:58:55.502554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:55.517951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:55.519158 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m19:58:55.520167 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in key columns


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table


-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m19:58:55.521673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 24:     ) dbt_internal_test
             ^

[0m19:58:55.522644 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m19:58:55.524079 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 19:58:55.472036 => 19:58:55.523738
[0m19:58:55.525148 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m19:58:55.531033 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 24:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:58:55.532507 [error] [Thread-1 (]: 1 of 1 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.08s]
[0m19:58:55.534147 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m19:58:55.538709 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.539630 [debug] [MainThread]: On master: BEGIN
[0m19:58:55.540554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:58:55.557588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:55.559396 [debug] [MainThread]: On master: COMMIT
[0m19:58:55.561168 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:55.562648 [debug] [MainThread]: On master: COMMIT
[0m19:58:55.564098 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:58:55.565280 [debug] [MainThread]: On master: Close
[0m19:58:55.566941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:55.567871 [debug] [MainThread]: Connection 'test.dbt_poc.merged_episode_test' was properly closed.
[0m19:58:55.568855 [info ] [MainThread]: 
[0m19:58:55.570351 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:58:55.571945 [debug] [MainThread]: Command end result
[0m19:58:55.589438 [info ] [MainThread]: 
[0m19:58:55.590908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:58:55.592581 [info ] [MainThread]: 
[0m19:58:55.594809 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 24:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m19:58:55.597468 [info ] [MainThread]: 
[0m19:58:55.599201 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:58:55.602047 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0422066, "process_user_time": 3.859554, "process_kernel_time": 0.237161, "process_mem_max_rss": "110260", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m19:58:55.603594 [debug] [MainThread]: Command `dbt test` failed at 19:58:55.603241 after 1.04 seconds
[0m19:58:55.604769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76e06c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76e5fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7740dc10>]}
[0m19:58:55.605925 [debug] [MainThread]: Flushing usage events
[0m20:01:31.428873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45810b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458109410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45810bb10>]}


============================== 20:01:31.439126 | baa787d5-2508-4db6-bbdd-73513710ce99 ==============================
[0m20:01:31.439126 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:01:31.441837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:01:31.671448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa787d5-2508-4db6-bbdd-73513710ce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe456a6c4d0>]}
[0m20:01:31.758558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa787d5-2508-4db6-bbdd-73513710ce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe456a5dc10>]}
[0m20:01:31.760137 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:01:31.775709 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:01:31.838687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:01:31.840500 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m20:01:31.974160 [error] [MainThread]: Encountered an error:
Compilation Error in test merged_episode_test (tests/merged_episode_test.sql)
  expected token '(', got 'end of statement block'
    line 4
      {% test unique_episode_manifestation_combination %}
[0m20:01:31.976870 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.62440306, "process_user_time": 4.046372, "process_kernel_time": 0.29302, "process_mem_max_rss": "101748", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m20:01:31.978465 [debug] [MainThread]: Command `dbt test` failed at 20:01:31.978259 after 0.63 seconds
[0m20:01:31.979687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe458114990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45c3cd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe456700cd0>]}
[0m20:01:31.981590 [debug] [MainThread]: Flushing usage events
[0m20:06:16.853027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90edef790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb91029d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f45c510>]}


============================== 20:06:16.862092 | 36eaeaba-a077-49fb-9bde-6e383e12b102 ==============================
[0m20:06:16.862092 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:06:16.863565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:06:17.078743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36eaeaba-a077-49fb-9bde-6e383e12b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90ee32d90>]}
[0m20:06:17.166277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36eaeaba-a077-49fb-9bde-6e383e12b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d7593d0>]}
[0m20:06:17.167933 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:06:17.182083 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:06:17.235236 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:06:17.236809 [debug] [MainThread]: Partial parsing: deleted file: dbt_poc://tests/merged_episode_test.sql
[0m20:06:17.248711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m20:06:17.257599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36eaeaba-a077-49fb-9bde-6e383e12b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d730e10>]}
[0m20:06:17.285552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36eaeaba-a077-49fb-9bde-6e383e12b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d4ba350>]}
[0m20:06:17.286778 [info ] [MainThread]: Found 1 model, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:06:17.288575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36eaeaba-a077-49fb-9bde-6e383e12b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d4c8d10>]}
[0m20:06:17.291872 [info ] [MainThread]: 
[0m20:06:17.294131 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:06:17.297384 [debug] [MainThread]: Command end result
[0m20:06:17.314583 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53615713, "process_user_time": 3.370995, "process_kernel_time": 0.210049, "process_mem_max_rss": "102544", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m20:06:17.315999 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:17.315790 after 0.54 seconds
[0m20:06:17.316963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb912dc4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb912dc4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb912f48f10>]}
[0m20:06:17.318116 [debug] [MainThread]: Flushing usage events
[0m20:06:35.115292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cd8bef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cd8bf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cde71990>]}


============================== 20:06:35.123574 | ed591571-bbda-471a-a26a-568d6e12561a ==============================
[0m20:06:35.123574 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:06:35.124901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:06:35.340219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed591571-bbda-471a-a26a-568d6e12561a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cc1e3690>]}
[0m20:06:35.428480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed591571-bbda-471a-a26a-568d6e12561a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cd868a50>]}
[0m20:06:35.430175 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:06:35.445923 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:06:35.492556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:35.493673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:35.494995 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m20:06:35.502980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed591571-bbda-471a-a26a-568d6e12561a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cd8c0710>]}
[0m20:06:35.524006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed591571-bbda-471a-a26a-568d6e12561a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cc0c4c50>]}
[0m20:06:35.525117 [info ] [MainThread]: Found 1 model, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:06:35.526090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed591571-bbda-471a-a26a-568d6e12561a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cc0b5490>]}
[0m20:06:35.528514 [info ] [MainThread]: 
[0m20:06:35.529531 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:06:35.530902 [debug] [MainThread]: Command end result
[0m20:06:35.546236 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49837288, "process_user_time": 3.56789, "process_kernel_time": 0.219625, "process_mem_max_rss": "102728", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m20:06:35.547364 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:35.547182 after 0.50 seconds
[0m20:06:35.548215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d1860610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d1860690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d19bcf90>]}
[0m20:06:35.549169 [debug] [MainThread]: Flushing usage events
[0m20:14:02.604812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001aae390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001aaefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90020cc650>]}


============================== 20:14:02.613556 | d2b54b03-de9a-4398-ba94-0fb041aa208e ==============================
[0m20:14:02.613556 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:14:02.615242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:02.836086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001a82ad0>]}
[0m20:14:02.923465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001a5bad0>]}
[0m20:14:02.925293 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:14:02.939856 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:14:02.955394 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:14:02.956911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9000404e50>]}
[0m20:14:04.778208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m20:14:04.787905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9000126050>]}
[0m20:14:04.814188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffe063210>]}
[0m20:14:04.815601 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:14:04.817066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90000cba90>]}
[0m20:14:04.820646 [info ] [MainThread]: 
[0m20:14:04.823805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:04.827238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m20:14:04.844078 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:14:04.845134 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m20:14:04.846438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:04.869560 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:14:04.871030 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:14:04.872360 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:14:04.882436 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:14:04.885066 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m20:14:04.886516 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m20:14:04.895066 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:04.896395 [debug] [MainThread]: On master: BEGIN
[0m20:14:04.897574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:04.916095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:04.917775 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:04.919161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:04.930796 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:14:04.934085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b54b03-de9a-4398-ba94-0fb041aa208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001aaead0>]}
[0m20:14:04.935226 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:04.936563 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:04.937552 [debug] [MainThread]: On master: BEGIN
[0m20:14:04.939036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:04.940017 [debug] [MainThread]: On master: COMMIT
[0m20:14:04.940983 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:04.941856 [debug] [MainThread]: On master: COMMIT
[0m20:14:04.942991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:04.944136 [debug] [MainThread]: On master: Close
[0m20:14:04.946048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:04.947563 [info ] [MainThread]: 
[0m20:14:04.960481 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f
[0m20:14:04.961951 [info ] [Thread-1 (]: 1 of 4 START test not_null_merged_episode_episode_id ........................... [RUN]
[0m20:14:04.964242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f)
[0m20:14:04.965954 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f
[0m20:14:04.991442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f"
[0m20:14:04.996904 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f (compile): 20:14:04.967017 => 20:14:04.996336
[0m20:14:04.998353 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f
[0m20:14:05.023653 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f"
[0m20:14:05.028919 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f"
[0m20:14:05.030022 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f: BEGIN
[0m20:14:05.031056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:05.048354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:05.049834 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f"
[0m20:14:05.051308 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select episode_id
from "dev_db"."public"."merged_episode"
where episode_id is null



      
    ) dbt_internal_test
[0m20:14:05.057290 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "episode_id" does not exist
LINE 13: select episode_id
                ^

[0m20:14:05.058911 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f: ROLLBACK
[0m20:14:05.061185 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f (execute): 20:14:04.999315 => 20:14:05.060756
[0m20:14:05.062380 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f: Close
[0m20:14:05.069349 [debug] [Thread-1 (]: Database Error in test not_null_merged_episode_episode_id (models/schema.yml)
  column "episode_id" does not exist
  LINE 13: select episode_id
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/not_null_merged_episode_episode_id.sql
[0m20:14:05.071153 [error] [Thread-1 (]: 1 of 4 ERROR not_null_merged_episode_episode_id ................................ [[31mERROR[0m in 0.11s]
[0m20:14:05.073381 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f
[0m20:14:05.075123 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e
[0m20:14:05.077512 [info ] [Thread-1 (]: 2 of 4 START test not_null_merged_episode_manifestation_uid .................... [RUN]
[0m20:14:05.079341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_episode_id.74f77d4c8f, now test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e)
[0m20:14:05.080407 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e
[0m20:14:05.088882 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e"
[0m20:14:05.092076 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e (compile): 20:14:05.081424 => 20:14:05.091692
[0m20:14:05.093400 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e
[0m20:14:05.098318 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e"
[0m20:14:05.102108 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e"
[0m20:14:05.103262 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e: BEGIN
[0m20:14:05.104554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:05.122578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:05.124084 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e"
[0m20:14:05.125439 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_uid
from "dev_db"."public"."merged_episode"
where manifestation_uid is null



      
    ) dbt_internal_test
[0m20:14:05.128243 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "manifestation_uid" does not exist
LINE 13: select manifestation_uid
                ^

[0m20:14:05.129459 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e: ROLLBACK
[0m20:14:05.131044 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e (execute): 20:14:05.094462 => 20:14:05.130708
[0m20:14:05.131979 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e: Close
[0m20:14:05.136162 [debug] [Thread-1 (]: Database Error in test not_null_merged_episode_manifestation_uid (models/schema.yml)
  column "manifestation_uid" does not exist
  LINE 13: select manifestation_uid
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/not_null_merged_episode_manifestation_uid.sql
[0m20:14:05.137731 [error] [Thread-1 (]: 2 of 4 ERROR not_null_merged_episode_manifestation_uid ......................... [[31mERROR[0m in 0.06s]
[0m20:14:05.139350 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e
[0m20:14:05.140913 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_episode_id.c498859bee
[0m20:14:05.142134 [info ] [Thread-1 (]: 3 of 4 START test unique_merged_episode_episode_id ............................. [RUN]
[0m20:14:05.143878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_uid.5f37d1e77e, now test.dbt_poc.unique_merged_episode_episode_id.c498859bee)
[0m20:14:05.145158 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_episode_id.c498859bee
[0m20:14:05.157699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_episode_id.c498859bee"
[0m20:14:05.161672 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_id.c498859bee (compile): 20:14:05.146189 => 20:14:05.161069
[0m20:14:05.163267 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_episode_id.c498859bee
[0m20:14:05.168879 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_episode_id.c498859bee"
[0m20:14:05.173505 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_episode_id.c498859bee"
[0m20:14:05.175320 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_id.c498859bee: BEGIN
[0m20:14:05.176910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:05.196943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:05.198574 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_episode_id.c498859bee"
[0m20:14:05.200215 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_id.c498859bee: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_episode_id.c498859bee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where episode_id is not null
group by episode_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:05.203498 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "episode_id" does not exist
LINE 12:     episode_id as unique_field,
             ^

[0m20:14:05.205156 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_id.c498859bee: ROLLBACK
[0m20:14:05.207429 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_id.c498859bee (execute): 20:14:05.164219 => 20:14:05.206875
[0m20:14:05.209134 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_id.c498859bee: Close
[0m20:14:05.215579 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_episode_id (models/schema.yml)
  column "episode_id" does not exist
  LINE 12:     episode_id as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_episode_id.sql
[0m20:14:05.218030 [error] [Thread-1 (]: 3 of 4 ERROR unique_merged_episode_episode_id .................................. [[31mERROR[0m in 0.07s]
[0m20:14:05.220413 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_episode_id.c498859bee
[0m20:14:05.222278 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb
[0m20:14:05.224079 [info ] [Thread-1 (]: 4 of 4 START test unique_merged_episode_manifestation_uid ...................... [RUN]
[0m20:14:05.227513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.unique_merged_episode_episode_id.c498859bee, now test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb)
[0m20:14:05.229164 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb
[0m20:14:05.236285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb"
[0m20:14:05.239512 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb (compile): 20:14:05.230354 => 20:14:05.239125
[0m20:14:05.240697 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb
[0m20:14:05.245363 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb"
[0m20:14:05.249011 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb"
[0m20:14:05.250200 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb: BEGIN
[0m20:14:05.251244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:05.267467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:05.268806 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb"
[0m20:14:05.269946 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    manifestation_uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where manifestation_uid is not null
group by manifestation_uid
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:05.272354 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "manifestation_uid" does not exist
LINE 12:     manifestation_uid as unique_field,
             ^

[0m20:14:05.273562 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb: ROLLBACK
[0m20:14:05.275138 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb (execute): 20:14:05.241570 => 20:14:05.274808
[0m20:14:05.276241 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb: Close
[0m20:14:05.282608 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_manifestation_uid (models/schema.yml)
  column "manifestation_uid" does not exist
  LINE 12:     manifestation_uid as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_manifestation_uid.sql
[0m20:14:05.286018 [error] [Thread-1 (]: 4 of 4 ERROR unique_merged_episode_manifestation_uid ........................... [[31mERROR[0m in 0.06s]
[0m20:14:05.288915 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb
[0m20:14:05.294109 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:05.295842 [debug] [MainThread]: On master: BEGIN
[0m20:14:05.297245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:05.321509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:05.323529 [debug] [MainThread]: On master: COMMIT
[0m20:14:05.324949 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:05.326098 [debug] [MainThread]: On master: COMMIT
[0m20:14:05.327790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:05.328956 [debug] [MainThread]: On master: Close
[0m20:14:05.330813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:05.332192 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_manifestation_uid.7190c389cb' was properly closed.
[0m20:14:05.333455 [info ] [MainThread]: 
[0m20:14:05.335489 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:14:05.338898 [debug] [MainThread]: Command end result
[0m20:14:05.359735 [info ] [MainThread]: 
[0m20:14:05.361399 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m20:14:05.363476 [info ] [MainThread]: 
[0m20:14:05.365217 [error] [MainThread]:   Database Error in test not_null_merged_episode_episode_id (models/schema.yml)
  column "episode_id" does not exist
  LINE 13: select episode_id
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/not_null_merged_episode_episode_id.sql
[0m20:14:05.367107 [info ] [MainThread]: 
[0m20:14:05.368778 [error] [MainThread]:   Database Error in test not_null_merged_episode_manifestation_uid (models/schema.yml)
  column "manifestation_uid" does not exist
  LINE 13: select manifestation_uid
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/not_null_merged_episode_manifestation_uid.sql
[0m20:14:05.370187 [info ] [MainThread]: 
[0m20:14:05.371810 [error] [MainThread]:   Database Error in test unique_merged_episode_episode_id (models/schema.yml)
  column "episode_id" does not exist
  LINE 12:     episode_id as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_episode_id.sql
[0m20:14:05.373216 [info ] [MainThread]: 
[0m20:14:05.374796 [error] [MainThread]:   Database Error in test unique_merged_episode_manifestation_uid (models/schema.yml)
  column "manifestation_uid" does not exist
  LINE 12:     manifestation_uid as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_manifestation_uid.sql
[0m20:14:05.377346 [info ] [MainThread]: 
[0m20:14:05.379567 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:14:05.382199 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.849889, "process_user_time": 5.539549, "process_kernel_time": 0.252224, "process_mem_max_rss": "114056", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m20:14:05.383623 [debug] [MainThread]: Command `dbt test` failed at 20:14:05.383425 after 2.85 seconds
[0m20:14:05.385086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001a64c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001ab0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001ab2c90>]}
[0m20:14:05.386229 [debug] [MainThread]: Flushing usage events
[0m20:18:16.769230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa338c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa346550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa7e0790>]}


============================== 20:18:16.779416 | 0f48809b-a4db-409b-8155-77c71ba181da ==============================
[0m20:18:16.779416 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:18:16.780996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:17.003389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f8a8f050>]}
[0m20:18:17.089514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f8a8f050>]}
[0m20:18:17.091269 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:18:17.106272 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:18:17.121221 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:18:17.122375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f8aa6790>]}
[0m20:18:18.873688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m20:18:18.882855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f8894410>]}
[0m20:18:18.909396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f29b2cd0>]}
[0m20:18:18.910599 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:18:18.911977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f2895e90>]}
[0m20:18:18.915192 [info ] [MainThread]: 
[0m20:18:18.917195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:18.919712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m20:18:18.935805 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:18:18.937084 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m20:18:18.938012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:18.958205 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:18:18.959691 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:18:18.961046 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:18:18.971041 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:18:18.973633 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m20:18:18.974990 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m20:18:18.983807 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:18.985126 [debug] [MainThread]: On master: BEGIN
[0m20:18:18.986024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:19.001457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.002500 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:19.003503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:19.013188 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:18:19.016863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f48809b-a4db-409b-8155-77c71ba181da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f8ab42d0>]}
[0m20:18:19.018232 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:19.019423 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:19.020317 [debug] [MainThread]: On master: BEGIN
[0m20:18:19.021695 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.023018 [debug] [MainThread]: On master: COMMIT
[0m20:18:19.024093 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:19.025306 [debug] [MainThread]: On master: COMMIT
[0m20:18:19.026717 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:18:19.027828 [debug] [MainThread]: On master: Close
[0m20:18:19.029854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:19.031277 [info ] [MainThread]: 
[0m20:18:19.043773 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:18:19.045248 [info ] [Thread-1 (]: 1 of 4 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m20:18:19.048010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m20:18:19.049595 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:18:19.077099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:18:19.081911 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 20:18:19.051378 => 20:18:19.081367
[0m20:18:19.083133 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:18:19.107671 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:18:19.112931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:18:19.114733 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m20:18:19.116217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:19.134244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.135544 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:18:19.136626 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m20:18:19.141675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:18:19.145544 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 20:18:19.084134 => 20:18:19.145155
[0m20:18:19.147205 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m20:18:19.149045 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m20:18:19.151370 [info ] [Thread-1 (]: 1 of 4 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.10s]
[0m20:18:19.153975 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:18:19.155365 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:18:19.156896 [info ] [Thread-1 (]: 2 of 4 START test not_null_merged_episode_release_date ......................... [RUN]
[0m20:18:19.159128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m20:18:19.160617 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:18:19.169411 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:18:19.173172 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 20:18:19.161608 => 20:18:19.172704
[0m20:18:19.174577 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:18:19.180360 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:18:19.184562 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:18:19.186331 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m20:18:19.187421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:19.203263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.204566 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:18:19.205782 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m20:18:19.210476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:18:19.213460 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 20:18:19.175697 => 20:18:19.213109
[0m20:18:19.214572 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m20:18:19.215849 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m20:18:19.217980 [info ] [Thread-1 (]: 2 of 4 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m20:18:19.219731 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:18:19.221046 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387
[0m20:18:19.222216 [info ] [Thread-1 (]: 3 of 4 START test unique_merged_episode_manifestation_published_status ......... [RUN]
[0m20:18:19.224053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387)
[0m20:18:19.225088 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387
[0m20:18:19.235094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387"
[0m20:18:19.238198 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387 (compile): 20:18:19.225830 => 20:18:19.237761
[0m20:18:19.239257 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387
[0m20:18:19.243740 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387"
[0m20:18:19.247107 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387"
[0m20:18:19.248170 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387: BEGIN
[0m20:18:19.249433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:19.265511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.266653 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387"
[0m20:18:19.268077 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    manifestation_published_status as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where manifestation_published_status is not null
group by manifestation_published_status
having count(*) > 1



      
    ) dbt_internal_test
[0m20:18:19.273023 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:18:19.275765 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387 (execute): 20:18:19.240174 => 20:18:19.275422
[0m20:18:19.277019 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387: ROLLBACK
[0m20:18:19.278303 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387: Close
[0m20:18:19.280187 [error] [Thread-1 (]: 3 of 4 FAIL 2 unique_merged_episode_manifestation_published_status ............. [[31mFAIL 2[0m in 0.06s]
[0m20:18:19.281799 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387
[0m20:18:19.283215 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:18:19.284431 [info ] [Thread-1 (]: 4 of 4 START test unique_merged_episode_uid .................................... [RUN]
[0m20:18:19.286421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.unique_merged_episode_manifestation_published_status.8454d98387, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m20:18:19.287541 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:18:19.294209 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:18:19.297390 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 20:18:19.288359 => 20:18:19.297018
[0m20:18:19.298475 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:18:19.302710 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:18:19.305708 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:18:19.307107 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m20:18:19.308454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:19.327436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.328890 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:18:19.330189 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m20:18:19.334853 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:18:19.339388 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 20:18:19.299408 => 20:18:19.338601
[0m20:18:19.340802 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m20:18:19.342719 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m20:18:19.344811 [error] [Thread-1 (]: 4 of 4 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m20:18:19.347401 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:18:19.351065 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:19.352146 [debug] [MainThread]: On master: BEGIN
[0m20:18:19.353247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:19.370709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:19.371948 [debug] [MainThread]: On master: COMMIT
[0m20:18:19.372961 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:19.373981 [debug] [MainThread]: On master: COMMIT
[0m20:18:19.375532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:18:19.376693 [debug] [MainThread]: On master: Close
[0m20:18:19.379228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:19.380619 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m20:18:19.382351 [info ] [MainThread]: 
[0m20:18:19.384110 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:18:19.387054 [debug] [MainThread]: Command end result
[0m20:18:19.410766 [info ] [MainThread]: 
[0m20:18:19.413060 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:18:19.414307 [info ] [MainThread]: 
[0m20:18:19.415519 [error] [MainThread]: [31mFailure in test unique_merged_episode_manifestation_published_status (models/schema.yml)[0m
[0m20:18:19.416977 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m20:18:19.418120 [info ] [MainThread]: 
[0m20:18:19.419374 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_manifestation_published_status.sql
[0m20:18:19.420416 [info ] [MainThread]: 
[0m20:18:19.422410 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m20:18:19.423991 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m20:18:19.425177 [info ] [MainThread]: 
[0m20:18:19.426430 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m20:18:19.427651 [info ] [MainThread]: 
[0m20:18:19.428981 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m20:18:19.431069 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.7324579, "process_user_time": 5.501862, "process_kernel_time": 0.273672, "process_mem_max_rss": "113500", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m20:18:19.432438 [debug] [MainThread]: Command `dbt test` failed at 20:18:19.432243 after 2.73 seconds
[0m20:18:19.434147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa6a1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa36b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fe173290>]}
[0m20:18:19.435216 [debug] [MainThread]: Flushing usage events
[0m20:20:22.924196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187943dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187946b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1879448610>]}


============================== 20:20:22.933946 | 7fe713a3-9bf3-48ad-9dd9-51a1de063862 ==============================
[0m20:20:22.933946 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:20:22.935796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:23.184082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187946c350>]}
[0m20:20:23.272497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1877b71c10>]}
[0m20:20:23.274444 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:20:23.289029 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:20:23.304822 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:20:23.306359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1879416a10>]}
[0m20:20:25.413488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m20:20:25.424048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1877ab1b90>]}
[0m20:20:25.459468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1875881c50>]}
[0m20:20:25.460983 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:20:25.462767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1875b03f90>]}
[0m20:20:25.468697 [info ] [MainThread]: 
[0m20:20:25.473509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:25.477929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m20:20:25.504784 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:20:25.506924 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m20:20:25.508902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:25.535328 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.536785 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:20:25.538148 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:20:25.551435 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:20:25.567556 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m20:20:25.569638 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m20:20:25.580857 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.582062 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.583434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:25.618942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.620868 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.622374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:25.635831 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:20:25.639913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe713a3-9bf3-48ad-9dd9-51a1de063862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1875a83d10>]}
[0m20:20:25.641484 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:25.652130 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.653637 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.655904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.657156 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.658348 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.659437 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.660914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:25.661954 [debug] [MainThread]: On master: Close
[0m20:20:25.663948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:25.665438 [info ] [MainThread]: 
[0m20:20:25.680211 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:20:25.681948 [info ] [Thread-1 (]: 1 of 4 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m20:20:25.684737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m20:20:25.685997 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:20:25.714755 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:20:25.719688 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 20:20:25.687108 => 20:20:25.719185
[0m20:20:25.720973 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:20:25.746368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:20:25.751469 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:20:25.752833 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m20:20:25.756972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.792035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.793474 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:20:25.795025 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m20:20:25.800972 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:20:25.804956 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 20:20:25.722088 => 20:20:25.804539
[0m20:20:25.806222 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m20:20:25.807583 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m20:20:25.809576 [info ] [Thread-1 (]: 1 of 4 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.13s]
[0m20:20:25.811482 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:20:25.812761 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:20:25.813952 [info ] [Thread-1 (]: 2 of 4 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m20:20:25.816034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m20:20:25.817148 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:20:25.825876 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:20:25.829559 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 20:20:25.818010 => 20:20:25.829013
[0m20:20:25.830718 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:20:25.835538 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:20:25.838729 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:20:25.839909 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m20:20:25.841437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.858744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.859920 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:20:25.860984 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m20:20:25.865993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:20:25.868947 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 20:20:25.831888 => 20:20:25.868585
[0m20:20:25.869956 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m20:20:25.871497 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m20:20:25.873414 [info ] [Thread-1 (]: 2 of 4 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m20:20:25.874833 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:20:25.876134 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:20:25.877535 [info ] [Thread-1 (]: 3 of 4 START test not_null_merged_episode_release_date ......................... [RUN]
[0m20:20:25.879499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m20:20:25.880553 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:20:25.888164 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:20:25.892776 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 20:20:25.881429 => 20:20:25.892042
[0m20:20:25.894521 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:20:25.918130 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:20:25.922935 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:20:25.924265 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m20:20:25.925483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.943860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.944998 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:20:25.946169 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m20:20:25.950648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:20:25.953854 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 20:20:25.895734 => 20:20:25.953493
[0m20:20:25.954896 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m20:20:25.956308 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m20:20:25.958174 [info ] [Thread-1 (]: 3 of 4 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.08s]
[0m20:20:25.959863 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:20:25.961124 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce
[0m20:20:25.962394 [info ] [Thread-1 (]: 4 of 4 START test unique_merged_episode_episode_uid ............................ [RUN]
[0m20:20:25.964113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce)
[0m20:20:25.965420 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce
[0m20:20:25.975516 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce"
[0m20:20:25.978744 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce (compile): 20:20:25.966288 => 20:20:25.978326
[0m20:20:25.979870 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce
[0m20:20:25.984600 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce"
[0m20:20:25.987916 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce"
[0m20:20:25.989437 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce: BEGIN
[0m20:20:25.991016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:26.007941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:26.009190 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce"
[0m20:20:26.010465 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    episode_uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where episode_uid is not null
group by episode_uid
having count(*) > 1



      
    ) dbt_internal_test
[0m20:20:26.013106 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "episode_uid" does not exist
LINE 12:     episode_uid as unique_field,
             ^

[0m20:20:26.014412 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce: ROLLBACK
[0m20:20:26.015913 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce (execute): 20:20:25.981076 => 20:20:26.015580
[0m20:20:26.017486 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce: Close
[0m20:20:26.023605 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_episode_uid (models/schema.yml)
  column "episode_uid" does not exist
  LINE 12:     episode_uid as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_episode_uid.sql
[0m20:20:26.042144 [error] [Thread-1 (]: 4 of 4 ERROR unique_merged_episode_episode_uid ................................. [[31mERROR[0m in 0.08s]
[0m20:20:26.048855 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce
[0m20:20:26.059241 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:26.060571 [debug] [MainThread]: On master: BEGIN
[0m20:20:26.061563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:26.079113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:26.080385 [debug] [MainThread]: On master: COMMIT
[0m20:20:26.081269 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:26.082353 [debug] [MainThread]: On master: COMMIT
[0m20:20:26.083584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:26.084481 [debug] [MainThread]: On master: Close
[0m20:20:26.086160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:26.087407 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_episode_uid.1a459d3dce' was properly closed.
[0m20:20:26.088518 [info ] [MainThread]: 
[0m20:20:26.089658 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m20:20:26.091916 [debug] [MainThread]: Command end result
[0m20:20:26.112004 [info ] [MainThread]: 
[0m20:20:26.113448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:20:26.115171 [info ] [MainThread]: 
[0m20:20:26.116510 [error] [MainThread]:   Database Error in test unique_merged_episode_episode_uid (models/schema.yml)
  column "episode_uid" does not exist
  LINE 12:     episode_uid as unique_field,
               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_episode_uid.sql
[0m20:20:26.118623 [info ] [MainThread]: 
[0m20:20:26.120787 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:20:26.123280 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.2746394, "process_user_time": 5.876181, "process_kernel_time": 0.261116, "process_mem_max_rss": "114824", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m20:20:26.124632 [debug] [MainThread]: Command `dbt test` failed at 20:20:26.124222 after 3.28 seconds
[0m20:20:26.125682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187d56d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187d3f8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f187d274490>]}
[0m20:20:26.127452 [debug] [MainThread]: Flushing usage events
[0m20:20:58.997679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc914f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc9774a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcaa8e490>]}


============================== 20:20:59.007018 | 1b143421-85cb-49a7-a067-8bf57d0d7933 ==============================
[0m20:20:59.007018 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:20:59.008682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:59.230964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc7a77990>]}
[0m20:20:59.318944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc9137a90>]}
[0m20:20:59.320882 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:20:59.337750 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:20:59.354581 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:20:59.356379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc7a2a710>]}
[0m20:21:01.102601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m20:21:01.113043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc7768ed0>]}
[0m20:21:01.139695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc5700390>]}
[0m20:21:01.141375 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:21:01.142699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcc0a90d0>]}
[0m20:21:01.146116 [info ] [MainThread]: 
[0m20:21:01.147980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:21:01.151120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m20:21:01.167076 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:21:01.168355 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m20:21:01.169391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:01.186985 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.188260 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:21:01.189232 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:21:01.197574 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:21:01.199945 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m20:21:01.201390 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m20:21:01.209309 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.210300 [debug] [MainThread]: On master: BEGIN
[0m20:21:01.211200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:01.227414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.228652 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.229667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:21:01.239055 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:21:01.242611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b143421-85cb-49a7-a067-8bf57d0d7933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc5899fd0>]}
[0m20:21:01.243819 [debug] [MainThread]: On master: ROLLBACK
[0m20:21:01.245249 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.246233 [debug] [MainThread]: On master: BEGIN
[0m20:21:01.247772 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.248836 [debug] [MainThread]: On master: COMMIT
[0m20:21:01.249731 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.250606 [debug] [MainThread]: On master: COMMIT
[0m20:21:01.251749 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:21:01.252718 [debug] [MainThread]: On master: Close
[0m20:21:01.254392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:01.255718 [info ] [MainThread]: 
[0m20:21:01.269663 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:21:01.271157 [info ] [Thread-1 (]: 1 of 4 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m20:21:01.273734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m20:21:01.275023 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:21:01.301028 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:21:01.305871 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 20:21:01.276169 => 20:21:01.305397
[0m20:21:01.307183 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:21:01.334560 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:21:01.339226 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:21:01.341091 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m20:21:01.342491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.362311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.365392 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:21:01.366639 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m20:21:01.372109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:21:01.376498 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 20:21:01.308622 => 20:21:01.376010
[0m20:21:01.377542 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m20:21:01.378911 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m20:21:01.380927 [info ] [Thread-1 (]: 1 of 4 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.11s]
[0m20:21:01.382748 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:21:01.384068 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:21:01.385333 [info ] [Thread-1 (]: 2 of 4 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m20:21:01.387134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m20:21:01.388306 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:21:01.396734 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:21:01.400217 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 20:21:01.389077 => 20:21:01.399731
[0m20:21:01.401381 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:21:01.405860 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:21:01.409370 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:21:01.410771 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m20:21:01.412233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.430849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.432032 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:21:01.433059 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m20:21:01.437742 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:21:01.440742 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 20:21:01.402215 => 20:21:01.440350
[0m20:21:01.441947 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m20:21:01.443472 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m20:21:01.445425 [info ] [Thread-1 (]: 2 of 4 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m20:21:01.447353 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:21:01.448610 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:21:01.449834 [info ] [Thread-1 (]: 3 of 4 START test not_null_merged_episode_release_date ......................... [RUN]
[0m20:21:01.451693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m20:21:01.452758 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:21:01.459797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:21:01.462876 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 20:21:01.453597 => 20:21:01.462472
[0m20:21:01.464330 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:21:01.468622 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:21:01.471362 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:21:01.472747 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m20:21:01.473967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.491221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.492576 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:21:01.493679 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m20:21:01.498297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:21:01.501357 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 20:21:01.465359 => 20:21:01.500903
[0m20:21:01.502568 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m20:21:01.504037 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m20:21:01.505921 [info ] [Thread-1 (]: 3 of 4 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m20:21:01.507715 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:21:01.508968 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:21:01.510166 [info ] [Thread-1 (]: 4 of 4 START test unique_merged_episode_uid .................................... [RUN]
[0m20:21:01.511885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m20:21:01.513075 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:21:01.522792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:21:01.526498 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 20:21:01.514134 => 20:21:01.525900
[0m20:21:01.527604 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:21:01.532208 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:21:01.535885 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:21:01.537385 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m20:21:01.540195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.557628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.558918 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:21:01.560288 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m20:21:01.565305 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:21:01.568181 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 20:21:01.528584 => 20:21:01.567829
[0m20:21:01.569419 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m20:21:01.570833 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m20:21:01.573577 [error] [Thread-1 (]: 4 of 4 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m20:21:01.575813 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:21:01.579708 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.580767 [debug] [MainThread]: On master: BEGIN
[0m20:21:01.581620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:01.598605 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:21:01.599682 [debug] [MainThread]: On master: COMMIT
[0m20:21:01.600623 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:01.601710 [debug] [MainThread]: On master: COMMIT
[0m20:21:01.604358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:21:01.606962 [debug] [MainThread]: On master: Close
[0m20:21:01.609514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:01.610733 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m20:21:01.611920 [info ] [MainThread]: 
[0m20:21:01.613569 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:21:01.616414 [debug] [MainThread]: Command end result
[0m20:21:01.634318 [info ] [MainThread]: 
[0m20:21:01.635652 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:21:01.636864 [info ] [MainThread]: 
[0m20:21:01.638418 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m20:21:01.639917 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m20:21:01.641756 [info ] [MainThread]: 
[0m20:21:01.643061 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m20:21:01.644481 [info ] [MainThread]: 
[0m20:21:01.645745 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:21:01.647818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.7186778, "process_user_time": 5.614045, "process_kernel_time": 0.285944, "process_mem_max_rss": "113668", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m20:21:01.649259 [debug] [MainThread]: Command `dbt test` failed at 20:21:01.648938 after 2.72 seconds
[0m20:21:01.650311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddc99264d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd0d7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd1c84d0>]}
[0m20:21:01.651413 [debug] [MainThread]: Flushing usage events
[0m20:28:20.310806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f99f7fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9a5f4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9ae0f890>]}


============================== 20:28:20.324126 | 654adc89-bc57-4225-9623-25ce4de6dd3a ==============================
[0m20:28:20.324126 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:28:20.326726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:28:20.580268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '654adc89-bc57-4225-9623-25ce4de6dd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9a0169d0>]}
[0m20:28:20.671132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '654adc89-bc57-4225-9623-25ce4de6dd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f988fbe10>]}
[0m20:28:20.673148 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:28:20.687550 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:28:20.740156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:28:20.741928 [debug] [MainThread]: Partial parsing: added file: dbt_poc://tests/merged_episode_test.sql
[0m20:28:20.911820 [error] [MainThread]: Encountered an error:
Compilation Error in test merged_episode_test (tests/merged_episode_test.sql)
  expected token '(', got 'end of statement block'
    line 3
      {% test manifestation_referential_integrity %}
[0m20:28:20.916883 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6995003, "process_user_time": 3.546479, "process_kernel_time": 0.187993, "process_mem_max_rss": "102256", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m20:28:20.919410 [debug] [MainThread]: Command `dbt test` failed at 20:28:20.919185 after 0.70 seconds
[0m20:28:20.921977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f99f84990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f99fd4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9e04c4d0>]}
[0m20:28:20.923405 [debug] [MainThread]: Flushing usage events
[0m20:35:57.497150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbcfee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbd658a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbd036910>]}


============================== 20:35:57.505861 | abf0ee8f-a686-4112-b99c-326f2316ca89 ==============================
[0m20:35:57.505861 [info ] [MainThread]: Running with dbt=1.7.14
[0m20:35:57.507419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:57.727577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbb90f090>]}
[0m20:35:57.816851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbcfe3cd0>]}
[0m20:35:57.818677 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m20:35:57.832953 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m20:35:57.885109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:35:57.886514 [debug] [MainThread]: Partial parsing: added file: dbt_poc://tests/merged_episode_test.sql
[0m20:35:58.049126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m20:35:58.057147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbb600950>]}
[0m20:35:58.087746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbb7a0c10>]}
[0m20:35:58.089194 [info ] [MainThread]: Found 1 model, 2 seeds, 5 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:35:58.090452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbb7ba350>]}
[0m20:35:58.094244 [info ] [MainThread]: 
[0m20:35:58.098191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:58.101082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m20:35:58.119486 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:35:58.120969 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m20:35:58.122030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:58.140801 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.141925 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m20:35:58.142981 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:58.152874 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:35:58.155987 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m20:35:58.157941 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m20:35:58.169803 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.171183 [debug] [MainThread]: On master: BEGIN
[0m20:35:58.172795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:58.196833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.198987 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.200553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:58.218528 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:35:58.225120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abf0ee8f-a686-4112-b99c-326f2316ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbb7a10d0>]}
[0m20:35:58.226880 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:58.228821 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.230891 [debug] [MainThread]: On master: BEGIN
[0m20:35:58.233253 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.234838 [debug] [MainThread]: On master: COMMIT
[0m20:35:58.236351 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.237975 [debug] [MainThread]: On master: COMMIT
[0m20:35:58.240856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:58.242165 [debug] [MainThread]: On master: Close
[0m20:35:58.244321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:35:58.245732 [info ] [MainThread]: 
[0m20:35:58.262918 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m20:35:58.264450 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m20:35:58.266698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m20:35:58.268221 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m20:35:58.286597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m20:35:58.293246 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 20:35:58.270120 => 20:35:58.292562
[0m20:35:58.294959 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m20:35:58.320241 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m20:35:58.324398 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m20:35:58.325492 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m20:35:58.326539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:58.343811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.345139 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m20:35:58.346311 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table


-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m20:35:58.348230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:     ) dbt_internal_test
             ^

[0m20:35:58.349432 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m20:35:58.351213 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 20:35:58.296024 => 20:35:58.350871
[0m20:35:58.352293 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m20:35:58.358513 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 28:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m20:35:58.360100 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m20:35:58.362200 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m20:35:58.363415 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:35:58.365722 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m20:35:58.367801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m20:35:58.369037 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:35:58.387398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:35:58.391172 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 20:35:58.370209 => 20:35:58.390772
[0m20:35:58.392316 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:35:58.397185 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:35:58.401528 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:35:58.403188 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m20:35:58.404425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:58.421558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.422753 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m20:35:58.423785 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m20:35:58.428683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:35:58.432407 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 20:35:58.393353 => 20:35:58.431996
[0m20:35:58.433716 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m20:35:58.435182 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m20:35:58.437147 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m20:35:58.438922 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m20:35:58.440245 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:35:58.441680 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m20:35:58.443715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m20:35:58.445082 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:35:58.452170 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:35:58.458072 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 20:35:58.446022 => 20:35:58.457580
[0m20:35:58.459845 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:35:58.465422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:35:58.471194 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:35:58.473157 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m20:35:58.474444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:58.498954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.508802 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m20:35:58.510295 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m20:35:58.517153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:35:58.521387 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 20:35:58.461350 => 20:35:58.520910
[0m20:35:58.523151 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m20:35:58.525991 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m20:35:58.529105 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.09s]
[0m20:35:58.533600 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m20:35:58.535865 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:35:58.537654 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m20:35:58.540701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m20:35:58.542390 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:35:58.556846 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:35:58.562307 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 20:35:58.543678 => 20:35:58.561381
[0m20:35:58.565085 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:35:58.577069 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:35:58.583339 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:35:58.585405 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m20:35:58.587270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:58.611683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.613395 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m20:35:58.615371 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m20:35:58.621941 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:35:58.625550 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 20:35:58.570133 => 20:35:58.625137
[0m20:35:58.627488 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m20:35:58.629872 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m20:35:58.632433 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.09s]
[0m20:35:58.636808 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m20:35:58.646779 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:35:58.654564 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m20:35:58.660692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m20:35:58.670286 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:35:58.688239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:35:58.692201 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 20:35:58.673561 => 20:35:58.691693
[0m20:35:58.693418 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:35:58.698078 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:35:58.701987 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:35:58.703354 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m20:35:58.705095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:58.723047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.724375 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m20:35:58.725907 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m20:35:58.731519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:35:58.735029 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 20:35:58.694436 => 20:35:58.734611
[0m20:35:58.736334 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m20:35:58.738242 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m20:35:58.740481 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.08s]
[0m20:35:58.742415 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m20:35:58.746838 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.748168 [debug] [MainThread]: On master: BEGIN
[0m20:35:58.749315 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:58.768037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:58.769988 [debug] [MainThread]: On master: COMMIT
[0m20:35:58.771502 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:58.772966 [debug] [MainThread]: On master: COMMIT
[0m20:35:58.775053 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:58.776245 [debug] [MainThread]: On master: Close
[0m20:35:58.778036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:58.779298 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m20:35:58.780893 [info ] [MainThread]: 
[0m20:35:58.782395 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m20:35:58.785386 [debug] [MainThread]: Command end result
[0m20:35:58.810008 [info ] [MainThread]: 
[0m20:35:58.812364 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:35:58.814727 [info ] [MainThread]: 
[0m20:35:58.817122 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 28:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m20:35:58.819223 [info ] [MainThread]: 
[0m20:35:58.821002 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m20:35:58.822444 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m20:35:58.824173 [info ] [MainThread]: 
[0m20:35:58.826035 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m20:35:58.827851 [info ] [MainThread]: 
[0m20:35:58.829820 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:35:58.832245 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.402096, "process_user_time": 3.986808, "process_kernel_time": 0.24547, "process_mem_max_rss": "109316", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m20:35:58.833815 [debug] [MainThread]: Command `dbt test` failed at 20:35:58.833489 after 1.40 seconds
[0m20:35:58.835378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbcfee390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbcfec990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc0fbf450>]}
[0m20:35:58.836939 [debug] [MainThread]: Flushing usage events
[0m00:16:32.755777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d006e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d67cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d615a90>]}


============================== 00:16:32.765290 | c6a76d97-243b-4e19-b6bf-840c2acd9942 ==============================
[0m00:16:32.765290 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:16:32.767306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:33.007245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d0055d0>]}
[0m00:16:33.099367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d02bad0>]}
[0m00:16:33.101386 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:16:33.126127 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:16:33.199698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:33.203107 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:16:33.422695 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m00:16:33.431034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92b860890>]}
[0m00:16:33.459970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92b5f9c10>]}
[0m00:16:33.461456 [info ] [MainThread]: Found 1 model, 2 seeds, 5 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:16:33.462678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92b7d4c50>]}
[0m00:16:33.465973 [info ] [MainThread]: 
[0m00:16:33.468397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:33.471191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:16:33.487545 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:16:33.488818 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:16:33.489857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:33.509766 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.511057 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:16:33.512063 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:16:33.521870 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:16:33.525036 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:16:33.526426 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:16:33.535839 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:33.537197 [debug] [MainThread]: On master: BEGIN
[0m00:16:33.538300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:33.558086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.559463 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:33.560878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:33.572172 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:16:33.575243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a76d97-243b-4e19-b6bf-840c2acd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92b5eb790>]}
[0m00:16:33.576401 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:33.577917 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:33.578999 [debug] [MainThread]: On master: BEGIN
[0m00:16:33.580799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.582130 [debug] [MainThread]: On master: COMMIT
[0m00:16:33.583284 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:33.584332 [debug] [MainThread]: On master: COMMIT
[0m00:16:33.585895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:16:33.586963 [debug] [MainThread]: On master: Close
[0m00:16:33.588793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:33.590059 [info ] [MainThread]: 
[0m00:16:33.605043 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:16:33.606425 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:16:33.608492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:16:33.609998 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:16:33.627116 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:16:33.635810 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:16:33.611140 => 00:16:33.635149
[0m00:16:33.637836 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:16:33.663889 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:16:33.668299 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:16:33.669452 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:16:33.670665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:33.687378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.688759 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:16:33.689763 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table


-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:16:33.691165 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:     ) dbt_internal_test
             ^

[0m00:16:33.692264 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:16:33.693856 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:16:33.638908 => 00:16:33.693436
[0m00:16:33.694930 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:16:33.700986 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 28:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:16:33.702533 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m00:16:33.704322 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:16:33.705929 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:16:33.707889 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:16:33.709508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:16:33.710605 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:16:33.725455 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:16:33.730058 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:16:33.711339 => 00:16:33.729692
[0m00:16:33.731181 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:16:33.735357 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:16:33.739752 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:16:33.740986 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:16:33.742125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:33.759249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.761111 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:16:33.762287 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:16:33.767457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:16:33.771333 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:16:33.732037 => 00:16:33.770940
[0m00:16:33.773041 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:16:33.774514 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:16:33.776341 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m00:16:33.778206 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:16:33.779434 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:16:33.780748 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:16:33.782329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:16:33.783496 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:16:33.790603 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:16:33.794447 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:16:33.784633 => 00:16:33.794104
[0m00:16:33.795752 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:16:33.799813 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:16:33.802956 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:16:33.804126 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:16:33.805416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:33.826597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.827773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:16:33.828715 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:16:33.833235 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:16:33.836332 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:16:33.796609 => 00:16:33.835991
[0m00:16:33.837453 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:16:33.838819 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:16:33.840501 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:16:33.842015 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:16:33.843415 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:16:33.844616 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:16:33.846232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:16:33.847373 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:16:33.856150 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:16:33.859155 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:16:33.848197 => 00:16:33.858806
[0m00:16:33.860116 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:16:33.864140 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:16:33.867480 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:16:33.868776 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:16:33.870023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:33.889149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.890677 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:16:33.891742 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:16:33.895907 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:16:33.898606 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:16:33.860921 => 00:16:33.898273
[0m00:16:33.899756 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:16:33.901014 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:16:33.902811 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m00:16:33.904449 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:16:33.906369 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:16:33.907629 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m00:16:33.909359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m00:16:33.911045 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:16:33.921721 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:16:33.925517 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 00:16:33.912006 => 00:16:33.925115
[0m00:16:33.926759 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:16:33.932384 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:16:33.937100 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:16:33.938384 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m00:16:33.940050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:33.956467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:33.957701 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:16:33.958744 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:16:33.963372 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:16:33.966362 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 00:16:33.928974 => 00:16:33.966016
[0m00:16:33.967485 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m00:16:33.968860 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m00:16:33.970753 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m00:16:33.973228 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:16:33.977226 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:33.978319 [debug] [MainThread]: On master: BEGIN
[0m00:16:33.979814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:34.000013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:34.001218 [debug] [MainThread]: On master: COMMIT
[0m00:16:34.002357 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:34.003624 [debug] [MainThread]: On master: COMMIT
[0m00:16:34.004919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:16:34.005952 [debug] [MainThread]: On master: Close
[0m00:16:34.007656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:34.010187 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m00:16:34.011422 [info ] [MainThread]: 
[0m00:16:34.012922 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:16:34.015773 [debug] [MainThread]: Command end result
[0m00:16:34.036100 [info ] [MainThread]: 
[0m00:16:34.038483 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:16:34.040945 [info ] [MainThread]: 
[0m00:16:34.042343 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 28:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:16:34.043941 [info ] [MainThread]: 
[0m00:16:34.045324 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m00:16:34.047017 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m00:16:34.050771 [info ] [MainThread]: 
[0m00:16:34.052519 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m00:16:34.054813 [info ] [MainThread]: 
[0m00:16:34.056395 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:16:34.058885 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3737563, "process_user_time": 3.972713, "process_kernel_time": 0.246433, "process_mem_max_rss": "109616", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:16:34.060282 [debug] [MainThread]: Command `dbt test` failed at 00:16:34.060079 after 1.38 seconds
[0m00:16:34.061515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92d00c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd930fdc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd930fdc610>]}
[0m00:16:34.062806 [debug] [MainThread]: Flushing usage events
[0m00:25:58.053838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2f6fd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2e246310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2e2462d0>]}


============================== 00:25:58.062136 | 66b04051-76a8-46c7-81e6-9552d411c636 ==============================
[0m00:25:58.062136 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:25:58.064120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:25:58.291359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2e284f50>]}
[0m00:25:58.377158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2cb33ed0>]}
[0m00:25:58.379053 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:25:58.393404 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:25:58.446995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:58.448382 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:25:58.623514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m00:25:58.632053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2ca2d850>]}
[0m00:25:58.664504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2c7c7c50>]}
[0m00:25:58.665915 [info ] [MainThread]: Found 1 model, 2 seeds, 5 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:25:58.667463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2c9f2350>]}
[0m00:25:58.671095 [info ] [MainThread]: 
[0m00:25:58.673245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:25:58.675947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:25:58.692347 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:25:58.693520 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:25:58.694866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:58.715981 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:25:58.717074 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:25:58.718265 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:25:58.727818 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:25:58.730530 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:25:58.732020 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:25:58.741368 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:58.742636 [debug] [MainThread]: On master: BEGIN
[0m00:25:58.743723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:58.762368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:58.763714 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:58.764838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:25:58.776354 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:25:58.779565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b04051-76a8-46c7-81e6-9552d411c636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2c8b9190>]}
[0m00:25:58.780849 [debug] [MainThread]: On master: ROLLBACK
[0m00:25:58.782189 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:58.783166 [debug] [MainThread]: On master: BEGIN
[0m00:25:58.784711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:58.785763 [debug] [MainThread]: On master: COMMIT
[0m00:25:58.786763 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:58.787772 [debug] [MainThread]: On master: COMMIT
[0m00:25:58.788904 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:58.789769 [debug] [MainThread]: On master: Close
[0m00:25:58.791278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:58.792798 [info ] [MainThread]: 
[0m00:25:58.805990 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:25:58.807266 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:25:58.809228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:25:58.810425 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:25:58.825556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:25:58.830705 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:25:58.811320 => 00:25:58.830202
[0m00:25:58.831812 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:25:58.855736 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:25:58.860278 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:25:58.861385 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:25:58.862483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:58.878913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:58.880112 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:25:58.881148 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:25:58.882766 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:25:58.883750 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:25:58.885275 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:25:58.832583 => 00:25:58.884945
[0m00:25:58.886265 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:25:58.892131 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:25:58.893401 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.08s]
[0m00:25:58.895049 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:25:58.896201 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:25:58.898013 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:25:58.899739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:25:58.900832 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:25:58.915593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:25:58.921511 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:25:58.901742 => 00:25:58.921091
[0m00:25:58.922769 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:25:58.927075 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:25:58.932296 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:25:58.933363 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:25:58.934728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:58.951030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:58.952384 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:25:58.953788 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:25:58.958419 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:25:58.961966 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:25:58.923525 => 00:25:58.961564
[0m00:25:58.963008 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:25:58.964793 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:25:58.966740 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m00:25:58.968696 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:25:58.969926 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:25:58.971016 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:25:58.972782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:25:58.973851 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:25:58.981166 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:25:58.987909 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:25:58.974709 => 00:25:58.987376
[0m00:25:58.989093 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:25:58.993306 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:25:58.996545 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:25:58.998173 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:25:58.999568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:59.015852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:59.016927 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:25:59.018074 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:25:59.022414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:25:59.025099 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:25:58.989986 => 00:25:59.024761
[0m00:25:59.026240 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:25:59.027812 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:25:59.029565 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:25:59.031367 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:25:59.032767 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:25:59.033907 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:25:59.035843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:25:59.036880 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:25:59.045564 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:25:59.050803 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:25:59.037843 => 00:25:59.050274
[0m00:25:59.052180 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:25:59.056733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:25:59.060058 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:25:59.061194 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:25:59.062081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:59.078229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:59.079433 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:25:59.080781 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:25:59.084877 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:25:59.087655 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:25:59.053205 => 00:25:59.087262
[0m00:25:59.088739 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:25:59.089912 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:25:59.091510 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m00:25:59.093176 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:25:59.094546 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:25:59.095776 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m00:25:59.097519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m00:25:59.098787 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:25:59.108227 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:25:59.111291 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 00:25:59.099530 => 00:25:59.110936
[0m00:25:59.112338 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:25:59.116315 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:25:59.119805 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:25:59.120925 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m00:25:59.122706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:59.139132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:59.140262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:25:59.141284 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:25:59.145810 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:25:59.148412 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 00:25:59.113162 => 00:25:59.148083
[0m00:25:59.149297 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m00:25:59.150472 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m00:25:59.152251 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m00:25:59.154356 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:25:59.158554 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:59.159642 [debug] [MainThread]: On master: BEGIN
[0m00:25:59.160699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:59.177758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:59.178889 [debug] [MainThread]: On master: COMMIT
[0m00:25:59.179907 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:59.180840 [debug] [MainThread]: On master: COMMIT
[0m00:25:59.182033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:59.182979 [debug] [MainThread]: On master: Close
[0m00:25:59.184471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:59.186402 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m00:25:59.188011 [info ] [MainThread]: 
[0m00:25:59.189184 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m00:25:59.191714 [debug] [MainThread]: Command end result
[0m00:25:59.211811 [info ] [MainThread]: 
[0m00:25:59.213335 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:25:59.214653 [info ] [MainThread]: 
[0m00:25:59.215645 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:25:59.216655 [info ] [MainThread]: 
[0m00:25:59.217936 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m00:25:59.219457 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m00:25:59.221079 [info ] [MainThread]: 
[0m00:25:59.222407 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m00:25:59.223989 [info ] [MainThread]: 
[0m00:25:59.225171 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:25:59.227285 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2436997, "process_user_time": 3.967079, "process_kernel_time": 0.237524, "process_mem_max_rss": "110216", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:25:59.228599 [debug] [MainThread]: Command `dbt test` failed at 00:25:59.228358 after 1.25 seconds
[0m00:25:59.229844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2e225590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff32350b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff32350a50>]}
[0m00:25:59.231043 [debug] [MainThread]: Flushing usage events
[0m00:28:58.856430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca244e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca2a84a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca2421d10>]}


============================== 00:28:58.865684 | fbf1f77a-f033-47af-9de2-d72c7795f7eb ==============================
[0m00:28:58.865684 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:28:58.867265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:59.087299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca0d5af10>]}
[0m00:28:59.174302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca0cd5150>]}
[0m00:28:59.176059 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:28:59.189924 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:28:59.205666 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:28:59.207316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca0ce54d0>]}
[0m00:29:00.919534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m00:29:00.928315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9a814790>]}
[0m00:29:00.952422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9a9bfd10>]}
[0m00:29:00.953807 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:29:00.955101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9a863d90>]}
[0m00:29:00.958523 [info ] [MainThread]: 
[0m00:29:00.960390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:00.963246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:29:00.979642 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:29:00.981085 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:29:00.982270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:01.001150 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.002465 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:29:01.003490 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:29:01.012432 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:29:01.014924 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:29:01.016112 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:29:01.024503 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.025451 [debug] [MainThread]: On master: BEGIN
[0m00:29:01.026388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:01.042284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.043446 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.044541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:29:01.054584 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:29:01.057690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf1f77a-f033-47af-9de2-d72c7795f7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca0c589d0>]}
[0m00:29:01.058884 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:01.060207 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.061124 [debug] [MainThread]: On master: BEGIN
[0m00:29:01.062684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.063713 [debug] [MainThread]: On master: COMMIT
[0m00:29:01.064924 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.065877 [debug] [MainThread]: On master: COMMIT
[0m00:29:01.067059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:01.068137 [debug] [MainThread]: On master: Close
[0m00:29:01.069907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:01.070992 [info ] [MainThread]: 
[0m00:29:01.084893 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:29:01.086138 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m00:29:01.088140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:29:01.089269 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:29:01.104264 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:29:01.107992 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:29:01.090145 => 00:29:01.107511
[0m00:29:01.109005 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:29:01.133308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:29:01.137043 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:29:01.138080 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:29:01.139069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:01.155687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.157130 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:29:01.158258 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:29:01.159958 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:29:01.161061 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:29:01.162646 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:29:01.109822 => 00:29:01.162298
[0m00:29:01.163808 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:29:01.170227 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:29:01.171615 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.08s]
[0m00:29:01.173457 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:29:01.175084 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:29:01.177311 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:29:01.179573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:29:01.181198 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:29:01.200212 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:29:01.204617 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:29:01.182736 => 00:29:01.204215
[0m00:29:01.205989 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:29:01.210361 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:29:01.215071 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:29:01.217204 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:29:01.219285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:01.261285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.264359 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:29:01.267266 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:29:01.281963 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:01.287200 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:29:01.206994 => 00:29:01.286727
[0m00:29:01.288675 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:29:01.290381 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:29:01.292510 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.11s]
[0m00:29:01.294294 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:29:01.295647 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:29:01.296962 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:29:01.298679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:29:01.300033 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:29:01.306624 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:29:01.309434 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:29:01.300831 => 00:29:01.309071
[0m00:29:01.310488 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:29:01.316418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:29:01.319527 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:29:01.320617 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:29:01.321692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:01.337627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.338996 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:29:01.340000 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:29:01.344214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:01.347372 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:29:01.311424 => 00:29:01.346998
[0m00:29:01.348546 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:29:01.350175 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:29:01.352230 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.05s]
[0m00:29:01.353963 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:29:01.355139 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:29:01.356503 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:29:01.358580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:29:01.359697 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:29:01.367381 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:29:01.370467 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:29:01.360561 => 00:29:01.370089
[0m00:29:01.371529 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:29:01.375595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:29:01.378682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:29:01.380128 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:29:01.381625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:01.398005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.399130 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:29:01.400199 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:29:01.404683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:01.408085 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:29:01.372389 => 00:29:01.407663
[0m00:29:01.409323 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:29:01.410919 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:29:01.412602 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m00:29:01.415686 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:29:01.417092 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_episode_uid.772d46d827
[0m00:29:01.418274 [info ] [Thread-1 (]: 5 of 6 START test unique_merged_episode_episode_uid ............................ [RUN]
[0m00:29:01.419939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_episode_uid.772d46d827)
[0m00:29:01.420961 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_episode_uid.772d46d827
[0m00:29:01.431350 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_uid.772d46d827 (compile): 00:29:01.421812 => 00:29:01.430767
[0m00:29:01.435496 [debug] [Thread-1 (]: Compilation Error in test unique_merged_episode_episode_uid (models/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'command'
[0m00:29:01.436895 [error] [Thread-1 (]: 5 of 6 ERROR unique_merged_episode_episode_uid ................................. [[31mERROR[0m in 0.02s]
[0m00:29:01.438128 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_episode_uid.772d46d827
[0m00:29:01.439819 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:29:01.440963 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m00:29:01.442502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.unique_merged_episode_episode_uid.772d46d827, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m00:29:01.443544 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:29:01.451718 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:29:01.454483 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 00:29:01.444385 => 00:29:01.454142
[0m00:29:01.455459 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:29:01.459603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:29:01.462722 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:29:01.463980 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m00:29:01.465266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:01.483072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.484354 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:29:01.485427 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:29:01.489834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:01.492537 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 00:29:01.456249 => 00:29:01.492214
[0m00:29:01.493604 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m00:29:01.495040 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m00:29:01.496667 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.05s]
[0m00:29:01.498414 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:29:01.502065 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.503050 [debug] [MainThread]: On master: BEGIN
[0m00:29:01.503927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:01.520442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:01.521791 [debug] [MainThread]: On master: COMMIT
[0m00:29:01.522654 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:01.523584 [debug] [MainThread]: On master: COMMIT
[0m00:29:01.525021 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:01.526127 [debug] [MainThread]: On master: Close
[0m00:29:01.527563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:01.528507 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m00:29:01.529872 [info ] [MainThread]: 
[0m00:29:01.531008 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:29:01.533631 [debug] [MainThread]: Command end result
[0m00:29:01.551423 [info ] [MainThread]: 
[0m00:29:01.553313 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:29:01.554843 [info ] [MainThread]: 
[0m00:29:01.556195 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:29:01.557521 [info ] [MainThread]: 
[0m00:29:01.559322 [error] [MainThread]:   Compilation Error in test unique_merged_episode_episode_uid (models/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'command'
[0m00:29:01.560890 [info ] [MainThread]: 
[0m00:29:01.562158 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m00:29:01.563332 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m00:29:01.565076 [info ] [MainThread]: 
[0m00:29:01.566632 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m00:29:01.568352 [info ] [MainThread]: 
[0m00:29:01.569666 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m00:29:01.571660 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.782441, "process_user_time": 5.197035, "process_kernel_time": 0.247574, "process_mem_max_rss": "117396", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:29:01.573088 [debug] [MainThread]: Command `dbt test` failed at 00:29:01.572897 after 2.78 seconds
[0m00:29:01.574213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca244e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca2404950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca2405850>]}
[0m00:29:01.575497 [debug] [MainThread]: Flushing usage events
[0m00:30:02.086378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b1e15050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b0559bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b0559dd0>]}


============================== 00:30:02.094832 | 38762225-ca14-40dd-bda8-6f0b20030944 ==============================
[0m00:30:02.094832 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:30:02.096628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:30:02.322379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38762225-ca14-40dd-bda8-6f0b20030944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9aee36590>]}
[0m00:30:02.415279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38762225-ca14-40dd-bda8-6f0b20030944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b0533850>]}
[0m00:30:02.416988 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:30:02.430993 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:30:02.483171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:30:02.485135 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:30:02.923279 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'episode_uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:30:02.925906 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.90834975, "process_user_time": 3.725645, "process_kernel_time": 0.210465, "process_mem_max_rss": "105620", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:30:02.927503 [debug] [MainThread]: Command `dbt test` failed at 00:30:02.927280 after 0.91 seconds
[0m00:30:02.928896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b0586f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b0586390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b46003d0>]}
[0m00:30:02.930181 [debug] [MainThread]: Flushing usage events
[0m00:30:57.963126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751eb81b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7520499f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751f0f90d0>]}


============================== 00:30:57.971517 | 9e573fd5-d8e7-4a92-8fa6-16605431c84e ==============================
[0m00:30:57.971517 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:30:57.973102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:58.200276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751d450e90>]}
[0m00:30:58.303643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751eba8350>]}
[0m00:30:58.305704 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:30:58.320574 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:30:58.338189 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:30:58.340124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751ec0b390>]}
[0m00:31:00.140295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m00:31:00.150399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751c050bd0>]}
[0m00:31:00.181281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75171ec4d0>]}
[0m00:31:00.182979 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:31:00.184426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751713b950>]}
[0m00:31:00.188330 [info ] [MainThread]: 
[0m00:31:00.190982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:00.193651 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:31:00.211742 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:31:00.213494 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:31:00.214922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:00.235391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.248279 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:31:00.249548 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:31:00.259513 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:31:00.262445 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:31:00.263743 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:31:00.271986 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.273211 [debug] [MainThread]: On master: BEGIN
[0m00:31:00.274189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:00.290228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.291379 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.292504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:00.303193 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:00.306871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e573fd5-d8e7-4a92-8fa6-16605431c84e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75171a9f10>]}
[0m00:31:00.308153 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:00.309567 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.310664 [debug] [MainThread]: On master: BEGIN
[0m00:31:00.312274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.313277 [debug] [MainThread]: On master: COMMIT
[0m00:31:00.314104 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.314962 [debug] [MainThread]: On master: COMMIT
[0m00:31:00.316080 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:00.316991 [debug] [MainThread]: On master: Close
[0m00:31:00.318689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:00.320255 [info ] [MainThread]: 
[0m00:31:00.333581 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:31:00.335007 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:31:00.336789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:31:00.338028 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:31:00.353235 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:31:00.358040 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:31:00.338936 => 00:31:00.357444
[0m00:31:00.359303 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:31:00.383941 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:31:00.387844 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:31:00.389062 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:31:00.390053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:00.407416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.408596 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:31:00.409759 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:31:00.411452 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:31:00.412430 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:31:00.413980 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:31:00.360528 => 00:31:00.413549
[0m00:31:00.415067 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:31:00.420855 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:31:00.422484 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m00:31:00.424320 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:31:00.425619 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:31:00.427946 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:31:00.429799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:31:00.431278 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:31:00.447907 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:31:00.452142 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:31:00.432509 => 00:31:00.451629
[0m00:31:00.453184 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:31:00.457968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:31:00.462236 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:31:00.463669 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:31:00.464763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:00.481297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.482437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:31:00.483507 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:31:00.488069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:00.491655 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:31:00.454088 => 00:31:00.491291
[0m00:31:00.492756 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:31:00.494546 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:31:00.496415 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m00:31:00.498156 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:31:00.499535 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:31:00.500690 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:31:00.502539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:31:00.503719 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:31:00.511340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:31:00.514793 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:31:00.504709 => 00:31:00.514370
[0m00:31:00.516174 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:31:00.523173 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:31:00.528617 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:31:00.530351 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:31:00.531644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:00.550358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.551527 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:31:00.553062 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:31:00.557732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:00.561031 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:31:00.517144 => 00:31:00.560594
[0m00:31:00.562229 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:31:00.563740 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:31:00.565796 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:31:00.567864 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:31:00.569221 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:31:00.570360 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:31:00.571955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:31:00.573323 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:31:00.581071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:31:00.584611 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:31:00.574555 => 00:31:00.584197
[0m00:31:00.585732 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:31:00.590321 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:31:00.593952 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:31:00.595714 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:31:00.597317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:00.617075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.618533 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:31:00.619684 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:31:00.624221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:00.627224 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:31:00.586657 => 00:31:00.626785
[0m00:31:00.628450 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:31:00.629768 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:31:00.631647 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m00:31:00.633415 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:31:00.634711 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163
[0m00:31:00.635760 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid_episode_uid ........................ [RUN]
[0m00:31:00.637683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163)
[0m00:31:00.639165 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163
[0m00:31:00.649490 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163"
[0m00:31:00.653525 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163 (compile): 00:31:00.640150 => 00:31:00.653070
[0m00:31:00.655407 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163
[0m00:31:00.660773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163"
[0m00:31:00.665567 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163"
[0m00:31:00.667078 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163: BEGIN
[0m00:31:00.668179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:00.684619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.685939 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163"
[0m00:31:00.687078 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid, episode_uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid, episode_uid is not null
group by uid, episode_uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:31:00.688482 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 16: where uid, episode_uid is not null
                  ^

[0m00:31:00.689650 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163: ROLLBACK
[0m00:31:00.691306 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163 (execute): 00:31:00.656875 => 00:31:00.690975
[0m00:31:00.692507 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163: Close
[0m00:31:00.696890 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near ","
  LINE 16: where uid, episode_uid is not null
                    ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:31:00.698225 [error] [Thread-1 (]: 5 of 5 ERROR unique_merged_episode_uid_episode_uid ............................. [[31mERROR[0m in 0.06s]
[0m00:31:00.700084 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163
[0m00:31:00.703588 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.704664 [debug] [MainThread]: On master: BEGIN
[0m00:31:00.706052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:00.722492 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:00.724477 [debug] [MainThread]: On master: COMMIT
[0m00:31:00.726163 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:00.727907 [debug] [MainThread]: On master: COMMIT
[0m00:31:00.729729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:00.731265 [debug] [MainThread]: On master: Close
[0m00:31:00.733174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:00.734581 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid_episode_uid.886dd19163' was properly closed.
[0m00:31:00.735978 [info ] [MainThread]: 
[0m00:31:00.737449 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m00:31:00.740514 [debug] [MainThread]: Command end result
[0m00:31:00.759000 [info ] [MainThread]: 
[0m00:31:00.760518 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:31:00.762251 [info ] [MainThread]: 
[0m00:31:00.764236 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:31:00.766010 [info ] [MainThread]: 
[0m00:31:00.767403 [error] [MainThread]:   Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near ","
  LINE 16: where uid, episode_uid is not null
                    ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:31:00.768757 [info ] [MainThread]: 
[0m00:31:00.770364 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:31:00.772793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.8771458, "process_user_time": 5.515988, "process_kernel_time": 0.264486, "process_mem_max_rss": "116900", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:31:00.774844 [debug] [MainThread]: Command `dbt test` failed at 00:31:00.774635 after 2.88 seconds
[0m00:31:00.776231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751ebccdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f751ebcffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522c38450>]}
[0m00:31:00.777421 [debug] [MainThread]: Flushing usage events
[0m00:31:58.372725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3473cb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34741a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3473cb890>]}


============================== 00:31:58.383234 | 60d405ac-38d0-4266-9ef8-7191fa0f78f3 ==============================
[0m00:31:58.383234 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:31:58.385188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m00:31:58.629078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa345d472d0>]}
[0m00:31:58.714237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa347403a10>]}
[0m00:31:58.716193 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:31:58.731339 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:31:58.746863 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:31:58.748481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa345d05e10>]}
[0m00:32:00.471398 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m00:32:00.480477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3459da790>]}
[0m00:32:00.502471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3459fec10>]}
[0m00:32:00.503733 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:32:00.505349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa345aee290>]}
[0m00:32:00.509087 [info ] [MainThread]: 
[0m00:32:00.510923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:32:00.513533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:32:00.529811 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:32:00.531191 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:32:00.532182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:00.549563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.550610 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:32:00.551510 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:32:00.560640 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:32:00.563162 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:32:00.564378 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:32:00.572576 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.573660 [debug] [MainThread]: On master: BEGIN
[0m00:32:00.574516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:32:00.590733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.591795 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.593029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:32:00.602710 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:32:00.606660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d405ac-38d0-4266-9ef8-7191fa0f78f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33f9bd910>]}
[0m00:32:00.608085 [debug] [MainThread]: On master: ROLLBACK
[0m00:32:00.609359 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.610320 [debug] [MainThread]: On master: BEGIN
[0m00:32:00.611704 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.612709 [debug] [MainThread]: On master: COMMIT
[0m00:32:00.613654 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.614632 [debug] [MainThread]: On master: COMMIT
[0m00:32:00.615994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:32:00.616976 [debug] [MainThread]: On master: Close
[0m00:32:00.618634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:32:00.620032 [info ] [MainThread]: 
[0m00:32:00.632115 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:32:00.633347 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:32:00.634868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:32:00.636147 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:32:00.651659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:32:00.655635 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:32:00.637067 => 00:32:00.655232
[0m00:32:00.656670 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:32:00.680044 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:32:00.683667 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:32:00.684734 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:32:00.685685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:00.701262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.702371 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:32:00.703440 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:32:00.705097 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:32:00.706076 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:32:00.707562 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:32:00.657572 => 00:32:00.707241
[0m00:32:00.708820 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:32:00.714890 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:32:00.716346 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.08s]
[0m00:32:00.717905 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:32:00.719626 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:32:00.721831 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:32:00.724064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:32:00.725051 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:32:00.739970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:32:00.743408 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:32:00.725903 => 00:32:00.742954
[0m00:32:00.744475 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:32:00.748645 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:32:00.751639 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:32:00.752822 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:32:00.754083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:00.771750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.772876 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:32:00.774201 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:32:00.778902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:00.782502 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:32:00.745383 => 00:32:00.782135
[0m00:32:00.783781 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:32:00.785296 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:32:00.787170 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m00:32:00.788909 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:32:00.790162 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:32:00.791305 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:32:00.793298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:32:00.794431 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:32:00.801738 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:32:00.806074 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:32:00.795366 => 00:32:00.805403
[0m00:32:00.807367 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:32:00.813857 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:32:00.817588 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:32:00.818668 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:32:00.819731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:00.836072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.837259 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:32:00.838414 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:32:00.842839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:00.845551 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:32:00.808606 => 00:32:00.845228
[0m00:32:00.846624 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:32:00.847984 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:32:00.849727 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:32:00.851530 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:32:00.852998 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:32:00.854210 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:32:00.856140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:32:00.857228 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:32:00.864135 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:32:00.867250 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:32:00.858229 => 00:32:00.866814
[0m00:32:00.868425 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:32:00.872475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:32:00.875291 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:32:00.876746 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:32:00.878101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:00.893764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.895022 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:32:00.896080 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:32:00.900094 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:00.902659 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:32:00.869190 => 00:32:00.902319
[0m00:32:00.903975 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:32:00.905343 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:32:00.907072 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m00:32:00.908681 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:32:00.910291 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34
[0m00:32:00.911485 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid_episode_uid ........................ [RUN]
[0m00:32:00.913237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34)
[0m00:32:00.914314 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34
[0m00:32:00.924316 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34"
[0m00:32:00.927382 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34 (compile): 00:32:00.915131 => 00:32:00.927035
[0m00:32:00.928482 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34
[0m00:32:00.932838 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34"
[0m00:32:00.936103 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34"
[0m00:32:00.937142 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34: BEGIN
[0m00:32:00.938409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:00.954208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.955310 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34"
[0m00:32:00.956440 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid episode_uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid episode_uid is not null
group by uid episode_uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:32:00.958041 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 12:     uid episode_uid as unique_field,
                             ^

[0m00:32:00.959107 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34: ROLLBACK
[0m00:32:00.960530 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34 (execute): 00:32:00.929423 => 00:32:00.960195
[0m00:32:00.961456 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34: Close
[0m00:32:00.965596 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near "as"
  LINE 12:     uid episode_uid as unique_field,
                               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:32:00.966881 [error] [Thread-1 (]: 5 of 5 ERROR unique_merged_episode_uid_episode_uid ............................. [[31mERROR[0m in 0.05s]
[0m00:32:00.968630 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34
[0m00:32:00.972424 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.973555 [debug] [MainThread]: On master: BEGIN
[0m00:32:00.974585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:32:00.991117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:00.992323 [debug] [MainThread]: On master: COMMIT
[0m00:32:00.993360 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:00.994381 [debug] [MainThread]: On master: COMMIT
[0m00:32:00.995799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:32:00.996940 [debug] [MainThread]: On master: Close
[0m00:32:00.998403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:00.999478 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid_episode_uid.27ac24ed34' was properly closed.
[0m00:32:01.000427 [info ] [MainThread]: 
[0m00:32:01.001534 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:32:01.003943 [debug] [MainThread]: Command end result
[0m00:32:01.021371 [info ] [MainThread]: 
[0m00:32:01.022793 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:32:01.024588 [info ] [MainThread]: 
[0m00:32:01.026612 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:32:01.028417 [info ] [MainThread]: 
[0m00:32:01.029732 [error] [MainThread]:   Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near "as"
  LINE 12:     uid episode_uid as unique_field,
                               ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:32:01.031085 [info ] [MainThread]: 
[0m00:32:01.032199 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:32:01.034067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.7360876, "process_user_time": 5.318407, "process_kernel_time": 0.245258, "process_mem_max_rss": "117152", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:32:01.035310 [debug] [MainThread]: Command `dbt test` failed at 00:32:01.035129 after 2.74 seconds
[0m00:32:01.036422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3473d0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34741c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34b3a0610>]}
[0m00:32:01.037472 [debug] [MainThread]: Flushing usage events
[0m00:34:22.776026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb974950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdc80fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdbfec550>]}


============================== 00:34:22.785184 | 5101d1e5-3af2-40df-b7d0-c13f11e64550 ==============================
[0m00:34:22.785184 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:34:22.787059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:23.015522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda2d2050>]}
[0m00:34:23.115759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda17c550>]}
[0m00:34:23.118144 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:34:23.133587 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:34:23.150101 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:34:23.152135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda097010>]}
[0m00:34:25.117173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m00:34:25.129963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbdc7b90>]}
[0m00:34:25.156096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbc1cb90>]}
[0m00:34:25.157393 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:34:25.159017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbc6d110>]}
[0m00:34:25.162996 [info ] [MainThread]: 
[0m00:34:25.165621 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:34:25.169141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:34:25.186308 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:34:25.187993 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:34:25.189091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:25.209463 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.210772 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:34:25.211940 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:34:25.221645 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:34:25.225250 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:34:25.226993 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:34:25.235955 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.237196 [debug] [MainThread]: On master: BEGIN
[0m00:34:25.238163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:25.254462 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.255620 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.256875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:34:25.267480 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:34:25.271032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5101d1e5-3af2-40df-b7d0-c13f11e64550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbc6d210>]}
[0m00:34:25.272338 [debug] [MainThread]: On master: ROLLBACK
[0m00:34:25.273714 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.274709 [debug] [MainThread]: On master: BEGIN
[0m00:34:25.276297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.277231 [debug] [MainThread]: On master: COMMIT
[0m00:34:25.278069 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.278879 [debug] [MainThread]: On master: COMMIT
[0m00:34:25.279965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:25.280882 [debug] [MainThread]: On master: Close
[0m00:34:25.282406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:25.284021 [info ] [MainThread]: 
[0m00:34:25.296708 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:34:25.298022 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:34:25.300113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:34:25.301240 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:34:25.318401 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:34:25.323999 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:34:25.302024 => 00:34:25.323398
[0m00:34:25.325289 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:34:25.352647 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:34:25.356415 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:34:25.357434 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:34:25.358505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.375625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.377677 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:34:25.379143 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:34:25.381320 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:34:25.382480 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:34:25.384174 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:34:25.326282 => 00:34:25.383752
[0m00:34:25.385293 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:34:25.391489 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:34:25.393079 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m00:34:25.394729 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:34:25.396060 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:34:25.398368 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:34:25.400047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:34:25.401086 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:34:25.417583 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:34:25.421337 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:34:25.401920 => 00:34:25.420921
[0m00:34:25.422496 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:34:25.430401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:34:25.435755 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:34:25.437076 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:34:25.438263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.455487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.457032 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:34:25.458362 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:34:25.464209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:25.474364 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:34:25.423368 => 00:34:25.473640
[0m00:34:25.475983 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:34:25.478028 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:34:25.480350 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.08s]
[0m00:34:25.482377 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:34:25.483930 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:34:25.485236 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:34:25.487071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:34:25.488359 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:34:25.495452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:34:25.499588 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:34:25.489316 => 00:34:25.499012
[0m00:34:25.501257 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:34:25.513437 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:34:25.517428 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:34:25.519151 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:34:25.521229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.540420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.541768 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:34:25.543141 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:34:25.548076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:25.551613 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:34:25.502376 => 00:34:25.551133
[0m00:34:25.553140 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:34:25.554803 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:34:25.557339 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.07s]
[0m00:34:25.559507 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:34:25.561172 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:34:25.563612 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:34:25.565828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:34:25.567337 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:34:25.574950 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:34:25.578686 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:34:25.568302 => 00:34:25.578274
[0m00:34:25.580061 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:34:25.584241 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:34:25.587791 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:34:25.590119 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:34:25.596576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.630257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.631640 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:34:25.632998 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:34:25.638636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:25.642152 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:34:25.581023 => 00:34:25.641631
[0m00:34:25.643760 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:34:25.646045 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:34:25.648638 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.08s]
[0m00:34:25.650806 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:34:25.652592 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f
[0m00:34:25.654058 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_episode_uid__uid ....................... [RUN]
[0m00:34:25.656255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f)
[0m00:34:25.657453 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f
[0m00:34:25.668630 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f (compile): 00:34:25.658520 => 00:34:25.668170
[0m00:34:25.672722 [debug] [Thread-1 (]: Compilation Error in test unique_merged_episode_episode_uid__uid (models/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'colum_name'
[0m00:34:25.674390 [error] [Thread-1 (]: 5 of 5 ERROR unique_merged_episode_episode_uid__uid ............................ [[31mERROR[0m in 0.02s]
[0m00:34:25.676467 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f
[0m00:34:25.680600 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.681848 [debug] [MainThread]: On master: BEGIN
[0m00:34:25.682722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:25.699621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:25.700905 [debug] [MainThread]: On master: COMMIT
[0m00:34:25.701891 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:25.702738 [debug] [MainThread]: On master: COMMIT
[0m00:34:25.704144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:25.705383 [debug] [MainThread]: On master: Close
[0m00:34:25.707121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:25.708280 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_episode_uid__uid.606c3a085f' was properly closed.
[0m00:34:25.709687 [info ] [MainThread]: 
[0m00:34:25.711343 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:34:25.714381 [debug] [MainThread]: Command end result
[0m00:34:25.735253 [info ] [MainThread]: 
[0m00:34:25.736705 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:34:25.738308 [info ] [MainThread]: 
[0m00:34:25.739978 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:34:25.741631 [info ] [MainThread]: 
[0m00:34:25.743324 [error] [MainThread]:   Compilation Error in test unique_merged_episode_episode_uid__uid (models/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'colum_name'
[0m00:34:25.745235 [info ] [MainThread]: 
[0m00:34:25.746576 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:34:25.749110 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.041168, "process_user_time": 5.593574, "process_kernel_time": 0.246986, "process_mem_max_rss": "116976", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:34:25.750502 [debug] [MainThread]: Command `dbt test` failed at 00:34:25.750282 after 3.04 seconds
[0m00:34:25.751780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb97ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdbfec6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd80b9f10>]}
[0m00:34:25.753109 [debug] [MainThread]: Flushing usage events
[0m00:35:13.658053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213d53fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213da6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213d533d0>]}


============================== 00:35:13.666323 | a6d9de22-3f7a-4540-a5d7-28278884ea20 ==============================
[0m00:35:13.666323 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:35:13.667757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:35:13.899667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2126b5050>]}
[0m00:35:13.985013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213d93810>]}
[0m00:35:13.986863 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:35:14.000338 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:35:14.016245 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:35:14.017661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc212557110>]}
[0m00:35:15.790966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m00:35:15.800667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2103ed1d0>]}
[0m00:35:15.826252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc210324390>]}
[0m00:35:15.827637 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:35:15.828924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc210260150>]}
[0m00:35:15.832973 [info ] [MainThread]: 
[0m00:35:15.834957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:35:15.838966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:35:15.854695 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:35:15.855840 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:35:15.856871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:15.874829 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:35:15.876081 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:35:15.877169 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:35:15.886230 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:35:15.888685 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:35:15.889955 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:35:15.898144 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:15.899124 [debug] [MainThread]: On master: BEGIN
[0m00:35:15.900054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:35:15.915686 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:35:15.916745 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:15.918086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:35:15.929368 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:35:15.932923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d9de22-3f7a-4540-a5d7-28278884ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2123f04d0>]}
[0m00:35:15.934253 [debug] [MainThread]: On master: ROLLBACK
[0m00:35:15.935581 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:15.936549 [debug] [MainThread]: On master: BEGIN
[0m00:35:15.938155 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:35:15.939147 [debug] [MainThread]: On master: COMMIT
[0m00:35:15.940045 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:15.940871 [debug] [MainThread]: On master: COMMIT
[0m00:35:15.942369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:35:15.943353 [debug] [MainThread]: On master: Close
[0m00:35:15.944933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:35:15.946261 [info ] [MainThread]: 
[0m00:35:15.958816 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:35:15.960089 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:35:15.961960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:35:15.963211 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:35:15.979207 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:35:15.984774 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:35:15.964123 => 00:35:15.984166
[0m00:35:15.986201 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:35:16.014904 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:35:16.055254 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:35:16.059633 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:35:16.067768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:16.090316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.091668 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:35:16.093219 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- Test for unique combination of episode_id and manifestation_eidrid


-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- Test for matching episode uid between episode and manifestation tables

      
    ) dbt_internal_test
[0m00:35:16.095540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:     ) dbt_internal_test
             ^

[0m00:35:16.096769 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:35:16.098455 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:35:15.987183 => 00:35:16.098101
[0m00:35:16.099666 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:35:16.113704 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:35:16.120424 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.16s]
[0m00:35:16.139797 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:35:16.142124 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:35:16.144744 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:35:16.148113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:35:16.150326 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:35:16.170243 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:35:16.176246 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:35:16.151520 => 00:35:16.175430
[0m00:35:16.178503 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:35:16.189686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:35:16.196684 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:35:16.198216 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:35:16.199552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:16.227882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.229371 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:35:16.230640 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:35:16.236840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:35:16.240767 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:35:16.180529 => 00:35:16.240408
[0m00:35:16.242125 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:35:16.243683 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:35:16.245833 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.10s]
[0m00:35:16.248099 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:35:16.249414 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:35:16.250572 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:35:16.252397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:35:16.254272 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:35:16.261526 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:35:16.264523 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:35:16.255247 => 00:35:16.264128
[0m00:35:16.265572 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:35:16.272127 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:35:16.275295 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:35:16.276520 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:35:16.277647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:16.294925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.296425 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:35:16.297593 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:35:16.302141 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:35:16.305019 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:35:16.266721 => 00:35:16.304662
[0m00:35:16.306665 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:35:16.308610 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:35:16.310673 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:35:16.312959 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:35:16.314856 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:35:16.316518 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:35:16.318626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:35:16.319850 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:35:16.326892 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:35:16.331060 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:35:16.320833 => 00:35:16.330578
[0m00:35:16.332275 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:35:16.336826 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:35:16.340117 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:35:16.341368 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:35:16.342555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:16.358885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.360275 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:35:16.361595 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:35:16.365967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:35:16.368901 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:35:16.333277 => 00:35:16.368544
[0m00:35:16.370137 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:35:16.371466 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:35:16.373425 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m00:35:16.375312 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:35:16.376749 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b
[0m00:35:16.378136 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid_episode_uid ........................ [RUN]
[0m00:35:16.379835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b)
[0m00:35:16.381052 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b
[0m00:35:16.390922 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b"
[0m00:35:16.394143 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b (compile): 00:35:16.381950 => 00:35:16.393692
[0m00:35:16.395251 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b
[0m00:35:16.399260 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b"
[0m00:35:16.402178 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b"
[0m00:35:16.403172 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b: BEGIN
[0m00:35:16.404245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:16.420436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.421570 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b"
[0m00:35:16.422622 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid; episode_uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid; episode_uid is not null
group by uid; episode_uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:35:16.424228 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     uid; episode_uid as unique_field,
                ^

[0m00:35:16.425236 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b: ROLLBACK
[0m00:35:16.426881 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b (execute): 00:35:16.396038 => 00:35:16.426546
[0m00:35:16.428193 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b: Close
[0m00:35:16.432498 [debug] [Thread-1 (]: Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near ";"
  LINE 12:     uid; episode_uid as unique_field,
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:35:16.434162 [error] [Thread-1 (]: 5 of 5 ERROR unique_merged_episode_uid_episode_uid ............................. [[31mERROR[0m in 0.05s]
[0m00:35:16.435799 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b
[0m00:35:16.439277 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:16.440368 [debug] [MainThread]: On master: BEGIN
[0m00:35:16.441363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:35:16.457385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:35:16.458605 [debug] [MainThread]: On master: COMMIT
[0m00:35:16.459524 [debug] [MainThread]: Using postgres connection "master"
[0m00:35:16.460416 [debug] [MainThread]: On master: COMMIT
[0m00:35:16.461647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:35:16.462619 [debug] [MainThread]: On master: Close
[0m00:35:16.464439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:16.465476 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid_episode_uid.6998582a7b' was properly closed.
[0m00:35:16.466547 [info ] [MainThread]: 
[0m00:35:16.467813 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m00:35:16.470685 [debug] [MainThread]: Command end result
[0m00:35:16.488145 [info ] [MainThread]: 
[0m00:35:16.489554 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:35:16.490801 [info ] [MainThread]: 
[0m00:35:16.492281 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 29:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:35:16.493684 [info ] [MainThread]: 
[0m00:35:16.495320 [error] [MainThread]:   Database Error in test unique_merged_episode_uid_episode_uid (models/schema.yml)
  syntax error at or near ";"
  LINE 12:     uid; episode_uid as unique_field,
                  ^
  compiled Code at target/run/dbt_poc/models/schema.yml/unique_merged_episode_uid_episode_uid.sql
[0m00:35:16.496592 [info ] [MainThread]: 
[0m00:35:16.498471 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:35:16.500576 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.9276648, "process_user_time": 5.401934, "process_kernel_time": 0.287737, "process_mem_max_rss": "115116", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:35:16.501846 [debug] [MainThread]: Command `dbt test` failed at 00:35:16.501656 after 2.93 seconds
[0m00:35:16.503082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213d58a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213da8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc21244cbd0>]}
[0m00:35:16.504201 [debug] [MainThread]: Flushing usage events
[0m00:38:38.707009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8c5b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8c3dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8c3f590>]}


============================== 00:38:38.716306 | b6c4db68-90fc-469e-b2d0-efb2270a0930 ==============================
[0m00:38:38.716306 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:38:38.717904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:39.013238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c4db68-90fc-469e-b2d0-efb2270a0930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd7595e90>]}
[0m00:38:39.100169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c4db68-90fc-469e-b2d0-efb2270a0930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd9239b50>]}
[0m00:38:39.101928 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:38:39.115282 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:38:39.169993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:39.171599 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:38:39.437403 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:38:39.439595 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.80127174, "process_user_time": 3.632728, "process_kernel_time": 0.212914, "process_mem_max_rss": "104056", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:38:39.441122 [debug] [MainThread]: Command `dbt test` failed at 00:38:39.440842 after 0.80 seconds
[0m00:38:39.442341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8c3d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8c3ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd75d71d0>]}
[0m00:38:39.443512 [debug] [MainThread]: Flushing usage events
[0m00:42:59.053406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72eb0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72efb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72eb2550>]}


============================== 00:42:59.062653 | 4eb88487-2c10-42a1-9aa4-cfe741d8b49e ==============================
[0m00:42:59.062653 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:42:59.064343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:42:59.284492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb88487-2c10-42a1-9aa4-cfe741d8b49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72f3e790>]}
[0m00:42:59.372661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb88487-2c10-42a1-9aa4-cfe741d8b49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72ea7e90>]}
[0m00:42:59.374786 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:42:59.389069 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:42:59.440194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:42:59.441845 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:42:59.443041 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:42:59.842014 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:42:59.844454 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.85931593, "process_user_time": 3.526615, "process_kernel_time": 0.163605, "process_mem_max_rss": "107680", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:42:59.845899 [debug] [MainThread]: Command `dbt test` failed at 00:42:59.845692 after 0.86 seconds
[0m00:42:59.846967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d743b0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d76ff8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d76e9ea50>]}
[0m00:42:59.848015 [debug] [MainThread]: Flushing usage events
[0m00:44:42.779161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab83d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab83b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab83290>]}


============================== 00:44:42.787531 | 68f4c20e-8836-4c5e-a3a2-c3f46dfe7976 ==============================
[0m00:44:42.787531 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:44:42.788989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:44:43.015595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68f4c20e-8836-4c5e-a3a2-c3f46dfe7976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab76910>]}
[0m00:44:43.110164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68f4c20e-8836-4c5e-a3a2-c3f46dfe7976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3af1dc50>]}
[0m00:44:43.111962 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:44:43.126134 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:44:43.179592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:44:43.181425 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:44:43.182593 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:44:43.581718 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:44:43.583972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8748799, "process_user_time": 3.62047, "process_kernel_time": 0.229066, "process_mem_max_rss": "107856", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:44:43.585314 [debug] [MainThread]: Command `dbt test` failed at 00:44:43.585125 after 0.88 seconds
[0m00:44:43.586506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3ab84750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb39326610>]}
[0m00:44:43.587551 [debug] [MainThread]: Flushing usage events
[0m00:45:13.362706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100876d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100dbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100adc50>]}


============================== 00:45:13.372214 | e67e49e1-99e4-448b-85c4-9e29767ce17d ==============================
[0m00:45:13.372214 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:45:13.374368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m00:45:13.603495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e67e49e1-99e4-448b-85c4-9e29767ce17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811011de50>]}
[0m00:45:13.690762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e67e49e1-99e4-448b-85c4-9e29767ce17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100c7790>]}
[0m00:45:13.692574 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:45:13.713459 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:45:13.801907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:45:13.804762 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:45:13.806513 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:45:14.230853 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:45:14.233019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.94591326, "process_user_time": 3.698202, "process_kernel_time": 0.201609, "process_mem_max_rss": "105624", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:45:14.234776 [debug] [MainThread]: Command `dbt test` failed at 00:45:14.234576 after 0.95 seconds
[0m00:45:14.235969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100909d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81100dcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810c7d6b50>]}
[0m00:45:14.237205 [debug] [MainThread]: Flushing usage events
[0m00:46:18.226040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329f891b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329ff008d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329f8bec10>]}


============================== 00:46:18.234580 | 00f15b51-cbfc-4e26-8307-f982b20c67d3 ==============================
[0m00:46:18.234580 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:46:18.236220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:46:18.460344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00f15b51-cbfc-4e26-8307-f982b20c67d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32a06e12d0>]}
[0m00:46:18.548820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00f15b51-cbfc-4e26-8307-f982b20c67d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329f89d650>]}
[0m00:46:18.550644 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:46:18.564271 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:46:18.616127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:46:18.618034 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:46:18.619075 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:46:19.018644 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:46:19.020818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8627695, "process_user_time": 3.602182, "process_kernel_time": 0.210701, "process_mem_max_rss": "105716", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:46:19.022152 [debug] [MainThread]: Command `dbt test` failed at 00:46:19.021908 after 0.86 seconds
[0m00:46:19.023353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329f8c3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329f8c3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329e06f6d0>]}
[0m00:46:19.024402 [debug] [MainThread]: Flushing usage events
[0m00:47:13.363963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11c5c09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11cbc1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11c5c2550>]}


============================== 00:47:13.373279 | 9f974cee-7cc5-46e5-a2fa-f91931148033 ==============================
[0m00:47:13.373279 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:47:13.375354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:47:13.612141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f974cee-7cc5-46e5-a2fa-f91931148033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11aeb7d90>]}
[0m00:47:13.705627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f974cee-7cc5-46e5-a2fa-f91931148033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11af27610>]}
[0m00:47:13.710176 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:47:13.726372 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:47:13.819860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:47:13.823406 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:47:13.826156 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:47:14.285654 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:47:14.288289 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.9946366, "process_user_time": 3.790522, "process_kernel_time": 0.238052, "process_mem_max_rss": "105308", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:47:14.289856 [debug] [MainThread]: Command `dbt test` failed at 00:47:14.289576 after 1.00 seconds
[0m00:47:14.291138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11c5dcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff118b971d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11ac10bd0>]}
[0m00:47:14.292417 [debug] [MainThread]: Flushing usage events
[0m00:48:02.437408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f48be7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f4906590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f4f48c50>]}


============================== 00:48:02.446313 | 2918a3a0-9fc4-4325-a304-2d3acc839481 ==============================
[0m00:48:02.446313 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:48:02.447821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:02.671892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2918a3a0-9fc4-4325-a304-2d3acc839481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f494bc10>]}
[0m00:48:02.762021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2918a3a0-9fc4-4325-a304-2d3acc839481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f3205f90>]}
[0m00:48:02.763829 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:48:02.777197 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:48:02.826413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:48:02.828082 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:48:02.829317 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:48:03.220194 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:48:03.222523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8531351, "process_user_time": 3.619352, "process_kernel_time": 0.214277, "process_mem_max_rss": "105820", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:48:03.224410 [debug] [MainThread]: Command `dbt test` failed at 00:48:03.224211 after 0.86 seconds
[0m00:48:03.225769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5743b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f11f8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f88ab4d0>]}
[0m00:48:03.226915 [debug] [MainThread]: Flushing usage events
[0m00:48:44.067644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94bacb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94bacc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94abde10>]}


============================== 00:48:44.076072 | 4a28fb41-a68b-404a-85e1-6eed738fff3d ==============================
[0m00:48:44.076072 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:48:44.077809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:44.305509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a28fb41-a68b-404a-85e1-6eed738fff3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad92e19d90>]}
[0m00:48:44.396450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a28fb41-a68b-404a-85e1-6eed738fff3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad92d3c550>]}
[0m00:48:44.398259 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:48:44.412723 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:48:44.472235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:48:44.474257 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:48:44.475682 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:48:44.914039 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:48:44.916235 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.91664594, "process_user_time": 3.74118, "process_kernel_time": 0.178347, "process_mem_max_rss": "105592", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:48:44.917761 [debug] [MainThread]: Command `dbt test` failed at 00:48:44.917550 after 0.92 seconds
[0m00:48:44.918883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad9453cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad9458a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad9458a090>]}
[0m00:48:44.920026 [debug] [MainThread]: Flushing usage events
[0m00:50:00.981652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a23e0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a1dc35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a1d967d0>]}


============================== 00:50:00.990358 | f7467ae5-321c-4e1e-8cec-d1310dd9af54 ==============================
[0m00:50:00.990358 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:50:00.992542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:50:01.251681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7467ae5-321c-4e1e-8cec-d1310dd9af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0656a90>]}
[0m00:50:01.339359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7467ae5-321c-4e1e-8cec-d1310dd9af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a1d83110>]}
[0m00:50:01.341069 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:50:01.355194 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:50:01.407540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:50:01.409296 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://models/schema.yml
[0m00:50:01.410482 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m00:50:01.923105 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', None), ('column_name', 'uid')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:50:01.926587 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0138745, "process_user_time": 3.876041, "process_kernel_time": 0.228797, "process_mem_max_rss": "105476", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m00:50:01.928364 [debug] [MainThread]: Command `dbt test` failed at 00:50:01.928127 after 1.02 seconds
[0m00:50:01.929674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a22f7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a1d74810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a03d64d0>]}
[0m00:50:01.930939 [debug] [MainThread]: Flushing usage events
[0m00:51:29.174530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d679790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d678890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1e4c9690>]}


============================== 00:51:29.183375 | edc82ef1-c7d1-47ba-a2e9-e2419357f7f3 ==============================
[0m00:51:29.183375 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:51:29.185565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:29.417397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d67bc90>]}
[0m00:51:29.716157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1be51550>]}
[0m00:51:29.719433 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:51:29.739987 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:51:29.757132 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:51:29.758952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d6a9490>]}
[0m00:51:31.618216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m00:51:31.637371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b19c12190>]}
[0m00:51:31.706413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1bc66410>]}
[0m00:51:31.708729 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:51:31.711083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b19cc1c90>]}
[0m00:51:31.715330 [info ] [MainThread]: 
[0m00:51:31.717682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:51:31.721502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:51:31.744839 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:51:31.746223 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:51:31.747413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:31.767547 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:51:31.769166 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:51:31.770291 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:51:31.780139 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:51:31.784832 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:51:31.787569 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:51:31.797951 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:31.799185 [debug] [MainThread]: On master: BEGIN
[0m00:51:31.800368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:51:31.817023 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:51:31.818453 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:31.819749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:51:31.832658 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:51:31.839109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc82ef1-c7d1-47ba-a2e9-e2419357f7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1bed0190>]}
[0m00:51:31.840982 [debug] [MainThread]: On master: ROLLBACK
[0m00:51:31.842548 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:31.843690 [debug] [MainThread]: On master: BEGIN
[0m00:51:31.845645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:51:31.846901 [debug] [MainThread]: On master: COMMIT
[0m00:51:31.847985 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:31.849086 [debug] [MainThread]: On master: COMMIT
[0m00:51:31.850581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:51:31.851704 [debug] [MainThread]: On master: Close
[0m00:51:31.853454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:31.854743 [info ] [MainThread]: 
[0m00:51:31.867277 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:51:31.868456 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m00:51:31.870254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m00:51:31.871361 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:51:31.893098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:51:31.898362 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:51:31.872080 => 00:51:31.897611
[0m00:51:31.899466 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:51:31.924285 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:51:31.929288 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:51:31.931301 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:51:31.933262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:31.952268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:51:31.953547 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:51:31.954698 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table


-- Test for referential integrity with episode table



-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m00:51:31.956275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 30:     ) dbt_internal_test
             ^

[0m00:51:31.957584 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:51:31.959504 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:51:31.900205 => 00:51:31.959153
[0m00:51:31.960608 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:51:31.967231 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 30:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:51:31.968550 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.10s]
[0m00:51:31.970500 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:51:31.971871 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:51:31.974050 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:51:31.976289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:51:31.977466 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:51:31.995605 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:51:32.000424 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:51:31.978498 => 00:51:32.000024
[0m00:51:32.001393 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:51:32.005569 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:51:32.009701 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:51:32.011176 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:51:32.012442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:32.028711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:51:32.030184 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:51:32.031690 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:51:32.037149 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:51:32.041510 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:51:32.002245 => 00:51:32.041112
[0m00:51:32.043031 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:51:32.044297 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:51:32.046223 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m00:51:32.048090 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:51:32.049266 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:51:32.050347 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:51:32.052134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:51:32.053195 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:51:32.060076 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:51:32.064198 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:51:32.054074 => 00:51:32.063776
[0m00:51:32.065867 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:51:32.071831 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:51:32.077091 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:51:32.078243 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:51:32.079858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:32.099221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:51:32.100446 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:51:32.101474 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:51:32.106033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:51:32.108617 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:51:32.066868 => 00:51:32.108286
[0m00:51:32.109716 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:51:32.111135 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:51:32.113171 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:51:32.114823 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:51:32.116187 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:51:32.117350 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:51:32.119297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:51:32.120519 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:51:32.128926 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:51:32.133236 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:51:32.121545 => 00:51:32.132798
[0m00:51:32.134654 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:51:32.139509 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:51:32.143095 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:51:32.144224 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:51:32.145244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:32.161299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:51:32.162447 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:51:32.164029 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:51:32.168486 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:51:32.171368 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:51:32.135647 => 00:51:32.171011
[0m00:51:32.172539 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:51:32.173867 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:51:32.175960 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m00:51:32.177709 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:51:32.179254 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:51:32.180487 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m00:51:32.182606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m00:51:32.184064 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:51:32.194165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:51:32.199213 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 00:51:32.184991 => 00:51:32.198665
[0m00:51:32.200511 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:51:32.204965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:51:32.209031 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:51:32.210347 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m00:51:32.211533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:32.229910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:51:32.231354 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:51:32.232973 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:51:32.239193 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:51:32.243047 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 00:51:32.201545 => 00:51:32.242500
[0m00:51:32.244423 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m00:51:32.245872 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m00:51:32.247594 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.07s]
[0m00:51:32.249392 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:51:32.253360 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:32.254561 [debug] [MainThread]: On master: BEGIN
[0m00:51:32.256002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:51:32.272464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:51:32.273724 [debug] [MainThread]: On master: COMMIT
[0m00:51:32.274907 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:32.275747 [debug] [MainThread]: On master: COMMIT
[0m00:51:32.277328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:51:32.278294 [debug] [MainThread]: On master: Close
[0m00:51:32.280591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:32.281990 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m00:51:32.283417 [info ] [MainThread]: 
[0m00:51:32.285124 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:51:32.288475 [debug] [MainThread]: Command end result
[0m00:51:32.306578 [info ] [MainThread]: 
[0m00:51:32.308125 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:51:32.309283 [info ] [MainThread]: 
[0m00:51:32.310962 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 30:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:51:32.312575 [info ] [MainThread]: 
[0m00:51:32.313907 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m00:51:32.314993 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m00:51:32.316124 [info ] [MainThread]: 
[0m00:51:32.317270 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m00:51:32.318658 [info ] [MainThread]: 
[0m00:51:32.320132 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m00:51:32.322504 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.2160954, "process_user_time": 6.488116, "process_kernel_time": 0.278833, "process_mem_max_rss": "118012", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:51:32.324071 [debug] [MainThread]: Command `dbt test` failed at 00:51:32.323867 after 3.22 seconds
[0m00:51:32.325122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d6a8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1d6abb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b217203d0>]}
[0m00:51:32.326420 [debug] [MainThread]: Flushing usage events
[0m00:59:49.245908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6907f7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe690e64050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6907f6cd0>]}


============================== 00:59:49.254840 | 3f166f6c-00c2-482f-a4ce-3de8a818ea36 ==============================
[0m00:59:49.254840 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:59:49.256438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:59:49.492880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68f101790>]}
[0m00:59:49.584098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68f14ab10>]}
[0m00:59:49.586191 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m00:59:49.601876 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:59:49.619020 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:59:49.620638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68f102ad0>]}
[0m00:59:51.548880 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m00:59:51.558280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68e7d3a50>]}
[0m00:59:51.584937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68e6dbe90>]}
[0m00:59:51.586153 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:59:51.587417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68efe3490>]}
[0m00:59:51.591115 [info ] [MainThread]: 
[0m00:59:51.593548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:59:51.596346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m00:59:51.613306 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:59:51.614540 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m00:59:51.615375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:51.634686 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:59:51.635821 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m00:59:51.636872 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:59:51.645552 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:59:51.648136 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m00:59:51.649497 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m00:59:51.657828 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:51.658948 [debug] [MainThread]: On master: BEGIN
[0m00:59:51.660270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:51.677898 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:59:51.679108 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:51.680388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:59:51.694138 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:59:51.697373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f166f6c-00c2-482f-a4ce-3de8a818ea36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68ef76990>]}
[0m00:59:51.698736 [debug] [MainThread]: On master: ROLLBACK
[0m00:59:51.699986 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:51.700985 [debug] [MainThread]: On master: BEGIN
[0m00:59:51.702680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:59:51.703737 [debug] [MainThread]: On master: COMMIT
[0m00:59:51.705142 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:51.708701 [debug] [MainThread]: On master: COMMIT
[0m00:59:51.710507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:59:51.711768 [debug] [MainThread]: On master: Close
[0m00:59:51.713760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:59:51.715167 [info ] [MainThread]: 
[0m00:59:51.747897 [debug] [Thread-1 (]: Began running node test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0
[0m00:59:51.758679 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_expression_is_true_merged_episode_uid_episode_uid .. [RUN]
[0m00:59:51.771310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0)
[0m00:59:51.794422 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0
[0m00:59:51.867706 [debug] [Thread-1 (]: Timing info for test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0 (compile): 00:59:51.799143 => 00:59:51.866508
[0m00:59:51.877724 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_expression_is_true_merged_episode_uid_episode_uid (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:59:51.881843 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_expression_is_true_merged_episode_uid_episode_uid ....... [[31mERROR[0m in 0.11s]
[0m00:59:51.884556 [debug] [Thread-1 (]: Finished running node test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0
[0m00:59:51.887714 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m00:59:51.891719 [info ] [Thread-1 (]: 2 of 6 START test merged_episode_test .......................................... [RUN]
[0m00:59:51.894730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.dbt_utils_expression_is_true_merged_episode_uid_episode_uid.0da4a863e0, now test.dbt_poc.merged_episode_test)
[0m00:59:51.897078 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m00:59:51.910535 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m00:59:51.915783 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 00:59:51.899861 => 00:59:51.915309
[0m00:59:51.917543 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m00:59:51.956528 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m00:59:51.961093 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:59:51.962443 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m00:59:51.963521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:51.983503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:59:51.985123 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m00:59:51.986679 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- -- Test for non-null values in manifestation_eidrid column
-- 

-- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table




-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m00:59:51.988799 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m00:59:51.990225 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m00:59:51.992470 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 00:59:51.918795 => 00:59:51.991906
[0m00:59:51.993774 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m00:59:52.000601 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:59:52.002468 [error] [Thread-1 (]: 2 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.11s]
[0m00:59:52.004245 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m00:59:52.006159 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:59:52.007605 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m00:59:52.009594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m00:59:52.010891 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:59:52.023541 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:59:52.028921 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 00:59:52.011687 => 00:59:52.028355
[0m00:59:52.030521 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:59:52.035655 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:59:52.040153 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:59:52.041510 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m00:59:52.042507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:52.059087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:59:52.060238 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m00:59:52.061511 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m00:59:52.066510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:59:52.070188 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 00:59:52.031590 => 00:59:52.069797
[0m00:59:52.071592 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m00:59:52.073029 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m00:59:52.075042 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m00:59:52.076981 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m00:59:52.078460 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:59:52.079752 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m00:59:52.081674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m00:59:52.082846 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:59:52.092229 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:59:52.096956 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 00:59:52.083760 => 00:59:52.096359
[0m00:59:52.098239 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:59:52.103066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:59:52.106693 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:59:52.108065 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m00:59:52.109383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:52.125900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:59:52.127226 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m00:59:52.128589 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m00:59:52.133463 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:59:52.136694 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 00:59:52.099319 => 00:59:52.136182
[0m00:59:52.137935 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m00:59:52.139497 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m00:59:52.141788 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m00:59:52.144058 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m00:59:52.145862 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:59:52.147173 [info ] [Thread-1 (]: 5 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m00:59:52.149062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m00:59:52.150276 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:59:52.157296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:59:52.160677 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 00:59:52.151371 => 00:59:52.160155
[0m00:59:52.161757 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:59:52.166076 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:59:52.168965 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:59:52.170139 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m00:59:52.171470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:52.189690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:59:52.191106 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m00:59:52.192553 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m00:59:52.197499 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:59:52.200871 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 00:59:52.162632 => 00:59:52.200296
[0m00:59:52.202117 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m00:59:52.203645 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m00:59:52.205377 [info ] [Thread-1 (]: 5 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m00:59:52.207047 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m00:59:52.208166 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:59:52.209248 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m00:59:52.210845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m00:59:52.211952 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:59:52.222228 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:59:52.225849 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 00:59:52.212776 => 00:59:52.225431
[0m00:59:52.227009 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:59:52.232087 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:59:52.235570 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:59:52.237611 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m00:59:52.238905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:52.257652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:59:52.258828 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m00:59:52.259963 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:59:52.264420 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:59:52.267538 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 00:59:52.228074 => 00:59:52.267099
[0m00:59:52.268724 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m00:59:52.270623 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m00:59:52.272987 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m00:59:52.275127 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m00:59:52.279424 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:52.280770 [debug] [MainThread]: On master: BEGIN
[0m00:59:52.282096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:59:52.301681 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:59:52.303019 [debug] [MainThread]: On master: COMMIT
[0m00:59:52.304074 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:52.305174 [debug] [MainThread]: On master: COMMIT
[0m00:59:52.306439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:59:52.307371 [debug] [MainThread]: On master: Close
[0m00:59:52.308979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:52.309945 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m00:59:52.311139 [info ] [MainThread]: 
[0m00:59:52.312440 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m00:59:52.315651 [debug] [MainThread]: Command end result
[0m00:59:52.335637 [info ] [MainThread]: 
[0m00:59:52.337426 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:59:52.340907 [info ] [MainThread]: 
[0m00:59:52.343939 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_merged_episode_uid_episode_uid (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:59:52.345711 [info ] [MainThread]: 
[0m00:59:52.347178 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m00:59:52.348783 [info ] [MainThread]: 
[0m00:59:52.350184 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m00:59:52.351386 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m00:59:52.352750 [info ] [MainThread]: 
[0m00:59:52.354493 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m00:59:52.356017 [info ] [MainThread]: 
[0m00:59:52.358011 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m00:59:52.361691 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.1874843, "process_user_time": 5.601341, "process_kernel_time": 0.266087, "process_mem_max_rss": "117480", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m00:59:52.363508 [debug] [MainThread]: Command `dbt test` failed at 00:59:52.363045 after 3.19 seconds
[0m00:59:52.364915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6907f5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6907f4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6947c7450>]}
[0m00:59:52.366173 [debug] [MainThread]: Flushing usage events
[0m01:05:41.977965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbd4cd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbdad5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbd4ccb10>]}


============================== 01:05:41.988753 | 6ce93d92-df1f-4233-bd45-7d2971da1c79 ==============================
[0m01:05:41.988753 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:05:41.990584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:05:42.215294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbd4cdd90>]}
[0m01:05:42.301004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbbe43e50>]}
[0m01:05:42.302820 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:05:42.316885 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:05:42.334108 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:05:42.335978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbbcd1090>]}
[0m01:05:44.159028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:05:44.173223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbbbcd890>]}
[0m01:05:44.200605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbbc50ed0>]}
[0m01:05:44.202232 [info ] [MainThread]: Found 1 model, 5 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:05:44.203814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbbd47050>]}
[0m01:05:44.207813 [info ] [MainThread]: 
[0m01:05:44.210364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:05:44.213246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:05:44.229688 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:05:44.230892 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:05:44.231991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:44.250570 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.251967 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:05:44.252965 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:05:44.261996 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:05:44.264618 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:05:44.265879 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:05:44.273922 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.274974 [debug] [MainThread]: On master: BEGIN
[0m01:05:44.276184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:05:44.291505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.292533 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.293516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:05:44.303848 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:05:44.307338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce93d92-df1f-4233-bd45-7d2971da1c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4db9b52c90>]}
[0m01:05:44.308465 [debug] [MainThread]: On master: ROLLBACK
[0m01:05:44.309743 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.310758 [debug] [MainThread]: On master: BEGIN
[0m01:05:44.312393 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.313360 [debug] [MainThread]: On master: COMMIT
[0m01:05:44.314259 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.315107 [debug] [MainThread]: On master: COMMIT
[0m01:05:44.316258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:05:44.317192 [debug] [MainThread]: On master: Close
[0m01:05:44.318689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:44.319915 [info ] [MainThread]: 
[0m01:05:44.332011 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:05:44.333344 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m01:05:44.335240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:05:44.336274 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:05:44.354745 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:05:44.361218 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:05:44.337215 => 01:05:44.360236
[0m01:05:44.362591 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:05:44.387899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:05:44.391693 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:05:44.392749 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:05:44.393772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:44.410007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.411282 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:05:44.412265 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- -- Test for non-null values in manifestation_eidrid column
-- 

-- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table




-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m01:05:44.413846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:05:44.415228 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:05:44.416756 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:05:44.363850 => 01:05:44.416414
[0m01:05:44.418128 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:05:44.424184 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:05:44.425577 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:05:44.427248 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:05:44.428533 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:05:44.430790 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:05:44.432854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:05:44.434201 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:05:44.449863 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:05:44.453859 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:05:44.434998 => 01:05:44.453476
[0m01:05:44.455071 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:05:44.459620 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:05:44.463689 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:05:44.465738 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:05:44.466977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:44.483573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.484941 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:05:44.486264 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:05:44.491253 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:05:44.495033 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:05:44.455923 => 01:05:44.494645
[0m01:05:44.496242 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:05:44.497649 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:05:44.499501 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m01:05:44.501330 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:05:44.502607 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:05:44.503808 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:05:44.505873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:05:44.507352 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:05:44.514795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:05:44.517809 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:05:44.508267 => 01:05:44.517445
[0m01:05:44.518871 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:05:44.524730 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:05:44.527607 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:05:44.529005 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:05:44.530286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:44.546282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.547349 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:05:44.548233 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:05:44.552878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:05:44.556204 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:05:44.519784 => 01:05:44.555682
[0m01:05:44.557581 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:05:44.559502 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:05:44.561697 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:05:44.563528 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:05:44.565448 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:05:44.566787 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:05:44.568655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:05:44.569699 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:05:44.576612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:05:44.579828 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:05:44.570601 => 01:05:44.579472
[0m01:05:44.580945 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:05:44.584995 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:05:44.587926 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:05:44.589365 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:05:44.590376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:44.608432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.609972 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:05:44.611427 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:05:44.616377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:05:44.619241 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:05:44.581782 => 01:05:44.618847
[0m01:05:44.620449 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:05:44.621884 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:05:44.623910 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m01:05:44.625750 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:05:44.627272 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:05:44.628594 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m01:05:44.630572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:05:44.631731 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:05:44.641413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:05:44.644786 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:05:44.632492 => 01:05:44.644407
[0m01:05:44.645930 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:05:44.650187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:05:44.653910 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:05:44.655831 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:05:44.657651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:44.677766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.679014 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:05:44.680507 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:05:44.685486 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:05:44.689535 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:05:44.646843 => 01:05:44.689067
[0m01:05:44.690647 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:05:44.692367 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:05:44.694420 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:05:44.696520 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:05:44.700685 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.702390 [debug] [MainThread]: On master: BEGIN
[0m01:05:44.703852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:05:44.723363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:05:44.724595 [debug] [MainThread]: On master: COMMIT
[0m01:05:44.725683 [debug] [MainThread]: Using postgres connection "master"
[0m01:05:44.726690 [debug] [MainThread]: On master: COMMIT
[0m01:05:44.728192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:05:44.729151 [debug] [MainThread]: On master: Close
[0m01:05:44.730719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:44.731657 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:05:44.734486 [info ] [MainThread]: 
[0m01:05:44.735765 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m01:05:44.738622 [debug] [MainThread]: Command end result
[0m01:05:44.758608 [info ] [MainThread]: 
[0m01:05:44.760457 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:05:44.761985 [info ] [MainThread]: 
[0m01:05:44.764437 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:05:44.766420 [info ] [MainThread]: 
[0m01:05:44.767896 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:05:44.769783 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:05:44.771333 [info ] [MainThread]: 
[0m01:05:44.772640 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:05:44.773931 [info ] [MainThread]: 
[0m01:05:44.775615 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m01:05:44.777903 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.877661, "process_user_time": 5.503475, "process_kernel_time": 0.261075, "process_mem_max_rss": "116684", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:05:44.779434 [debug] [MainThread]: Command `dbt test` failed at 01:05:44.779238 after 2.88 seconds
[0m01:05:44.780670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbdad5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dc15904d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dbd5cdb10>]}
[0m01:05:44.782225 [debug] [MainThread]: Flushing usage events
[0m01:07:19.465925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8be18b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8c4887d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8be6e310>]}


============================== 01:07:19.474682 | 007dd42a-359c-447a-b14e-fa5ce7678310 ==============================
[0m01:07:19.474682 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:07:19.476366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:07:19.701291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8e4ea3d0>]}
[0m01:07:19.789764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8be60b10>]}
[0m01:07:19.791403 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:07:19.805709 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:07:19.855857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:07:19.857984 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:07:20.017968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:07:20.026123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8a764dd0>]}
[0m01:07:20.050642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8a43f410>]}
[0m01:07:20.052183 [info ] [MainThread]: Found 1 model, 2 seeds, 5 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:07:20.053452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8a6c46d0>]}
[0m01:07:20.056785 [info ] [MainThread]: 
[0m01:07:20.059079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:20.061917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:07:20.078071 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:07:20.079355 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:07:20.080305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:20.098184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.099353 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:07:20.100482 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:07:20.110832 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:07:20.113545 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:07:20.115389 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:07:20.125870 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.126954 [debug] [MainThread]: On master: BEGIN
[0m01:07:20.127995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:20.144149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.145387 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.146447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:07:20.156120 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:07:20.159371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007dd42a-359c-447a-b14e-fa5ce7678310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8a625290>]}
[0m01:07:20.160539 [debug] [MainThread]: On master: ROLLBACK
[0m01:07:20.162022 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.163120 [debug] [MainThread]: On master: BEGIN
[0m01:07:20.164921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.165981 [debug] [MainThread]: On master: COMMIT
[0m01:07:20.166933 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.167844 [debug] [MainThread]: On master: COMMIT
[0m01:07:20.169295 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:07:20.170278 [debug] [MainThread]: On master: Close
[0m01:07:20.171898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:20.173125 [info ] [MainThread]: 
[0m01:07:20.185638 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:07:20.187049 [info ] [Thread-1 (]: 1 of 5 START test merged_episode_test .......................................... [RUN]
[0m01:07:20.189057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:07:20.190222 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:07:20.210166 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:07:20.214371 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:07:20.191128 => 01:07:20.213953
[0m01:07:20.215542 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:07:20.242405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:07:20.245522 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:07:20.246840 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:07:20.247874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.264421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.265828 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:07:20.266933 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- -- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table




-- -- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:07:20.268814 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:07:20.269883 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:07:20.271314 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:07:20.216530 => 01:07:20.270970
[0m01:07:20.272348 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:07:20.278234 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:07:20.279487 [error] [Thread-1 (]: 1 of 5 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:07:20.281427 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:07:20.282873 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:07:20.285195 [info ] [Thread-1 (]: 2 of 5 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:07:20.286784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:07:20.288098 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:07:20.304445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:07:20.308007 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:07:20.289113 => 01:07:20.307508
[0m01:07:20.309066 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:07:20.313240 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:07:20.315983 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:07:20.317068 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:07:20.318255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.335039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.336250 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:07:20.337490 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:07:20.342234 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:20.345794 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:07:20.309877 => 01:07:20.345458
[0m01:07:20.347014 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:07:20.348493 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:07:20.350550 [info ] [Thread-1 (]: 2 of 5 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:07:20.353662 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:07:20.355681 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:07:20.357266 [info ] [Thread-1 (]: 3 of 5 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:07:20.359580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:07:20.362029 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:07:20.372082 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:07:20.375337 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:07:20.364418 => 01:07:20.374947
[0m01:07:20.376476 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:07:20.382059 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:07:20.386164 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:07:20.387967 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:07:20.389312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.407239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.408586 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:07:20.409954 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:07:20.414558 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:20.417675 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:07:20.378154 => 01:07:20.417312
[0m01:07:20.418866 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:07:20.420236 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:07:20.422071 [info ] [Thread-1 (]: 3 of 5 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:07:20.423610 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:07:20.425066 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:07:20.426192 [info ] [Thread-1 (]: 4 of 5 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:07:20.428029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:07:20.429138 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:07:20.437909 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:07:20.441109 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:07:20.429937 => 01:07:20.440748
[0m01:07:20.442139 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:07:20.446683 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:07:20.449478 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:07:20.450593 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:07:20.451906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.468459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.469775 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:07:20.470790 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:07:20.474920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:20.477569 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:07:20.443153 => 01:07:20.477203
[0m01:07:20.478813 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:07:20.480084 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:07:20.482185 [info ] [Thread-1 (]: 4 of 5 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m01:07:20.484520 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:07:20.486242 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:07:20.487962 [info ] [Thread-1 (]: 5 of 5 START test unique_merged_episode_uid .................................... [RUN]
[0m01:07:20.489736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:07:20.491031 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:07:20.501599 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:07:20.505055 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:07:20.492046 => 01:07:20.504537
[0m01:07:20.506353 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:07:20.511059 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:07:20.514552 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:07:20.516293 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:07:20.517687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:20.535485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.536900 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:07:20.538098 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:07:20.542565 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:20.545350 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:07:20.507394 => 01:07:20.545001
[0m01:07:20.546710 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:07:20.548271 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:07:20.550361 [error] [Thread-1 (]: 5 of 5 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:07:20.552028 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:07:20.555772 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.557246 [debug] [MainThread]: On master: BEGIN
[0m01:07:20.558385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:20.575932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:20.576935 [debug] [MainThread]: On master: COMMIT
[0m01:07:20.577778 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:20.578616 [debug] [MainThread]: On master: COMMIT
[0m01:07:20.580206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:07:20.581197 [debug] [MainThread]: On master: Close
[0m01:07:20.582775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:20.583834 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:07:20.584809 [info ] [MainThread]: 
[0m01:07:20.586002 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:07:20.588469 [debug] [MainThread]: Command end result
[0m01:07:20.606684 [info ] [MainThread]: 
[0m01:07:20.608081 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:07:20.609342 [info ] [MainThread]: 
[0m01:07:20.611296 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:07:20.613251 [info ] [MainThread]: 
[0m01:07:20.615080 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:07:20.616402 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:07:20.617902 [info ] [MainThread]: 
[0m01:07:20.619059 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:07:20.620294 [info ] [MainThread]: 
[0m01:07:20.621537 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m01:07:20.623516 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2303443, "process_user_time": 3.697903, "process_kernel_time": 0.212132, "process_mem_max_rss": "109448", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:07:20.625042 [debug] [MainThread]: Command `dbt test` failed at 01:07:20.624691 after 1.23 seconds
[0m01:07:20.626169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8ff78f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8fe1c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8fe1e9d0>]}
[0m01:07:20.627371 [debug] [MainThread]: Flushing usage events
[0m01:14:58.595425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736c67250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736cba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273734d6d0>]}


============================== 01:14:58.604328 | b8209183-5787-4e4b-b796-9284903aa19f ==============================
[0m01:14:58.604328 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:14:58.605980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:14:58.841161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736cba810>]}
[0m01:14:58.929316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27353c3110>]}
[0m01:14:58.931120 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:14:58.945325 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:14:58.961529 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:14:58.963114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2737134310>]}
[0m01:15:00.680357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:15:00.689065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2734116f10>]}
[0m01:15:00.716985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2716f1fd90>]}
[0m01:15:00.718491 [info ] [MainThread]: Found 1 model, 2 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:15:00.719788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27171a0790>]}
[0m01:15:00.722800 [info ] [MainThread]: 
[0m01:15:00.725049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:15:00.727400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:15:00.743194 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:15:00.744349 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:15:00.745624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:00.765046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:15:00.766145 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:15:00.767064 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:15:00.775927 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:15:00.778458 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:15:00.779694 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:15:00.787533 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:00.788651 [debug] [MainThread]: On master: BEGIN
[0m01:15:00.789522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:00.805218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:00.806239 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:00.807312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:15:00.817474 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:15:00.821229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8209183-5787-4e4b-b796-9284903aa19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273527af10>]}
[0m01:15:00.822564 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:00.824093 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:00.825153 [debug] [MainThread]: On master: BEGIN
[0m01:15:00.826679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:00.827555 [debug] [MainThread]: On master: COMMIT
[0m01:15:00.828499 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:00.829492 [debug] [MainThread]: On master: COMMIT
[0m01:15:00.830703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:15:00.831676 [debug] [MainThread]: On master: Close
[0m01:15:00.833203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:15:00.834365 [info ] [MainThread]: 
[0m01:15:00.847259 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:15:00.848503 [info ] [Thread-1 (]: 1 of 2 START test merged_episode_test .......................................... [RUN]
[0m01:15:00.850278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:15:00.851329 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:15:00.867545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:15:00.872966 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:15:00.852201 => 01:15:00.872379
[0m01:15:00.874308 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:15:00.901661 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:15:00.905579 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:15:00.906812 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:15:00.907791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:00.925423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:00.926860 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:15:00.927933 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- -- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table




-- -- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:15:00.929425 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:15:00.930510 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:15:00.932139 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:15:00.875516 => 01:15:00.931808
[0m01:15:00.933212 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:15:00.939111 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:15:00.940536 [error] [Thread-1 (]: 1 of 2 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:15:00.942602 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:15:00.944166 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:15:00.946363 [info ] [Thread-1 (]: 2 of 2 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:15:00.948890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:15:00.950426 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:15:00.959278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:15:00.962616 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:15:00.951705 => 01:15:00.962259
[0m01:15:00.963808 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:15:00.968135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:15:00.971479 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:15:00.972824 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:15:00.973836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:00.989316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:00.990436 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:15:00.991576 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:15:00.996706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:01.000165 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:15:00.964704 => 01:15:00.999825
[0m01:15:01.001208 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:15:01.002427 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:15:01.004243 [info ] [Thread-1 (]: 2 of 2 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.06s]
[0m01:15:01.006034 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:15:01.009492 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:01.010564 [debug] [MainThread]: On master: BEGIN
[0m01:15:01.011515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:01.027726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:01.028859 [debug] [MainThread]: On master: COMMIT
[0m01:15:01.030034 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:01.031012 [debug] [MainThread]: On master: COMMIT
[0m01:15:01.032292 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:15:01.033837 [debug] [MainThread]: On master: Close
[0m01:15:01.035448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:01.036425 [debug] [MainThread]: Connection 'test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1' was properly closed.
[0m01:15:01.037415 [info ] [MainThread]: 
[0m01:15:01.038694 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m01:15:01.040486 [debug] [MainThread]: Command end result
[0m01:15:01.059398 [info ] [MainThread]: 
[0m01:15:01.060657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:15:01.061958 [info ] [MainThread]: 
[0m01:15:01.063331 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:15:01.064920 [info ] [MainThread]: 
[0m01:15:01.066266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:15:01.069283 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.5427198, "process_user_time": 5.133339, "process_kernel_time": 0.237173, "process_mem_max_rss": "116916", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:15:01.070492 [debug] [MainThread]: Command `dbt test` failed at 01:15:01.070306 after 2.54 seconds
[0m01:15:01.071835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736cbd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736c70a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273734d690>]}
[0m01:15:01.073005 [debug] [MainThread]: Flushing usage events
[0m01:20:49.869678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994d47cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3995bd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994d9b3d0>]}


============================== 01:20:49.878651 | 765c2c73-fa0a-4f0f-be14-2f5225ac52d5 ==============================
[0m01:20:49.878651 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:20:49.880799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:20:50.117913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994dc9bd0>]}
[0m01:20:50.207552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39936a9010>]}
[0m01:20:50.209317 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:20:50.223282 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:20:50.239161 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:20:50.240724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399362b090>]}
[0m01:20:51.953069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:20:51.962753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3993577290>]}
[0m01:20:51.988212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3991693710>]}
[0m01:20:51.989718 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:20:51.990926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3991853090>]}
[0m01:20:51.994377 [info ] [MainThread]: 
[0m01:20:51.996563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:20:51.999262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:20:52.015187 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:20:52.016306 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:20:52.017378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:52.036678 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.037925 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:20:52.039000 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:20:52.048078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:20:52.050553 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:20:52.051827 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:20:52.059915 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.060929 [debug] [MainThread]: On master: BEGIN
[0m01:20:52.061939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:52.079014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.080340 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.081782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:20:52.093170 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:20:52.097253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765c2c73-fa0a-4f0f-be14-2f5225ac52d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3991693550>]}
[0m01:20:52.098805 [debug] [MainThread]: On master: ROLLBACK
[0m01:20:52.100428 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.101949 [debug] [MainThread]: On master: BEGIN
[0m01:20:52.104791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.106386 [debug] [MainThread]: On master: COMMIT
[0m01:20:52.107743 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.108759 [debug] [MainThread]: On master: COMMIT
[0m01:20:52.110206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:20:52.111368 [debug] [MainThread]: On master: Close
[0m01:20:52.113533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:52.115265 [info ] [MainThread]: 
[0m01:20:52.129880 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:20:52.131676 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:20:52.133652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:20:52.134841 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:20:52.159086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:20:52.164144 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:20:52.135855 => 01:20:52.163202
[0m01:20:52.170477 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:20:52.231935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:20:52.236139 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:20:52.237211 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:20:52.238543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.255162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.256675 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:20:52.257975 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- -- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table




-- -- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:20:52.259654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:20:52.260649 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:20:52.262172 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:20:52.181040 => 01:20:52.261839
[0m01:20:52.263184 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:20:52.269171 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:20:52.270435 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.14s]
[0m01:20:52.272150 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:20:52.273601 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:20:52.275673 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:20:52.277495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:20:52.278828 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:20:52.290963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:20:52.295178 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:20:52.279716 => 01:20:52.294808
[0m01:20:52.296745 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:20:52.300840 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:20:52.304233 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:20:52.305436 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:20:52.306747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.322910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.324293 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:20:52.325381 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:20:52.330151 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:20:52.333478 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:20:52.297586 => 01:20:52.333130
[0m01:20:52.334656 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:20:52.335898 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:20:52.338008 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:20:52.339953 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:20:52.341176 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:20:52.342341 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:20:52.344381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:20:52.345662 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:20:52.354054 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:20:52.357818 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:20:52.346455 => 01:20:52.357336
[0m01:20:52.358850 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:20:52.362940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:20:52.366248 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:20:52.367684 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:20:52.369117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.387809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.388929 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:20:52.389875 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:20:52.394109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:20:52.397129 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:20:52.359605 => 01:20:52.396771
[0m01:20:52.398286 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:20:52.399692 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:20:52.401421 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:20:52.402934 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:20:52.404441 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:20:52.405630 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:20:52.407192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:20:52.408321 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:20:52.415134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:20:52.418326 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:20:52.409152 => 01:20:52.417975
[0m01:20:52.419389 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:20:52.423346 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:20:52.426287 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:20:52.427435 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:20:52.428652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.445085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.446316 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:20:52.447395 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:20:52.451704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:20:52.454406 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:20:52.420250 => 01:20:52.454058
[0m01:20:52.455648 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:20:52.456989 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:20:52.458861 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m01:20:52.460539 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:20:52.462109 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4
[0m01:20:52.463384 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_episode_uid__uid__ref_manifestation_  [RUN]
[0m01:20:52.465577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4)
[0m01:20:52.466772 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4
[0m01:20:52.474414 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4"
[0m01:20:52.477649 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4 (compile): 01:20:52.467545 => 01:20:52.477204
[0m01:20:52.478879 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4
[0m01:20:52.483287 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4"
[0m01:20:52.486091 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4"
[0m01:20:52.487183 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4: BEGIN
[0m01:20:52.488606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.507263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.510779 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4"
[0m01:20:52.514071 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select episode_uid as from_field
    from "dev_db"."public"."merged_episode"
    where episode_uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."manifestation"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:20:52.517780 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "episode_uid" does not exist
LINE 12:     select episode_uid as from_field
                    ^

[0m01:20:52.520049 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4: ROLLBACK
[0m01:20:52.522713 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4 (execute): 01:20:52.479828 => 01:20:52.522089
[0m01:20:52.525023 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4: Close
[0m01:20:52.532815 [debug] [Thread-1 (]: Database Error in test relationships_merged_episode_episode_uid__uid__ref_manifestation_ (models/schema.yml)
  column "episode_uid" does not exist
  LINE 12:     select episode_uid as from_field
                      ^
  compiled Code at target/run/dbt_poc/models/schema.yml/relationships_merged_episode_c6f404d43a871b970ddc46c1787a5979.sql
[0m01:20:52.535365 [error] [Thread-1 (]: 5 of 6 ERROR relationships_merged_episode_episode_uid__uid__ref_manifestation_ . [[31mERROR[0m in 0.07s]
[0m01:20:52.538367 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4
[0m01:20:52.540849 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:20:52.542817 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:20:52.545818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_episode_uid__uid__ref_manifestation_.8099c225f4, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:20:52.547907 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:20:52.561595 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:20:52.568718 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:20:52.549399 => 01:20:52.567532
[0m01:20:52.570886 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:20:52.576802 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:20:52.581141 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:20:52.582770 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:20:52.584101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:52.604989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.606225 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:20:52.607335 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:20:52.612452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:20:52.615394 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:20:52.572546 => 01:20:52.615035
[0m01:20:52.616849 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:20:52.618237 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:20:52.620173 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.08s]
[0m01:20:52.621985 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:20:52.626237 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.627301 [debug] [MainThread]: On master: BEGIN
[0m01:20:52.628349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:52.648624 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:20:52.649776 [debug] [MainThread]: On master: COMMIT
[0m01:20:52.651065 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:52.652030 [debug] [MainThread]: On master: COMMIT
[0m01:20:52.653392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:20:52.654629 [debug] [MainThread]: On master: Close
[0m01:20:52.656193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:52.657199 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:20:52.658269 [info ] [MainThread]: 
[0m01:20:52.659948 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m01:20:52.663128 [debug] [MainThread]: Command end result
[0m01:20:52.688143 [info ] [MainThread]: 
[0m01:20:52.689439 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m01:20:52.690793 [info ] [MainThread]: 
[0m01:20:52.691908 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:20:52.693158 [info ] [MainThread]: 
[0m01:20:52.694575 [error] [MainThread]:   Database Error in test relationships_merged_episode_episode_uid__uid__ref_manifestation_ (models/schema.yml)
  column "episode_uid" does not exist
  LINE 12:     select episode_uid as from_field
                      ^
  compiled Code at target/run/dbt_poc/models/schema.yml/relationships_merged_episode_c6f404d43a871b970ddc46c1787a5979.sql
[0m01:20:52.695760 [info ] [MainThread]: 
[0m01:20:52.697117 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:20:52.698823 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:20:52.700011 [info ] [MainThread]: 
[0m01:20:52.701293 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:20:52.702565 [info ] [MainThread]: 
[0m01:20:52.703777 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m01:20:52.705872 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.9066763, "process_user_time": 5.287747, "process_kernel_time": 0.245491, "process_mem_max_rss": "117092", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:20:52.707137 [debug] [MainThread]: Command `dbt test` failed at 01:20:52.706944 after 2.91 seconds
[0m01:20:52.708227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994d4cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994d9c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3998e08450>]}
[0m01:20:52.709316 [debug] [MainThread]: Flushing usage events
[0m01:22:53.724899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3414aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b346cda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b346cf450>]}


============================== 01:22:53.733533 | 79ebcb83-2d0f-46b4-bdac-4a43dcc45115 ==============================
[0m01:22:53.733533 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:22:53.734958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:22:53.953780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b341a0650>]}
[0m01:22:54.040662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3414bb90>]}
[0m01:22:54.042497 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:22:54.056506 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:22:54.071973 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:22:54.073734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b32a2f0d0>]}
[0m01:22:56.130069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:22:56.139161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b328684d0>]}
[0m01:22:56.162412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b30627350>]}
[0m01:22:56.163860 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:22:56.165334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3298a950>]}
[0m01:22:56.168735 [info ] [MainThread]: 
[0m01:22:56.170600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:22:56.173180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:22:56.188996 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:22:56.190384 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:22:56.191417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:56.210253 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.211380 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:22:56.212344 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:22:56.221688 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:22:56.224370 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:22:56.225831 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:22:56.234568 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.235721 [debug] [MainThread]: On master: BEGIN
[0m01:22:56.236652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:56.251962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.253153 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.254223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:22:56.263753 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:22:56.266923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ebcb83-2d0f-46b4-bdac-4a43dcc45115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b32aec090>]}
[0m01:22:56.268049 [debug] [MainThread]: On master: ROLLBACK
[0m01:22:56.269363 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.270201 [debug] [MainThread]: On master: BEGIN
[0m01:22:56.271562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.272580 [debug] [MainThread]: On master: COMMIT
[0m01:22:56.273555 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.274609 [debug] [MainThread]: On master: COMMIT
[0m01:22:56.276013 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:22:56.277046 [debug] [MainThread]: On master: Close
[0m01:22:56.278770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:56.280022 [info ] [MainThread]: 
[0m01:22:56.294385 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:22:56.295848 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:22:56.298053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:22:56.299569 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:22:56.318420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:22:56.323770 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:22:56.300713 => 01:22:56.322884
[0m01:22:56.325488 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:22:56.352279 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:22:56.356989 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:22:56.358333 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:22:56.359291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.378446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.380257 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:22:56.381773 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


Test for referential integrity with manifestation table



-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m01:22:56.383855 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "for"
LINE 19: Test for referential integrity with manifestation table
              ^

[0m01:22:56.385153 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:22:56.386936 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:22:56.326565 => 01:22:56.386595
[0m01:22:56.387970 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:22:56.394381 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "for"
  LINE 19: Test for referential integrity with manifestation table
                ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:22:56.395736 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.10s]
[0m01:22:56.397354 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:22:56.398603 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:22:56.400788 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:22:56.402980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:22:56.404240 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:22:56.414831 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:22:56.418696 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:22:56.405095 => 01:22:56.418317
[0m01:22:56.419745 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:22:56.423962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:22:56.427085 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:22:56.428426 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:22:56.429559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.445933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.447394 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:22:56.448564 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:22:56.453286 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:22:56.456680 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:22:56.420555 => 01:22:56.456333
[0m01:22:56.457827 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:22:56.459203 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:22:56.461185 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:22:56.462837 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:22:56.464254 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:22:56.465534 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:22:56.467361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:22:56.468483 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:22:56.476818 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:22:56.480510 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:22:56.469305 => 01:22:56.480000
[0m01:22:56.481765 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:22:56.486404 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:22:56.491815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:22:56.493533 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:22:56.494981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.512481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.513808 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:22:56.515179 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:22:56.519671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:22:56.522578 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:22:56.482740 => 01:22:56.522229
[0m01:22:56.523820 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:22:56.525279 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:22:56.527077 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:22:56.528766 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:22:56.529973 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:22:56.531161 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:22:56.532694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:22:56.533744 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:22:56.540633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:22:56.543468 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:22:56.534620 => 01:22:56.542998
[0m01:22:56.544495 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:22:56.548456 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:22:56.551031 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:22:56.552159 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:22:56.553316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.569237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.570388 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:22:56.571354 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:22:56.575338 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:22:56.577947 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:22:56.545344 => 01:22:56.577620
[0m01:22:56.579065 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:22:56.580468 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:22:56.582375 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m01:22:56.583992 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:22:56.585408 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:22:56.586540 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:22:56.588399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:22:56.589369 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:22:56.597013 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:22:56.600019 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:22:56.590140 => 01:22:56.599683
[0m01:22:56.601215 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:22:56.605088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:22:56.608659 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:22:56.609753 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:22:56.610932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.626534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.628087 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:22:56.629467 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:22:56.634404 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:22:56.637437 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:22:56.601982 => 01:22:56.636968
[0m01:22:56.638555 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:22:56.639900 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:22:56.641801 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.05s]
[0m01:22:56.643525 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:22:56.644831 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:22:56.645994 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:22:56.647652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:22:56.648687 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:22:56.658228 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:22:56.661325 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:22:56.649532 => 01:22:56.660887
[0m01:22:56.662296 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:22:56.666232 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:22:56.669131 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:22:56.670352 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:22:56.671693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:56.689916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.694539 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:22:56.713972 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:22:56.737300 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:22:56.755325 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:22:56.663016 => 01:22:56.754823
[0m01:22:56.756904 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:22:56.758463 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:22:56.760385 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.11s]
[0m01:22:56.761979 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:22:56.765977 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.767215 [debug] [MainThread]: On master: BEGIN
[0m01:22:56.768382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:22:56.785035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:22:56.786230 [debug] [MainThread]: On master: COMMIT
[0m01:22:56.787193 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:56.788128 [debug] [MainThread]: On master: COMMIT
[0m01:22:56.789419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:22:56.790415 [debug] [MainThread]: On master: Close
[0m01:22:56.791949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:56.792882 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:22:56.793883 [info ] [MainThread]: 
[0m01:22:56.795063 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m01:22:56.798011 [debug] [MainThread]: Command end result
[0m01:22:56.817308 [info ] [MainThread]: 
[0m01:22:56.818774 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:22:56.820227 [info ] [MainThread]: 
[0m01:22:56.822348 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near "for"
  LINE 19: Test for referential integrity with manifestation table
                ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:22:56.824393 [info ] [MainThread]: 
[0m01:22:56.826562 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:22:56.828259 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:22:56.829698 [info ] [MainThread]: 
[0m01:22:56.831350 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:22:56.832876 [info ] [MainThread]: 
[0m01:22:56.834537 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:22:56.837098 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.1808276, "process_user_time": 5.69293, "process_kernel_time": 0.270695, "process_mem_max_rss": "115676", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:22:56.838822 [debug] [MainThread]: Command `dbt test` failed at 01:22:56.838620 after 3.18 seconds
[0m01:22:56.840406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b341927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b341549d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34172010>]}
[0m01:22:56.841604 [debug] [MainThread]: Flushing usage events
[0m01:24:04.892797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429c89590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429cde750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429c8b2d0>]}


============================== 01:24:04.901364 | 41ca6866-c2dd-4414-9311-7e34b42198bb ==============================
[0m01:24:04.901364 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:24:04.903295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:24:05.126374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44283ee510>]}
[0m01:24:05.215367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429ccb6d0>]}
[0m01:24:05.217307 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:24:05.231991 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:24:05.283909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:05.285532 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:24:05.460955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m01:24:05.469083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44283ce150>]}
[0m01:24:05.496881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4428400990>]}
[0m01:24:05.498072 [info ] [MainThread]: Found 1 model, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:24:05.499499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4428133f10>]}
[0m01:24:05.503571 [info ] [MainThread]: 
[0m01:24:05.506017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:24:05.509183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:24:05.526059 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:24:05.527342 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:24:05.528428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:05.549053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.550146 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:24:05.551253 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:24:05.560321 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:24:05.562924 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:24:05.564120 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:24:05.572530 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:05.573722 [debug] [MainThread]: On master: BEGIN
[0m01:24:05.574700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:05.591493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.592771 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:05.593802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:24:05.604040 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:24:05.607403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ca6866-c2dd-4414-9311-7e34b42198bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442cced390>]}
[0m01:24:05.608760 [debug] [MainThread]: On master: ROLLBACK
[0m01:24:05.609913 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:05.610859 [debug] [MainThread]: On master: BEGIN
[0m01:24:05.612479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.613556 [debug] [MainThread]: On master: COMMIT
[0m01:24:05.614553 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:05.615480 [debug] [MainThread]: On master: COMMIT
[0m01:24:05.616815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:24:05.617798 [debug] [MainThread]: On master: Close
[0m01:24:05.619404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:05.620605 [info ] [MainThread]: 
[0m01:24:05.633018 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:24:05.634433 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:24:05.636365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:24:05.637628 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:24:05.654810 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:24:05.659133 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:24:05.638659 => 01:24:05.658591
[0m01:24:05.660562 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:24:05.686904 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:24:05.690788 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:24:05.691864 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:24:05.692907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:05.709622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.710860 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:24:05.711869 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- Test for referential integrity with manifestation table



-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m01:24:05.713248 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:24:05.714338 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:24:05.715902 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:24:05.661513 => 01:24:05.715462
[0m01:24:05.716942 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:24:05.722746 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:24:05.724131 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:24:05.725672 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:24:05.726991 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:05.728937 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:24:05.730560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:24:05.731598 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:05.747174 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:05.751589 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:24:05.732525 => 01:24:05.751177
[0m01:24:05.753503 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:05.758005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:05.761078 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:05.762531 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:24:05.763974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:05.780270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.781437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:05.782627 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:24:05.787558 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:05.791339 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:24:05.754428 => 01:24:05.790984
[0m01:24:05.792500 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:24:05.793938 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:24:05.795598 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m01:24:05.797137 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:05.798320 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:05.799365 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:24:05.801253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:24:05.802359 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:05.809414 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:05.812971 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:24:05.803178 => 01:24:05.812449
[0m01:24:05.813969 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:05.819734 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:05.822928 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:05.824078 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:24:05.825185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:05.844446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.846530 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:05.848276 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:24:05.854520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:05.857497 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:24:05.814784 => 01:24:05.857149
[0m01:24:05.859126 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:24:05.860766 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:24:05.862986 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:24:05.865021 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:05.866478 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:05.867850 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:24:05.870155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:24:05.871340 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:05.878588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:05.882228 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:24:05.872112 => 01:24:05.881842
[0m01:24:05.883773 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:05.890548 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:05.896834 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:05.898381 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:24:05.900582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:05.924964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:05.926486 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:05.927980 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:24:05.933678 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:05.937581 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:24:05.885566 => 01:24:05.937117
[0m01:24:05.939157 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:24:05.941266 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:24:05.943147 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.07s]
[0m01:24:05.944932 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:05.946372 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:05.947990 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:24:05.950122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:24:05.952036 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:05.966596 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:05.970396 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:24:05.953098 => 01:24:05.969986
[0m01:24:05.971675 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:05.977335 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:05.982020 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:05.983829 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:24:05.985105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:06.004634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:06.006144 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:06.007518 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:24:06.013481 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:06.016705 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:24:05.972735 => 01:24:06.016298
[0m01:24:06.018012 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:24:06.019778 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:24:06.021928 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.07s]
[0m01:24:06.024374 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:06.026001 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:06.030486 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:24:06.032727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:24:06.034153 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:06.045790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:06.050086 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:24:06.035142 => 01:24:06.049611
[0m01:24:06.051336 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:06.055984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:06.060003 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:06.061465 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:24:06.062662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:06.081550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:06.083301 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:06.084517 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:24:06.089726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:06.092861 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:24:06.052342 => 01:24:06.092419
[0m01:24:06.094037 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:24:06.095401 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:24:06.097330 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:24:06.099080 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:06.102531 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:06.103552 [debug] [MainThread]: On master: BEGIN
[0m01:24:06.104581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:06.121096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:06.122440 [debug] [MainThread]: On master: COMMIT
[0m01:24:06.123615 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:06.124613 [debug] [MainThread]: On master: COMMIT
[0m01:24:06.125908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:24:06.126770 [debug] [MainThread]: On master: Close
[0m01:24:06.128319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:06.129243 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:24:06.130329 [info ] [MainThread]: 
[0m01:24:06.131594 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:24:06.134346 [debug] [MainThread]: Command end result
[0m01:24:06.153098 [info ] [MainThread]: 
[0m01:24:06.154505 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:24:06.155784 [info ] [MainThread]: 
[0m01:24:06.158116 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:24:06.159987 [info ] [MainThread]: 
[0m01:24:06.161814 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:24:06.163219 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:24:06.165043 [info ] [MainThread]: 
[0m01:24:06.166349 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:24:06.168012 [info ] [MainThread]: 
[0m01:24:06.169377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:24:06.171254 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3456293, "process_user_time": 3.897108, "process_kernel_time": 0.219684, "process_mem_max_rss": "110096", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:24:06.172627 [debug] [MainThread]: Command `dbt test` failed at 01:24:06.172435 after 1.35 seconds
[0m01:24:06.173924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429c94b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4429ce1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f442dc6cd90>]}
[0m01:24:06.175029 [debug] [MainThread]: Flushing usage events
[0m01:24:39.850715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200864b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200869fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2008ce8490>]}


============================== 01:24:39.859239 | b9528839-5a7a-4d84-8a01-9d5a4d56efb3 ==============================
[0m01:24:39.859239 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:24:39.860883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:24:40.088673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2006f4b050>]}
[0m01:24:40.178843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200867da50>]}
[0m01:24:40.180541 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:24:40.195223 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:24:40.249859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:40.251966 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:24:40.413541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m01:24:40.422022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200993bf10>]}
[0m01:24:40.447480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2006c78610>]}
[0m01:24:40.448910 [info ] [MainThread]: Found 1 model, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:24:40.450183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2006ce7ed0>]}
[0m01:24:40.453695 [info ] [MainThread]: 
[0m01:24:40.455634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:24:40.458420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:24:40.474474 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:24:40.475733 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:24:40.476700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:40.496373 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.497600 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:24:40.498778 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:24:40.507539 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:24:40.510296 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:24:40.511697 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:24:40.520490 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:40.521633 [debug] [MainThread]: On master: BEGIN
[0m01:24:40.522720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:40.539555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.540760 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:40.541816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:24:40.552926 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:24:40.555958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9528839-5a7a-4d84-8a01-9d5a4d56efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2006d70450>]}
[0m01:24:40.557170 [debug] [MainThread]: On master: ROLLBACK
[0m01:24:40.558352 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:40.559193 [debug] [MainThread]: On master: BEGIN
[0m01:24:40.560600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.561743 [debug] [MainThread]: On master: COMMIT
[0m01:24:40.562757 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:40.563732 [debug] [MainThread]: On master: COMMIT
[0m01:24:40.564949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:24:40.565953 [debug] [MainThread]: On master: Close
[0m01:24:40.567506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:40.568877 [info ] [MainThread]: 
[0m01:24:40.580932 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:24:40.582041 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:24:40.583867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:24:40.585121 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:24:40.605954 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:24:40.610765 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:24:40.586117 => 01:24:40.610125
[0m01:24:40.612050 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:24:40.638922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:24:40.642981 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:24:40.644175 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:24:40.645389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:40.662358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.663879 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:24:40.665127 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql


      
    ) dbt_internal_test
[0m01:24:40.666997 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:24:40.668149 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:24:40.669967 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:24:40.613179 => 01:24:40.669502
[0m01:24:40.671009 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:24:40.677509 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:24:40.679131 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.10s]
[0m01:24:40.680888 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:24:40.682108 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:40.684395 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:24:40.686347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:24:40.687797 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:40.703499 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:40.707545 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:24:40.688757 => 01:24:40.707163
[0m01:24:40.708673 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:40.712999 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:40.716492 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:40.718001 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:24:40.719179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:40.735369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.736446 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:24:40.737513 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:24:40.742376 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:40.745806 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:24:40.709556 => 01:24:40.745405
[0m01:24:40.746892 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:24:40.748321 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:24:40.750556 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:24:40.752528 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:24:40.754069 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:40.755268 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:24:40.757141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:24:40.758281 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:40.765625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:40.769530 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:24:40.759165 => 01:24:40.769142
[0m01:24:40.770860 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:40.777515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:40.781520 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:40.783200 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:24:40.784751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:40.882705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.890508 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:24:40.893145 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:24:40.900945 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:40.905609 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:24:40.772021 => 01:24:40.905002
[0m01:24:40.907425 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:24:40.910271 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:24:40.913247 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.16s]
[0m01:24:40.915338 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:24:40.917522 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:40.919419 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:24:40.922188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:24:40.924043 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:40.936283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:40.940614 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:24:40.925649 => 01:24:40.939930
[0m01:24:40.942087 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:40.949022 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:40.954141 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:40.955758 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:24:40.957950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:40.985118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:40.986952 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:24:40.988411 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:24:40.994147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:40.999939 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:24:40.943217 => 01:24:40.999175
[0m01:24:41.001695 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:24:41.003402 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:24:41.005873 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.08s]
[0m01:24:41.009356 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:24:41.011766 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:41.013818 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:24:41.017375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:24:41.019449 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:41.053897 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:41.059094 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:24:41.021713 => 01:24:41.058398
[0m01:24:41.060844 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:41.065831 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:41.071047 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:41.072345 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:24:41.073589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:41.099042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:41.101422 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:24:41.103245 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:24:41.119737 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:41.124037 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:24:41.061919 => 01:24:41.123515
[0m01:24:41.125436 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:24:41.127215 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:24:41.130094 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.11s]
[0m01:24:41.132556 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:24:41.134243 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:41.136390 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:24:41.138690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:24:41.140194 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:41.154043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:41.157259 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:24:41.141452 => 01:24:41.156901
[0m01:24:41.158404 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:41.163032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:41.166503 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:41.167810 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:24:41.168898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:41.186006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:24:41.187290 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:24:41.188276 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:24:41.192844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:24:41.195630 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:24:41.159492 => 01:24:41.195306
[0m01:24:41.196842 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:24:41.198147 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:24:41.200002 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:24:41.201544 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:24:41.205398 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:41.206428 [debug] [MainThread]: On master: BEGIN
[0m01:24:41.207579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:41.224539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:24:41.225728 [debug] [MainThread]: On master: COMMIT
[0m01:24:41.226683 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:41.227566 [debug] [MainThread]: On master: COMMIT
[0m01:24:41.229050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:24:41.230112 [debug] [MainThread]: On master: Close
[0m01:24:41.231585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:41.232559 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:24:41.233572 [info ] [MainThread]: 
[0m01:24:41.234924 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m01:24:41.237704 [debug] [MainThread]: Command end result
[0m01:24:41.255805 [info ] [MainThread]: 
[0m01:24:41.257117 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:24:41.258542 [info ] [MainThread]: 
[0m01:24:41.260246 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:24:41.262069 [info ] [MainThread]: 
[0m01:24:41.263546 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:24:41.265061 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:24:41.266428 [info ] [MainThread]: 
[0m01:24:41.268170 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:24:41.269511 [info ] [MainThread]: 
[0m01:24:41.270837 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:24:41.272806 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.4905152, "process_user_time": 3.804168, "process_kernel_time": 0.23171, "process_mem_max_rss": "110100", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:24:41.274054 [debug] [MainThread]: Command `dbt test` failed at 01:24:41.273863 after 1.49 seconds
[0m01:24:41.275135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2008654b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20086a2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20086a31d0>]}
[0m01:24:41.276051 [debug] [MainThread]: Flushing usage events
[0m01:25:32.414875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53822cb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5383b77150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538371d710>]}


============================== 01:25:32.423803 | d1265da9-730c-4591-b9dd-7a42da89d4d8 ==============================
[0m01:25:32.423803 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:25:32.425691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:32.674558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53822b4150>]}
[0m01:25:32.765062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5380bd3a50>]}
[0m01:25:32.766834 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:25:32.781985 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:25:32.832839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:32.834476 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:25:32.987618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:25:32.995541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53822cd2d0>]}
[0m01:25:33.021062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53808f8a90>]}
[0m01:25:33.023205 [info ] [MainThread]: Found 1 model, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:25:33.024699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5380a53750>]}
[0m01:25:33.028541 [info ] [MainThread]: 
[0m01:25:33.031121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:25:33.033971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:25:33.050734 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:25:33.051818 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:25:33.052756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:33.070891 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.071941 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:25:33.072860 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:25:33.082022 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:25:33.084457 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:25:33.085623 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:25:33.093767 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.094737 [debug] [MainThread]: On master: BEGIN
[0m01:25:33.095613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:33.111170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.112340 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.113439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:25:33.123690 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:25:33.126875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1265da9-730c-4591-b9dd-7a42da89d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53808f8910>]}
[0m01:25:33.127974 [debug] [MainThread]: On master: ROLLBACK
[0m01:25:33.129126 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.129982 [debug] [MainThread]: On master: BEGIN
[0m01:25:33.131357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.132453 [debug] [MainThread]: On master: COMMIT
[0m01:25:33.133474 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.134444 [debug] [MainThread]: On master: COMMIT
[0m01:25:33.135767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:25:33.136657 [debug] [MainThread]: On master: Close
[0m01:25:33.138409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:33.139732 [info ] [MainThread]: 
[0m01:25:33.151506 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:25:33.152762 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:25:33.154542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:25:33.155762 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:25:33.173033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:25:33.177251 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:25:33.156650 => 01:25:33.176832
[0m01:25:33.178393 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:25:33.202902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:25:33.206390 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:25:33.207448 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:25:33.208692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.225580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.227316 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:25:33.229166 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:25:33.231264 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:25:33.232470 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:25:33.234799 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:25:33.179230 => 01:25:33.234153
[0m01:25:33.236103 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:25:33.242496 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:25:33.244053 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:25:33.246165 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:25:33.247767 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:25:33.249929 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:25:33.251794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:25:33.252922 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:25:33.270532 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:25:33.275030 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:25:33.254367 => 01:25:33.274596
[0m01:25:33.276208 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:25:33.280652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:25:33.284142 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:25:33.285579 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:25:33.287182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.303166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.304376 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:25:33.305428 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:25:33.310449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:25:33.314128 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:25:33.277153 => 01:25:33.313779
[0m01:25:33.315305 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:25:33.317813 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:25:33.319963 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.07s]
[0m01:25:33.321767 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:25:33.323765 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:25:33.325236 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:25:33.327693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:25:33.329287 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:25:33.337492 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:25:33.342405 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:25:33.330709 => 01:25:33.341652
[0m01:25:33.344289 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:25:33.353375 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:25:33.358237 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:25:33.359891 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:25:33.361204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.383955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.385776 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:25:33.387148 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:25:33.392852 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:25:33.396448 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:25:33.346100 => 01:25:33.396071
[0m01:25:33.398160 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:25:33.399803 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:25:33.402078 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.07s]
[0m01:25:33.405157 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:25:33.408730 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:25:33.410780 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:25:33.413494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:25:33.415084 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:25:33.424414 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:25:33.428816 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:25:33.416278 => 01:25:33.428189
[0m01:25:33.430428 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:25:33.436148 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:25:33.440773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:25:33.442261 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:25:33.443455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.460011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.461243 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:25:33.462356 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:25:33.466737 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:25:33.469304 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:25:33.431803 => 01:25:33.468976
[0m01:25:33.470327 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:25:33.472384 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:25:33.474497 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m01:25:33.476358 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:25:33.477784 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:25:33.478796 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:25:33.480457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:25:33.482389 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:25:33.495450 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:25:33.501106 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:25:33.483395 => 01:25:33.500649
[0m01:25:33.502236 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:25:33.506603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:25:33.509221 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:25:33.510192 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:25:33.511396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.527462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.528748 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:25:33.529807 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:25:33.534697 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:25:33.537625 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:25:33.503099 => 01:25:33.537178
[0m01:25:33.538707 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:25:33.540046 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:25:33.541849 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.06s]
[0m01:25:33.543275 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:25:33.544565 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:25:33.545786 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:25:33.547736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:25:33.548779 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:25:33.558315 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:25:33.561389 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:25:33.549655 => 01:25:33.561048
[0m01:25:33.562442 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:25:33.566812 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:25:33.569472 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:25:33.570476 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:25:33.571726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:33.588480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.589775 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:25:33.590847 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:25:33.595410 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:25:33.598337 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:25:33.563435 => 01:25:33.597989
[0m01:25:33.599467 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:25:33.600960 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:25:33.602832 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:25:33.604477 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:25:33.608180 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.609218 [debug] [MainThread]: On master: BEGIN
[0m01:25:33.610152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:33.626170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:25:33.627510 [debug] [MainThread]: On master: COMMIT
[0m01:25:33.628588 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:33.629464 [debug] [MainThread]: On master: COMMIT
[0m01:25:33.630701 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:25:33.631677 [debug] [MainThread]: On master: Close
[0m01:25:33.633186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:33.634105 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:25:33.635244 [info ] [MainThread]: 
[0m01:25:33.636586 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m01:25:33.639403 [debug] [MainThread]: Command end result
[0m01:25:33.658647 [info ] [MainThread]: 
[0m01:25:33.660048 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:25:33.661198 [info ] [MainThread]: 
[0m01:25:33.662914 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:25:33.664405 [info ] [MainThread]: 
[0m01:25:33.665715 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:25:33.666856 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:25:33.668149 [info ] [MainThread]: 
[0m01:25:33.669682 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:25:33.670873 [info ] [MainThread]: 
[0m01:25:33.672293 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:25:33.674348 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3510642, "process_user_time": 3.92449, "process_kernel_time": 0.27087, "process_mem_max_rss": "109684", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:25:33.676011 [debug] [MainThread]: Command `dbt test` failed at 01:25:33.675778 after 1.35 seconds
[0m01:25:33.677313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53822cfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53822cce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5380c0ab50>]}
[0m01:25:33.678624 [debug] [MainThread]: Flushing usage events
[0m01:26:57.939077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a78064b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a78ce2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a77ffd8d0>]}


============================== 01:26:57.947772 | 05e69dd7-b160-4be1-8804-2cad96108757 ==============================
[0m01:26:57.947772 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:26:57.949582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m01:26:58.175670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05e69dd7-b160-4be1-8804-2cad96108757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a77a74f50>]}
[0m01:26:58.262175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05e69dd7-b160-4be1-8804-2cad96108757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a77a2f9d0>]}
[0m01:26:58.264017 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:26:58.278721 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:26:58.338092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:26:58.339639 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:26:58.467777 [error] [MainThread]: Encountered an error:
Compilation Error in test merged_episode_test (tests/merged_episode_test.sql)
  expected token '(', got 'end of statement block'
    line 21
      {% test not_null_manifestation_eidrid %}
[0m01:26:58.469868 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.59993196, "process_user_time": 3.521025, "process_kernel_time": 0.201054, "process_mem_max_rss": "102256", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m01:26:58.471534 [debug] [MainThread]: Command `dbt test` failed at 01:26:58.471199 after 0.60 seconds
[0m01:26:58.472882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76012cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a76272f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a762711d0>]}
[0m01:26:58.474024 [debug] [MainThread]: Flushing usage events
[0m01:28:46.175720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc425490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc9a9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc425610>]}


============================== 01:28:46.184131 | 8b2d048a-8a35-4ff9-b914-615d45e28889 ==============================
[0m01:28:46.184131 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:28:46.185601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:46.408309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc4bed90>]}
[0m01:28:46.493794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dad9f450>]}
[0m01:28:46.495421 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:28:46.509624 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:28:46.561165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:28:46.562692 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:28:46.718370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m01:28:46.726331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac88e90>]}
[0m01:28:46.756236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dacc5490>]}
[0m01:28:46.757362 [info ] [MainThread]: Found 1 model, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:28:46.758974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44daaa8710>]}
[0m01:28:46.762616 [info ] [MainThread]: 
[0m01:28:46.764884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:28:46.767787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:28:46.784313 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:28:46.785374 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:28:46.786349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:46.805101 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:28:46.806158 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:28:46.807229 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:28:46.815476 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:28:46.817979 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:28:46.819154 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:28:46.827580 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:46.828809 [debug] [MainThread]: On master: BEGIN
[0m01:28:46.830224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:46.846082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:28:46.847193 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:46.848375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:28:46.859020 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:28:46.862047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2d048a-8a35-4ff9-b914-615d45e28889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac28210>]}
[0m01:28:46.863289 [debug] [MainThread]: On master: ROLLBACK
[0m01:28:46.864558 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:46.865488 [debug] [MainThread]: On master: BEGIN
[0m01:28:46.866828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:28:46.867950 [debug] [MainThread]: On master: COMMIT
[0m01:28:46.868867 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:46.869969 [debug] [MainThread]: On master: COMMIT
[0m01:28:46.871074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:28:46.872004 [debug] [MainThread]: On master: Close
[0m01:28:46.873527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:46.874782 [info ] [MainThread]: 
[0m01:28:46.888123 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:28:46.889617 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:28:46.891674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:28:46.893097 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:28:46.911104 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:28:46.915156 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:28:46.894107 => 01:28:46.914678
[0m01:28:46.916549 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:28:46.940514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:28:46.944163 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:28:46.945185 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:28:46.946264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:46.962527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:46.963633 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:28:46.964647 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column



-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:28:46.966332 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 33:     ) dbt_internal_test
             ^

[0m01:28:46.967464 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:28:46.969220 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:28:46.917396 => 01:28:46.968703
[0m01:28:46.970374 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:28:46.976779 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 33:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:28:46.978197 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:28:46.979860 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:28:46.981168 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:28:46.983138 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:28:46.985083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:28:46.986135 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:28:47.001430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:28:47.005064 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:28:46.987012 => 01:28:47.004588
[0m01:28:47.006096 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:28:47.010392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:28:47.013722 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:28:47.015026 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:28:47.016262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:47.032670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.034211 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:28:47.035419 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:28:47.040430 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:28:47.043818 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:28:47.007115 => 01:28:47.043474
[0m01:28:47.045095 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:28:47.046334 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:28:47.048375 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:28:47.050383 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:28:47.051612 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:28:47.053796 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:28:47.057598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:28:47.061284 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:28:47.070033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:28:47.073164 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:28:47.062617 => 01:28:47.072563
[0m01:28:47.074402 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:28:47.080551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:28:47.085109 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:28:47.086363 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:28:47.087389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:47.106233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.107556 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:28:47.108985 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:28:47.113767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:28:47.117164 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:28:47.075296 => 01:28:47.116702
[0m01:28:47.118452 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:28:47.119762 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:28:47.121702 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:28:47.123633 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:28:47.125125 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:28:47.126292 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:28:47.127893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:28:47.129215 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:28:47.136381 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:28:47.139682 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:28:47.130183 => 01:28:47.139269
[0m01:28:47.141243 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:28:47.145845 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:28:47.151063 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:28:47.152461 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:28:47.153679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:47.172606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.174328 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:28:47.175675 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:28:47.181213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:28:47.184572 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:28:47.142288 => 01:28:47.184202
[0m01:28:47.186133 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:28:47.187553 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:28:47.189807 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.06s]
[0m01:28:47.192658 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:28:47.194708 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:28:47.196309 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:28:47.198727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:28:47.200359 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:28:47.218668 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:28:47.222245 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:28:47.201547 => 01:28:47.221857
[0m01:28:47.223513 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:28:47.228468 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:28:47.232571 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:28:47.234707 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:28:47.237147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:47.258338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.260992 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:28:47.263482 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:28:47.269490 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:28:47.272325 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:28:47.225088 => 01:28:47.271926
[0m01:28:47.273571 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:28:47.275004 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:28:47.276871 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.08s]
[0m01:28:47.278785 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:28:47.280349 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:28:47.281456 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:28:47.283235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:28:47.284302 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:28:47.295232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:28:47.298716 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:28:47.285228 => 01:28:47.298296
[0m01:28:47.300077 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:28:47.305043 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:28:47.307986 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:28:47.310089 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:28:47.311240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:47.327281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.328529 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:28:47.329583 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:28:47.334042 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:28:47.336947 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:28:47.301052 => 01:28:47.336610
[0m01:28:47.338036 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:28:47.339350 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:28:47.341311 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:28:47.342953 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:28:47.346979 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:47.347958 [debug] [MainThread]: On master: BEGIN
[0m01:28:47.348978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:47.364567 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:28:47.365916 [debug] [MainThread]: On master: COMMIT
[0m01:28:47.366806 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:47.367717 [debug] [MainThread]: On master: COMMIT
[0m01:28:47.369678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:28:47.370719 [debug] [MainThread]: On master: Close
[0m01:28:47.372496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:47.373924 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:28:47.375005 [info ] [MainThread]: 
[0m01:28:47.376208 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m01:28:47.379271 [debug] [MainThread]: Command end result
[0m01:28:47.399793 [info ] [MainThread]: 
[0m01:28:47.401423 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:28:47.403256 [info ] [MainThread]: 
[0m01:28:47.405096 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 33:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:28:47.406708 [info ] [MainThread]: 
[0m01:28:47.409294 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:28:47.411324 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:28:47.413061 [info ] [MainThread]: 
[0m01:28:47.414916 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:28:47.416804 [info ] [MainThread]: 
[0m01:28:47.418785 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:28:47.420748 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.332172, "process_user_time": 3.96307, "process_kernel_time": 0.251542, "process_mem_max_rss": "109732", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:28:47.422192 [debug] [MainThread]: Command `dbt test` failed at 01:28:47.422000 after 1.33 seconds
[0m01:28:47.423242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc431490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc430b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44daa52390>]}
[0m01:28:47.424276 [debug] [MainThread]: Flushing usage events
[0m01:29:39.121280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c0e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c6e98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497d9e3650>]}


============================== 01:29:39.296257 | 620ce4a5-bd69-406e-a810-c34a5fed6314 ==============================
[0m01:29:39.296257 [info ] [MainThread]: Running with dbt=1.7.14
[0m01:29:39.299457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:29:39.551454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497aa3df50>]}
[0m01:29:39.640230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497aa53950>]}
[0m01:29:39.641982 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m01:29:39.655477 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m01:29:39.706035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:29:39.707543 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m01:29:39.863819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m01:29:39.871766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c16eb50>]}
[0m01:29:39.896872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c16e5d0>]}
[0m01:29:39.898170 [info ] [MainThread]: Found 1 model, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:29:39.899310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497a76c890>]}
[0m01:29:39.903084 [info ] [MainThread]: 
[0m01:29:39.905105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:29:39.908309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m01:29:39.924519 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:29:39.925821 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m01:29:39.926850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:39.944918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:29:39.945983 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m01:29:39.946980 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:29:39.955541 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:29:39.958640 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m01:29:39.960262 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m01:29:39.969858 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:39.971336 [debug] [MainThread]: On master: BEGIN
[0m01:29:39.972443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:39.989334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:29:39.990548 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:39.991882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:29:40.002440 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:29:40.005844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620ce4a5-bd69-406e-a810-c34a5fed6314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c15a490>]}
[0m01:29:40.007097 [debug] [MainThread]: On master: ROLLBACK
[0m01:29:40.008748 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:40.009761 [debug] [MainThread]: On master: BEGIN
[0m01:29:40.011260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.012407 [debug] [MainThread]: On master: COMMIT
[0m01:29:40.013518 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:40.014490 [debug] [MainThread]: On master: COMMIT
[0m01:29:40.015777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:29:40.016846 [debug] [MainThread]: On master: Close
[0m01:29:40.018422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:29:40.019784 [info ] [MainThread]: 
[0m01:29:40.032502 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m01:29:40.033939 [info ] [Thread-1 (]: 1 of 6 START test merged_episode_test .......................................... [RUN]
[0m01:29:40.035763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m01:29:40.037200 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m01:29:40.057101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m01:29:40.063002 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 01:29:40.038359 => 01:29:40.062466
[0m01:29:40.064229 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m01:29:40.092088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m01:29:40.095815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:29:40.097049 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m01:29:40.098192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.114383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.115811 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m01:29:40.116941 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m01:29:40.118540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m01:29:40.119842 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m01:29:40.121477 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 01:29:40.065130 => 01:29:40.121145
[0m01:29:40.122496 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m01:29:40.128549 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:29:40.129929 [error] [Thread-1 (]: 1 of 6 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m01:29:40.131471 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m01:29:40.132936 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:29:40.134840 [info ] [Thread-1 (]: 2 of 6 START test not_null_merged_episode_manifestation_published_status ....... [RUN]
[0m01:29:40.136706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf)
[0m01:29:40.137794 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:29:40.152710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:29:40.157194 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (compile): 01:29:40.138560 => 01:29:40.156717
[0m01:29:40.158559 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:29:40.163038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:29:40.165999 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:29:40.167367 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: BEGIN
[0m01:29:40.168541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.183905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.185114 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"
[0m01:29:40.186200 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_published_status
from "dev_db"."public"."merged_episode"
where manifestation_published_status is null



      
    ) dbt_internal_test
[0m01:29:40.190834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:29:40.194284 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf (execute): 01:29:40.159514 => 01:29:40.193935
[0m01:29:40.195399 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: ROLLBACK
[0m01:29:40.196963 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf: Close
[0m01:29:40.198979 [info ] [Thread-1 (]: 2 of 6 PASS not_null_merged_episode_manifestation_published_status ............. [[32mPASS[0m in 0.06s]
[0m01:29:40.200929 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf
[0m01:29:40.202428 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:29:40.204264 [info ] [Thread-1 (]: 3 of 6 START test not_null_merged_episode_manifestation_title .................. [RUN]
[0m01:29:40.206250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_published_status.fff07466cf, now test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703)
[0m01:29:40.207321 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:29:40.215436 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:29:40.219779 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (compile): 01:29:40.208362 => 01:29:40.219297
[0m01:29:40.220878 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:29:40.228044 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:29:40.231386 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:29:40.232555 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: BEGIN
[0m01:29:40.233914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.250698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.251867 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"
[0m01:29:40.252894 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select manifestation_title
from "dev_db"."public"."merged_episode"
where manifestation_title is null



      
    ) dbt_internal_test
[0m01:29:40.257319 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:29:40.260157 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703 (execute): 01:29:40.221754 => 01:29:40.259811
[0m01:29:40.261269 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: ROLLBACK
[0m01:29:40.262668 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703: Close
[0m01:29:40.264570 [info ] [Thread-1 (]: 3 of 6 PASS not_null_merged_episode_manifestation_title ........................ [[32mPASS[0m in 0.06s]
[0m01:29:40.266240 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703
[0m01:29:40.267429 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:29:40.268643 [info ] [Thread-1 (]: 4 of 6 START test not_null_merged_episode_release_date ......................... [RUN]
[0m01:29:40.270537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_manifestation_title.421c901703, now test.dbt_poc.not_null_merged_episode_release_date.b628659c3f)
[0m01:29:40.271801 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:29:40.278266 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:29:40.281309 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (compile): 01:29:40.272608 => 01:29:40.280970
[0m01:29:40.282443 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:29:40.286474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:29:40.289080 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:29:40.290222 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: BEGIN
[0m01:29:40.292004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.309178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.310358 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"
[0m01:29:40.311447 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_release_date.b628659c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "dev_db"."public"."merged_episode"
where release_date is null



      
    ) dbt_internal_test
[0m01:29:40.316035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:29:40.319132 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_release_date.b628659c3f (execute): 01:29:40.283309 => 01:29:40.318769
[0m01:29:40.320314 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: ROLLBACK
[0m01:29:40.321737 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_release_date.b628659c3f: Close
[0m01:29:40.323724 [info ] [Thread-1 (]: 4 of 6 PASS not_null_merged_episode_release_date ............................... [[32mPASS[0m in 0.05s]
[0m01:29:40.325573 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_release_date.b628659c3f
[0m01:29:40.327036 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:29:40.328206 [info ] [Thread-1 (]: 5 of 6 START test relationships_merged_episode_uid__uid__ref_episode_ .......... [RUN]
[0m01:29:40.330191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_release_date.b628659c3f, now test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1)
[0m01:29:40.331281 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:29:40.343640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:29:40.347779 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (compile): 01:29:40.332143 => 01:29:40.347217
[0m01:29:40.348957 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:29:40.353056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:29:40.356023 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:29:40.357316 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: BEGIN
[0m01:29:40.359137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.376224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.377376 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"
[0m01:29:40.378544 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select uid as from_field
    from "dev_db"."public"."merged_episode"
    where uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:29:40.383372 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:29:40.386082 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1 (execute): 01:29:40.349796 => 01:29:40.385741
[0m01:29:40.387155 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: ROLLBACK
[0m01:29:40.388428 [debug] [Thread-1 (]: On test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1: Close
[0m01:29:40.390420 [info ] [Thread-1 (]: 5 of 6 PASS relationships_merged_episode_uid__uid__ref_episode_ ................ [[32mPASS[0m in 0.06s]
[0m01:29:40.392127 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1
[0m01:29:40.393373 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:29:40.394557 [info ] [Thread-1 (]: 6 of 6 START test unique_merged_episode_uid .................................... [RUN]
[0m01:29:40.396319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_merged_episode_uid__uid__ref_episode_.940cc9e9d1, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m01:29:40.397478 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:29:40.407886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:29:40.410907 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 01:29:40.398405 => 01:29:40.410409
[0m01:29:40.412091 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:29:40.416234 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:29:40.418977 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:29:40.419998 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m01:29:40.421230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:40.438499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.439745 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m01:29:40.440812 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m01:29:40.445296 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:29:40.448007 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 01:29:40.412904 => 01:29:40.447616
[0m01:29:40.449051 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m01:29:40.450274 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m01:29:40.452149 [error] [Thread-1 (]: 6 of 6 FAIL 5 unique_merged_episode_uid ........................................ [[31mFAIL 5[0m in 0.06s]
[0m01:29:40.453844 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m01:29:40.457556 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:40.458773 [debug] [MainThread]: On master: BEGIN
[0m01:29:40.459724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:40.476036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:29:40.477104 [debug] [MainThread]: On master: COMMIT
[0m01:29:40.478058 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:40.479135 [debug] [MainThread]: On master: COMMIT
[0m01:29:40.480416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:29:40.481398 [debug] [MainThread]: On master: Close
[0m01:29:40.482937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:40.483830 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m01:29:40.484782 [info ] [MainThread]: 
[0m01:29:40.485884 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m01:29:40.488465 [debug] [MainThread]: Command end result
[0m01:29:40.508179 [info ] [MainThread]: 
[0m01:29:40.509574 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:29:40.511079 [info ] [MainThread]: 
[0m01:29:40.515886 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m01:29:40.517539 [info ] [MainThread]: 
[0m01:29:40.520491 [error] [MainThread]: [31mFailure in test unique_merged_episode_uid (models/schema.yml)[0m
[0m01:29:40.522344 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m01:29:40.523953 [info ] [MainThread]: 
[0m01:29:40.525456 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_merged_episode_uid.sql
[0m01:29:40.527059 [info ] [MainThread]: 
[0m01:29:40.528459 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m01:29:40.531778 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.478063, "process_user_time": 3.868859, "process_kernel_time": 0.283709, "process_mem_max_rss": "109640", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m01:29:40.533738 [debug] [MainThread]: Command `dbt test` failed at 01:29:40.533396 after 1.48 seconds
[0m01:29:40.535334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c12bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497c12f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49801a44d0>]}
[0m01:29:40.536766 [debug] [MainThread]: Flushing usage events
[0m02:11:39.345345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a228f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a898dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a20d010>]}


============================== 02:11:39.353786 | 552c34cc-2775-4943-b141-7ff3f625e630 ==============================
[0m02:11:39.353786 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:11:39.355095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:11:39.570107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a217210>]}
[0m02:11:39.655677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6728b5e390>]}
[0m02:11:39.657345 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:11:39.670766 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:11:39.686094 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:11:39.687280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a2596d0>]}
[0m02:11:41.569375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:11:41.578247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6728819a10>]}
[0m02:11:41.605224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672242a910>]}
[0m02:11:41.606415 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:11:41.607897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67289f3a10>]}
[0m02:11:41.611157 [info ] [MainThread]: 
[0m02:11:41.613742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:11:41.616085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m02:11:41.631905 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m02:11:41.633033 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m02:11:41.634072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:41.653952 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:11:41.656446 [debug] [ThreadPool]: On list_dev_db: Close
[0m02:11:41.660035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m02:11:41.668950 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:11:41.670012 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:11:41.670972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:41.686980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:11:41.688099 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:11:41.689127 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:11:41.697899 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:11:41.700342 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:11:41.701986 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:11:41.711616 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.712588 [debug] [MainThread]: On master: BEGIN
[0m02:11:41.713453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:41.729684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:11:41.730626 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.731629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:11:41.741491 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:11:41.744478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6722527810>]}
[0m02:11:41.745438 [debug] [MainThread]: On master: ROLLBACK
[0m02:11:41.746911 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.747737 [debug] [MainThread]: On master: BEGIN
[0m02:11:41.749183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:11:41.749909 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.750594 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.751311 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.752262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:11:41.752963 [debug] [MainThread]: On master: Close
[0m02:11:41.754421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:11:41.755632 [info ] [MainThread]: 
[0m02:11:41.769500 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m02:11:41.770853 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m02:11:41.773287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m02:11:41.774384 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m02:11:41.787734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m02:11:41.792842 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 02:11:41.775194 => 02:11:41.792429
[0m02:11:41.794047 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m02:11:41.844701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m02:11:41.848701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:11:41.850096 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m02:11:41.851129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:41.867703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:11:41.868970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:11:41.870147 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    e.*, -- Include all columns from episode
    jsonb_agg(jsonb_build_object( -- Aggregate manifestation metadata into a JSONB array
        'title', m.title,
        'entity_type', m.entity_type,
        'eidrid', m.eidrid,
        'actual_length', m.actual_length,
        'edit_use', m.edit_use,
        'edit_class', m.edit_class,
        'video_ei', m.video_ei,
        'published_status', m.published_status,
        'video_hidef', m.video_hidef,
        'release_date', m.release_date
    )) as manifestations -- Each element in the array is a JSONB object that contains the metadata for one manifestation
from
    episode e
left join
    manifestation m
on
    e.uid = m.episode_uid
group by
    e.uid -- Group by episode uid to ensure one row per episode




-- -- models/merged_episode.sql
-- with manifestation as (
--     select * from "dev_db"."public"."manifestation"
--     where is_deleted = FALSE
-- ),
-- episode as (
--     select * from "dev_db"."public"."episode"
--     where is_deleted = FALSE
-- )

-- select
--     e.*, -- Include all columns from episode
--     m.title as manifestation_title,
--     m.entity_type as manifestation_entity_type,
--     m.eidrid as manifestation_eidrid,
--     -- Exclude m.structuraltype as manifestation_structuraltype,
--     -- Exclue m.referenttype as manifestation_referenttype,
--     m.actual_length as manifestation_actual_length,
--     m.edit_use as manifestation_edit_use,
--     m.edit_class as manifestation_edit_class,
--     -- Exclude m.audio_closedcaption,
--     -- Exclude m.audio_type,
--     -- Exclude m.video_vchip,
--     m.video_ei as manifestation_video_ei,
--     m.published_status as manifestation_published_status,
--     -- m.deletedatetime as manifestation_deletedatetime,
--     -- m.is_deleted as manifestation_is_deleted,
--     -- m.title_old as manifestation_title_old,
--     -- m.title_old2 as manifestation_title_old2,
--     m.video_hidef as manifestation_video_hidef,
--     m.release_date as manifestation_release_date
-- from
--     episode e
-- left join
--     manifestation m
-- on
--     e.uid = m.episode_uid
  );
[0m02:11:41.876490 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "e.createdatetime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18:     e.*, -- Include all columns from episode
             ^

[0m02:11:41.877543 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: ROLLBACK
[0m02:11:41.879121 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 02:11:41.795190 => 02:11:41.878689
[0m02:11:41.880117 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m02:11:41.885647 [debug] [Thread-1 (]: Database Error in model merged_episode (models/merged_episode.sql)
  column "e.createdatetime" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 18:     e.*, -- Include all columns from episode
               ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:11:41.886985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '552c34cc-2775-4943-b141-7ff3f625e630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67224a4b50>]}
[0m02:11:41.888302 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.merged_episode ..................... [[31mERROR[0m in 0.11s]
[0m02:11:41.889988 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m02:11:41.894654 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.895711 [debug] [MainThread]: On master: BEGIN
[0m02:11:41.896574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:11:41.913861 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:11:41.914749 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.915631 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.916629 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.917695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:11:41.918506 [debug] [MainThread]: On master: Close
[0m02:11:41.920018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:41.920872 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m02:11:41.921729 [info ] [MainThread]: 
[0m02:11:41.922892 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m02:11:41.924412 [debug] [MainThread]: Command end result
[0m02:11:41.941601 [info ] [MainThread]: 
[0m02:11:41.942719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:11:41.944034 [info ] [MainThread]: 
[0m02:11:41.945538 [error] [MainThread]:   Database Error in model merged_episode (models/merged_episode.sql)
  column "e.createdatetime" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 18:     e.*, -- Include all columns from episode
               ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:11:41.947986 [info ] [MainThread]: 
[0m02:11:41.949564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:11:41.952324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6754656, "process_user_time": 5.357765, "process_kernel_time": 0.257604, "process_mem_max_rss": "117440", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:11:41.953587 [debug] [MainThread]: Command `dbt run` failed at 02:11:41.953388 after 2.68 seconds
[0m02:11:41.954603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672a228150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672c8c60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67280deb50>]}
[0m02:11:41.955954 [debug] [MainThread]: Flushing usage events
[0m02:30:49.240736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a1162c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469f418250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469edd7010>]}


============================== 02:30:49.250071 | da4c0efb-7e65-45ca-a741-adb25a61e9f0 ==============================
[0m02:30:49.250071 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:30:49.251785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:30:49.496977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d6e5e10>]}
[0m02:30:49.591780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d6df310>]}
[0m02:30:49.593797 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:30:49.609010 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:30:49.627820 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:30:49.629687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d57a0d0>]}
[0m02:30:51.380788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m02:30:51.390925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46971db310>]}
[0m02:30:51.418410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4697039a90>]}
[0m02:30:51.419902 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:30:51.421179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d3803d0>]}
[0m02:30:51.424260 [info ] [MainThread]: 
[0m02:30:51.426184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:30:51.428425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m02:30:51.443797 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m02:30:51.445209 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m02:30:51.446232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:51.467798 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:30:51.470316 [debug] [ThreadPool]: On list_dev_db: Close
[0m02:30:51.473845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m02:30:51.483268 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:30:51.484553 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:30:51.485588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:51.502305 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:30:51.503403 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:30:51.504703 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:30:51.513188 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:30:51.515787 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:30:51.517148 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:30:51.525437 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.526591 [debug] [MainThread]: On master: BEGIN
[0m02:30:51.527535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:51.543225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:30:51.544375 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.545907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:30:51.557274 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:30:51.561710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d37ef90>]}
[0m02:30:51.563110 [debug] [MainThread]: On master: ROLLBACK
[0m02:30:51.564655 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.565592 [debug] [MainThread]: On master: BEGIN
[0m02:30:51.567217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:30:51.568379 [debug] [MainThread]: On master: COMMIT
[0m02:30:51.569690 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.570705 [debug] [MainThread]: On master: COMMIT
[0m02:30:51.572091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:30:51.573196 [debug] [MainThread]: On master: Close
[0m02:30:51.574826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:51.576121 [info ] [MainThread]: 
[0m02:30:51.588916 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m02:30:51.590286 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m02:30:51.592473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m02:30:51.593982 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m02:30:51.608118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m02:30:51.612355 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 02:30:51.595224 => 02:30:51.611982
[0m02:30:51.613693 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m02:30:51.666531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m02:30:51.670483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:30:51.671708 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m02:30:51.672716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:51.690264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:30:51.691447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:30:51.692885 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    jsonb_build_object( -- Aggregate episode metadata into a JSONB object
        'uid', e.uid,
        'title', e.title,
        'title19', e.title19,
        'titlelong', e.titlelong,
        'episode_number', e.episode_number,
        'distribution_number', e.distribution_number,
        'episodeclases', e.episodeclasses,
        'entity_type', e.entity_type,
        'series_uid', e.series_uid,
        'season_uid', e.season_uid,
        'countryoforigin', e.countryoforigin,
        'primarygenre', e.primarygenre,
        'secondarygenre', e.secondarygenre,
        'keyword_mood', e.keyword_mood,
        'keyword_theme', e.keyword_theme,
        'keyword_setting', e.keyword_setting,
        'keyword_characters', e.keyword_characters,
        'keyword_subject', e.keyword_subject,
        'keyword_time_period', e.keyword_time_period,
        'keyword_general', e.keyword_general,
        'approximate_length', e.approximate_length,
        'eidrid', e.eidrid,
        'primary_language', e.primary_language,
        'secondary_language', e.secondary_language,
        'synopsisshort', e.synopsisshort,
        'synopsislong', e.synopsislong,
        'published_status', e.published_status,
        'release_date', e.release_date) AS episode,
    jsonb_agg(jsonb_build_object( -- Aggregate manifestation metadata into a JSONB array
        'title', m.title,
        'actual_length', m.actual_length,
        'edit_use', m.edit_use,
        'edit_class', m.edit_class,
        'video_ei', m.video_ei,
        'published_status', m.published_status,
        'video_hidef', m.video_hidef,
        'release_date', m.release_date
    )) as manifestations -- Each element in the array is a JSONB object that contains the metadata for one manifestation
from
    episode e
left join
    manifestation m
on
    e.uid = m.episode_uid
group by
    e.uid -- Group by episode uid to ensure one row per episode




-- -- models/merged_episode.sql
-- with manifestation as (
--     select * from "dev_db"."public"."manifestation"
--     where is_deleted = FALSE
-- ),
-- episode as (
--     select * from "dev_db"."public"."episode"
--     where is_deleted = FALSE
-- )

-- select
--     e.*, -- Include all columns from episode
--     m.title as manifestation_title,
--     m.entity_type as manifestation_entity_type,
--     m.eidrid as manifestation_eidrid,
--     -- Exclude m.structuraltype as manifestation_structuraltype,
--     -- Exclue m.referenttype as manifestation_referenttype,
--     m.actual_length as manifestation_actual_length,
--     m.edit_use as manifestation_edit_use,
--     m.edit_class as manifestation_edit_class,
--     -- Exclude m.audio_closedcaption,
--     -- Exclude m.audio_type,
--     -- Exclude m.video_vchip,
--     m.video_ei as manifestation_video_ei,
--     m.published_status as manifestation_published_status,
--     -- m.deletedatetime as manifestation_deletedatetime,
--     -- m.is_deleted as manifestation_is_deleted,
--     -- m.title_old as manifestation_title_old,
--     -- m.title_old2 as manifestation_title_old2,
--     m.video_hidef as manifestation_video_hidef,
--     m.release_date as manifestation_release_date
-- from
--     episode e
-- left join
--     manifestation m
-- on
--     e.uid = m.episode_uid
  );
[0m02:30:51.697054 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column e.episodeclasses does not exist
LINE 25:         'episodeclases', e.episodeclasses,
                                  ^
HINT:  Perhaps you meant to reference the column "e.episodeclass".

[0m02:30:51.698200 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: ROLLBACK
[0m02:30:51.700134 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 02:30:51.614565 => 02:30:51.699589
[0m02:30:51.701360 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m02:30:51.707558 [debug] [Thread-1 (]: Database Error in model merged_episode (models/merged_episode.sql)
  column e.episodeclasses does not exist
  LINE 25:         'episodeclases', e.episodeclasses,
                                    ^
  HINT:  Perhaps you meant to reference the column "e.episodeclass".
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:30:51.709109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da4c0efb-7e65-45ca-a741-adb25a61e9f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46970109d0>]}
[0m02:30:51.710852 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.merged_episode ..................... [[31mERROR[0m in 0.12s]
[0m02:30:51.712749 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m02:30:51.718581 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.720168 [debug] [MainThread]: On master: BEGIN
[0m02:30:51.721188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:51.737921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:30:51.739043 [debug] [MainThread]: On master: COMMIT
[0m02:30:51.740128 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:51.741057 [debug] [MainThread]: On master: COMMIT
[0m02:30:51.742337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:30:51.743546 [debug] [MainThread]: On master: Close
[0m02:30:51.745176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:51.746200 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m02:30:51.747236 [info ] [MainThread]: 
[0m02:30:51.748757 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:30:51.750962 [debug] [MainThread]: Command end result
[0m02:30:51.773295 [info ] [MainThread]: 
[0m02:30:51.776333 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:30:51.778305 [info ] [MainThread]: 
[0m02:30:51.779851 [error] [MainThread]:   Database Error in model merged_episode (models/merged_episode.sql)
  column e.episodeclasses does not exist
  LINE 25:         'episodeclases', e.episodeclasses,
                                    ^
  HINT:  Perhaps you meant to reference the column "e.episodeclass".
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:30:51.781527 [info ] [MainThread]: 
[0m02:30:51.783138 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:30:51.786137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.62095, "process_user_time": 5.210883, "process_kernel_time": 0.229638, "process_mem_max_rss": "117192", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:30:51.787633 [debug] [MainThread]: Command `dbt run` failed at 02:30:51.787343 after 2.62 seconds
[0m02:30:51.788965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d693110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a2d78690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469d5ad8d0>]}
[0m02:30:51.790180 [debug] [MainThread]: Flushing usage events
[0m02:31:57.060756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249ed67550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0054f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249f3d86d0>]}


============================== 02:31:57.069567 | 8611ac12-f7ab-437d-9544-900bcbb7a606 ==============================
[0m02:31:57.069567 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:31:57.071321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:31:57.328068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0666bd0>]}
[0m02:31:57.427435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249eda9450>]}
[0m02:31:57.429318 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:31:57.444205 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:31:57.462472 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:31:57.464189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249f5ce8d0>]}
[0m02:31:59.246875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:31:59.256913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d4e7dd0>]}
[0m02:31:59.280390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249721b1d0>]}
[0m02:31:59.281822 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:31:59.282906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24973bbb50>]}
[0m02:31:59.286052 [info ] [MainThread]: 
[0m02:31:59.288129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:31:59.290544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m02:31:59.306620 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m02:31:59.308049 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m02:31:59.309064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:59.329772 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:31:59.332240 [debug] [ThreadPool]: On list_dev_db: Close
[0m02:31:59.335854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m02:31:59.346175 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:31:59.347798 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:31:59.349005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:31:59.366461 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:31:59.367699 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:31:59.368893 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:31:59.377932 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:31:59.380601 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:31:59.384054 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:31:59.395715 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.396748 [debug] [MainThread]: On master: BEGIN
[0m02:31:59.397712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:31:59.419872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:31:59.420938 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.422266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:31:59.439503 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:31:59.443660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d6bc310>]}
[0m02:31:59.445269 [debug] [MainThread]: On master: ROLLBACK
[0m02:31:59.446812 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.447992 [debug] [MainThread]: On master: BEGIN
[0m02:31:59.450193 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:31:59.452031 [debug] [MainThread]: On master: COMMIT
[0m02:31:59.453821 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.455321 [debug] [MainThread]: On master: COMMIT
[0m02:31:59.458256 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:31:59.461031 [debug] [MainThread]: On master: Close
[0m02:31:59.463669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:31:59.471454 [info ] [MainThread]: 
[0m02:31:59.488506 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m02:31:59.490572 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m02:31:59.493109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m02:31:59.495148 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m02:31:59.513819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m02:31:59.519451 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 02:31:59.496289 => 02:31:59.518848
[0m02:31:59.521520 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m02:31:59.581514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m02:31:59.585430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:31:59.586732 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m02:31:59.587729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:59.603970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:31:59.605396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:31:59.606977 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    jsonb_build_object( -- Aggregate episode metadata into a JSONB object
        'uid', e.uid,
        'title', e.title,
        'title19', e.title19,
        'titlelong', e.titlelong,
        'episode_number', e.episode_number,
        'distribution_number', e.distribution_number,
        'episodeclass', e.episodeclass,
        'entity_type', e.entity_type,
        'series_uid', e.series_uid,
        'season_uid', e.season_uid,
        'countryoforigin', e.countryoforigin,
        'primarygenre', e.primarygenre,
        'secondarygenre', e.secondarygenre,
        'keyword_mood', e.keyword_mood,
        'keyword_theme', e.keyword_theme,
        'keyword_setting', e.keyword_setting,
        'keyword_characters', e.keyword_characters,
        'keyword_subject', e.keyword_subject,
        'keyword_time_period', e.keyword_time_period,
        'keyword_general', e.keyword_general,
        'approximate_length', e.approximate_length,
        'eidrid', e.eidrid,
        'primary_language', e.primary_language,
        'secondary_language', e.secondary_language,
        'synopsisshort', e.synopsisshort,
        'synopsislong', e.synopsislong,
        'published_status', e.published_status,
        'release_date', e.release_date) AS episode,
    jsonb_agg(jsonb_build_object( -- Aggregate manifestation metadata into a JSONB array
        'title', m.title,
        'actual_length', m.actual_length,
        'edit_use', m.edit_use,
        'edit_class', m.edit_class,
        'video_ei', m.video_ei,
        'published_status', m.published_status,
        'video_hidef', m.video_hidef,
        'release_date', m.release_date
    )) as manifestations -- Each element in the array is a JSONB object that contains the metadata for one manifestation
from
    episode e
left join
    manifestation m
on
    e.uid = m.episode_uid
group by
    e.uid -- Group by episode uid to ensure one row per episode




-- -- models/merged_episode.sql
-- with manifestation as (
--     select * from "dev_db"."public"."manifestation"
--     where is_deleted = FALSE
-- ),
-- episode as (
--     select * from "dev_db"."public"."episode"
--     where is_deleted = FALSE
-- )

-- select
--     e.*, -- Include all columns from episode
--     m.title as manifestation_title,
--     m.entity_type as manifestation_entity_type,
--     m.eidrid as manifestation_eidrid,
--     -- Exclude m.structuraltype as manifestation_structuraltype,
--     -- Exclue m.referenttype as manifestation_referenttype,
--     m.actual_length as manifestation_actual_length,
--     m.edit_use as manifestation_edit_use,
--     m.edit_class as manifestation_edit_class,
--     -- Exclude m.audio_closedcaption,
--     -- Exclude m.audio_type,
--     -- Exclude m.video_vchip,
--     m.video_ei as manifestation_video_ei,
--     m.published_status as manifestation_published_status,
--     -- m.deletedatetime as manifestation_deletedatetime,
--     -- m.is_deleted as manifestation_is_deleted,
--     -- m.title_old as manifestation_title_old,
--     -- m.title_old2 as manifestation_title_old2,
--     m.video_hidef as manifestation_video_hidef,
--     m.release_date as manifestation_release_date
-- from
--     episode e
-- left join
--     manifestation m
-- on
--     e.uid = m.episode_uid
  );
[0m02:31:59.610180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "e.title" must appear in the GROUP BY clause or be used in an aggregate function
LINE 20:         'title', e.title,
                          ^

[0m02:31:59.611425 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: ROLLBACK
[0m02:31:59.613134 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 02:31:59.523121 => 02:31:59.612776
[0m02:31:59.614095 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m02:31:59.620129 [debug] [Thread-1 (]: Database Error in model merged_episode (models/merged_episode.sql)
  column "e.title" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         'title', e.title,
                            ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:31:59.621488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8611ac12-f7ab-437d-9544-900bcbb7a606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d37d790>]}
[0m02:31:59.623306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.merged_episode ..................... [[31mERROR[0m in 0.13s]
[0m02:31:59.625391 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m02:31:59.629987 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.631036 [debug] [MainThread]: On master: BEGIN
[0m02:31:59.632053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:31:59.647816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:31:59.648910 [debug] [MainThread]: On master: COMMIT
[0m02:31:59.649915 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:59.651318 [debug] [MainThread]: On master: COMMIT
[0m02:31:59.652619 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:31:59.653805 [debug] [MainThread]: On master: Close
[0m02:31:59.655336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:59.656276 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m02:31:59.657618 [info ] [MainThread]: 
[0m02:31:59.659230 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m02:31:59.661141 [debug] [MainThread]: Command end result
[0m02:31:59.681328 [info ] [MainThread]: 
[0m02:31:59.682998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:31:59.684502 [info ] [MainThread]: 
[0m02:31:59.686149 [error] [MainThread]:   Database Error in model merged_episode (models/merged_episode.sql)
  column "e.title" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         'title', e.title,
                            ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:31:59.687803 [info ] [MainThread]: 
[0m02:31:59.688980 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:31:59.691356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.698624, "process_user_time": 5.34707, "process_kernel_time": 0.244246, "process_mem_max_rss": "117368", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:31:59.692850 [debug] [MainThread]: Command `dbt run` failed at 02:31:59.692644 after 2.70 seconds
[0m02:31:59.693895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d546f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249edbc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249ed8c250>]}
[0m02:31:59.694900 [debug] [MainThread]: Flushing usage events
[0m02:34:49.328763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b18b8d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b17875d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b17291d10>]}


============================== 02:34:49.337446 | 0232ac84-9cac-408d-b8e6-197cec86ba7b ==============================
[0m02:34:49.337446 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:34:49.339073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m02:34:49.565572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b15bd2410>]}
[0m02:34:49.651950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b172ab610>]}
[0m02:34:49.653928 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:34:49.668153 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:34:49.685790 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:34:49.687320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b15ba8690>]}
[0m02:34:51.431548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:34:51.441377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0f97d110>]}
[0m02:34:51.465550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0f746350>]}
[0m02:34:51.466889 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:34:51.468355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b159f1510>]}
[0m02:34:51.472223 [info ] [MainThread]: 
[0m02:34:51.474377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:34:51.477032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m02:34:51.492714 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m02:34:51.493942 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m02:34:51.494916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:51.517717 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:34:51.520242 [debug] [ThreadPool]: On list_dev_db: Close
[0m02:34:51.523350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m02:34:51.532382 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:34:51.533541 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:34:51.534507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:51.551239 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:34:51.552604 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:34:51.553730 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:34:51.562874 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:34:51.565640 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:34:51.567206 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:34:51.575325 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.576385 [debug] [MainThread]: On master: BEGIN
[0m02:34:51.577536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:51.593346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:34:51.594391 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.595698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:34:51.606556 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:34:51.609908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0f8aa550>]}
[0m02:34:51.611072 [debug] [MainThread]: On master: ROLLBACK
[0m02:34:51.612709 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.613773 [debug] [MainThread]: On master: BEGIN
[0m02:34:51.615287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:34:51.616251 [debug] [MainThread]: On master: COMMIT
[0m02:34:51.617611 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.619073 [debug] [MainThread]: On master: COMMIT
[0m02:34:51.620399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:34:51.621622 [debug] [MainThread]: On master: Close
[0m02:34:51.623175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:34:51.624337 [info ] [MainThread]: 
[0m02:34:51.636470 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m02:34:51.637874 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m02:34:51.639638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m02:34:51.640729 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m02:34:51.653967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m02:34:51.657953 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 02:34:51.641665 => 02:34:51.657568
[0m02:34:51.659047 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m02:34:51.710209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m02:34:51.713978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:34:51.715016 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m02:34:51.716082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:51.736538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:34:51.738120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:34:51.739624 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    e.uid,
    jsonb_build_object( -- Aggregate episode metadata into a JSONB object
        'title', e.title,
        'title19', e.title19,
        'titlelong', e.titlelong,
        'episode_number', e.episode_number,
        'distribution_number', e.distribution_number,
        'episodeclass', e.episodeclass,
        'entity_type', e.entity_type,
        'series_uid', e.series_uid,
        'season_uid', e.season_uid,
        'countryoforigin', e.countryoforigin,
        'primarygenre', e.primarygenre,
        'secondarygenre', e.secondarygenre,
        'keyword_mood', e.keyword_mood,
        'keyword_theme', e.keyword_theme,
        'keyword_setting', e.keyword_setting,
        'keyword_characters', e.keyword_characters,
        'keyword_subject', e.keyword_subject,
        'keyword_time_period', e.keyword_time_period,
        'keyword_general', e.keyword_general,
        'approximate_length', e.approximate_length,
        'eidrid', e.eidrid,
        'primary_language', e.primary_language,
        'secondary_language', e.secondary_language,
        'synopsisshort', e.synopsisshort,
        'synopsislong', e.synopsislong,
        'published_status', e.published_status,
        'release_date', e.release_date
    ) as episode,
    jsonb_agg(jsonb_build_object( -- Aggregate manifestation metadata into a JSONB array
        'title', m.title,
        'actual_length', m.actual_length,
        'edit_use', m.edit_use,
        'edit_class', m.edit_class,
        'video_ei', m.video_ei,
        'published_status', m.published_status,
        'video_hidef', m.video_hidef,
        'release_date', m.release_date
    ) FILTER (WHERE m.title IS NOT NULL)) as manifestations -- Each element in the array is a JSONB object that contains the metadata for one manifestation
from
    episode e
left join
    manifestation m
on
    e.uid = m.episode_uid
group by
    e.uid, -- Group by episode uid to ensure one row per episode
    e.title,
    e.title19,
    e.titlelong,
    e.episode_number,
    e.distribution_number,
    e.episodeclass,
    e.entity_type,
    e.series_uid,
    e.season_uid,
    e.countryoforigin,
    e.primarygenre,
    e.secondarygenre,
    e.keyword_mood,
    e.keyword_theme,
    e.keyword_setting,
    e.keyword_characters,
    e.keyword_subject,
    e.keyword_time_period,
    e.keyword_general,
    e.approximate_length,
    e.eidrid,
    e.primary_language,
    e.secondary_language,
    e.synopsisshort,
    e.synopsislong,
    e.published_status,
    e.release_date



-- -- models/merged_episode.sql
-- with manifestation as (
--     select * from "dev_db"."public"."manifestation"
--     where is_deleted = FALSE
-- ),
-- episode as (
--     select * from "dev_db"."public"."episode"
--     where is_deleted = FALSE
-- )

-- select
--     e.*, -- Include all columns from episode
--     m.title as manifestation_title,
--     m.entity_type as manifestation_entity_type,
--     m.eidrid as manifestation_eidrid,
--     -- Exclude m.structuraltype as manifestation_structuraltype,
--     -- Exclue m.referenttype as manifestation_referenttype,
--     m.actual_length as manifestation_actual_length,
--     m.edit_use as manifestation_edit_use,
--     m.edit_class as manifestation_edit_class,
--     -- Exclude m.audio_closedcaption,
--     -- Exclude m.audio_type,
--     -- Exclude m.video_vchip,
--     m.video_ei as manifestation_video_ei,
--     m.published_status as manifestation_published_status,
--     -- m.deletedatetime as manifestation_deletedatetime,
--     -- m.is_deleted as manifestation_is_deleted,
--     -- m.title_old as manifestation_title_old,
--     -- m.title_old2 as manifestation_title_old2,
--     m.video_hidef as manifestation_video_hidef,
--     m.release_date as manifestation_release_date
-- from
--     episode e
-- left join
--     manifestation m
-- on
--     e.uid = m.episode_uid
  );
[0m02:34:51.742750 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FILTER specified, but jsonb_build_object is not an aggregate function
LINE 48:     jsonb_agg(jsonb_build_object( -- Aggregate manifestation...
                       ^

[0m02:34:51.743999 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: ROLLBACK
[0m02:34:51.745907 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 02:34:51.659843 => 02:34:51.745391
[0m02:34:51.746898 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m02:34:51.753125 [debug] [Thread-1 (]: Database Error in model merged_episode (models/merged_episode.sql)
  FILTER specified, but jsonb_build_object is not an aggregate function
  LINE 48:     jsonb_agg(jsonb_build_object( -- Aggregate manifestation...
                         ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:34:51.754964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0232ac84-9cac-408d-b8e6-197cec86ba7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0f72c190>]}
[0m02:34:51.759417 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.merged_episode ..................... [[31mERROR[0m in 0.12s]
[0m02:34:51.765903 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m02:34:51.771293 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.772616 [debug] [MainThread]: On master: BEGIN
[0m02:34:51.773690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:34:51.792232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:34:51.793379 [debug] [MainThread]: On master: COMMIT
[0m02:34:51.794538 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:51.795483 [debug] [MainThread]: On master: COMMIT
[0m02:34:51.796558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:34:51.797408 [debug] [MainThread]: On master: Close
[0m02:34:51.799253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:51.800598 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m02:34:51.801681 [info ] [MainThread]: 
[0m02:34:51.802937 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:34:51.804895 [debug] [MainThread]: Command end result
[0m02:34:51.824640 [info ] [MainThread]: 
[0m02:34:51.826037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:34:51.827180 [info ] [MainThread]: 
[0m02:34:51.828521 [error] [MainThread]:   Database Error in model merged_episode (models/merged_episode.sql)
  FILTER specified, but jsonb_build_object is not an aggregate function
  LINE 48:     jsonb_agg(jsonb_build_object( -- Aggregate manifestation...
                         ^
  compiled Code at target/run/dbt_poc/models/merged_episode.sql
[0m02:34:51.830296 [info ] [MainThread]: 
[0m02:34:51.831973 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:34:51.833963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5724678, "process_user_time": 5.22551, "process_kernel_time": 0.212642, "process_mem_max_rss": "117372", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:34:51.835336 [debug] [MainThread]: Command `dbt run` failed at 02:34:51.835133 after 2.57 seconds
[0m02:34:51.836424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1b3c8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1b3c8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b17275cd0>]}
[0m02:34:51.837595 [debug] [MainThread]: Flushing usage events
[0m02:36:32.702583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c532f2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a3a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c52cd5810>]}


============================== 02:36:32.711684 | 80418a6c-c806-4f16-87a4-c7fa90dd2391 ==============================
[0m02:36:32.711684 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:36:32.713314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt/', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:36:32.948527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c519fad90>]}
[0m02:36:33.037510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a27550>]}
[0m02:36:33.039819 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:36:33.054849 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:36:33.072675 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:36:33.074350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a0da50>]}
[0m02:36:34.870551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:36:34.879916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c50333d50>]}
[0m02:36:34.905574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c50007790>]}
[0m02:36:34.906851 [info ] [MainThread]: Found 1 model, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:36:34.908210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5023ded0>]}
[0m02:36:34.911375 [info ] [MainThread]: 
[0m02:36:34.913896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:36:34.916412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db'
[0m02:36:34.932024 [debug] [ThreadPool]: Using postgres connection "list_dev_db"
[0m02:36:34.933359 [debug] [ThreadPool]: On list_dev_db: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db"} */

    select distinct nspname from pg_namespace
  
[0m02:36:34.934440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:34.955013 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:36:34.957629 [debug] [ThreadPool]: On list_dev_db: Close
[0m02:36:34.960921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_db, now list_dev_db_public)
[0m02:36:34.970069 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:36:34.971183 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:36:34.972141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:34.987616 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:36:34.988896 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:36:34.989960 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:36:34.999201 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:36:35.001762 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:36:35.003118 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:36:35.012430 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.013536 [debug] [MainThread]: On master: BEGIN
[0m02:36:35.014458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:35.031215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:36:35.032377 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.033591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:36:35.044654 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:36:35.047930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c50326410>]}
[0m02:36:35.049320 [debug] [MainThread]: On master: ROLLBACK
[0m02:36:35.050940 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.052199 [debug] [MainThread]: On master: BEGIN
[0m02:36:35.053752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:36:35.054867 [debug] [MainThread]: On master: COMMIT
[0m02:36:35.055907 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.057068 [debug] [MainThread]: On master: COMMIT
[0m02:36:35.058248 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:36:35.059123 [debug] [MainThread]: On master: Close
[0m02:36:35.060659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:36:35.061841 [info ] [MainThread]: 
[0m02:36:35.074307 [debug] [Thread-1 (]: Began running node model.dbt_poc.merged_episode
[0m02:36:35.075917 [info ] [Thread-1 (]: 1 of 1 START sql view model public.merged_episode .............................. [RUN]
[0m02:36:35.078231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now model.dbt_poc.merged_episode)
[0m02:36:35.079416 [debug] [Thread-1 (]: Began compiling node model.dbt_poc.merged_episode
[0m02:36:35.094622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_poc.merged_episode"
[0m02:36:35.099778 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (compile): 02:36:35.080295 => 02:36:35.099083
[0m02:36:35.101172 [debug] [Thread-1 (]: Began executing node model.dbt_poc.merged_episode
[0m02:36:35.156474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_poc.merged_episode"
[0m02:36:35.160486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.161745 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: BEGIN
[0m02:36:35.162697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:35.178631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:36:35.179852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.181245 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */

  create view "dev_db"."public"."merged_episode__dbt_tmp"
    
    
  as (
    -- models/merged_episode.sql
with manifestation as (
    select * from "dev_db"."public"."manifestation"
    where is_deleted = FALSE
),
episode as (
    select * from "dev_db"."public"."episode"
    where is_deleted = FALSE
)

select
    e.uid,
    jsonb_build_object( -- Aggregate episode metadata into a JSONB object
        'title', e.title,
        'title19', e.title19,
        'titlelong', e.titlelong,
        'episode_number', e.episode_number,
        'distribution_number', e.distribution_number,
        'episodeclass', e.episodeclass,
        'entity_type', e.entity_type,
        'series_uid', e.series_uid,
        'season_uid', e.season_uid,
        'countryoforigin', e.countryoforigin,
        'primarygenre', e.primarygenre,
        'secondarygenre', e.secondarygenre,
        'keyword_mood', e.keyword_mood,
        'keyword_theme', e.keyword_theme,
        'keyword_setting', e.keyword_setting,
        'keyword_characters', e.keyword_characters,
        'keyword_subject', e.keyword_subject,
        'keyword_time_period', e.keyword_time_period,
        'keyword_general', e.keyword_general,
        'approximate_length', e.approximate_length,
        'eidrid', e.eidrid,
        'primary_language', e.primary_language,
        'secondary_language', e.secondary_language,
        'synopsisshort', e.synopsisshort,
        'synopsislong', e.synopsislong,
        'published_status', e.published_status,
        'release_date', e.release_date
    ) as episode,
    (select jsonb_agg(jsonb_build_object( -- Aggregate manifestation metadata into a JSONB array
        'title', m.title,
        'actual_length', m.actual_length,
        'edit_use', m.edit_use,
        'edit_class', m.edit_class,
        'video_ei', m.video_ei,
        'published_status', m.published_status,
        'video_hidef', m.video_hidef,
        'release_date', m.release_date
    )) from manifestation m where m.episode_uid = e.uid and m.title is not null) as manifestations -- Each element in the array is a JSONB object that contains the metadata for one manifestation
from
    episode e
group by
    e.uid, -- Group by episode uid to ensure one row per episode
    e.title,
    e.title19,
    e.titlelong,
    e.episode_number,
    e.distribution_number,
    e.episodeclass,
    e.entity_type,
    e.series_uid,
    e.season_uid,
    e.countryoforigin,
    e.primarygenre,
    e.secondarygenre,
    e.keyword_mood,
    e.keyword_theme,
    e.keyword_setting,
    e.keyword_characters,
    e.keyword_subject,
    e.keyword_time_period,
    e.keyword_general,
    e.approximate_length,
    e.eidrid,
    e.primary_language,
    e.secondary_language,
    e.synopsisshort,
    e.synopsislong,
    e.published_status,
    e.release_date



-- -- models/merged_episode.sql
-- with manifestation as (
--     select * from "dev_db"."public"."manifestation"
--     where is_deleted = FALSE
-- ),
-- episode as (
--     select * from "dev_db"."public"."episode"
--     where is_deleted = FALSE
-- )

-- select
--     e.*, -- Include all columns from episode
--     m.title as manifestation_title,
--     m.entity_type as manifestation_entity_type,
--     m.eidrid as manifestation_eidrid,
--     -- Exclude m.structuraltype as manifestation_structuraltype,
--     -- Exclue m.referenttype as manifestation_referenttype,
--     m.actual_length as manifestation_actual_length,
--     m.edit_use as manifestation_edit_use,
--     m.edit_class as manifestation_edit_class,
--     -- Exclude m.audio_closedcaption,
--     -- Exclude m.audio_type,
--     -- Exclude m.video_vchip,
--     m.video_ei as manifestation_video_ei,
--     m.published_status as manifestation_published_status,
--     -- m.deletedatetime as manifestation_deletedatetime,
--     -- m.is_deleted as manifestation_is_deleted,
--     -- m.title_old as manifestation_title_old,
--     -- m.title_old2 as manifestation_title_old2,
--     m.video_hidef as manifestation_video_hidef,
--     m.release_date as manifestation_release_date
-- from
--     episode e
-- left join
--     manifestation m
-- on
--     e.uid = m.episode_uid
  );
[0m02:36:35.200578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:36:35.212091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.213378 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */
alter table "dev_db"."public"."merged_episode" rename to "merged_episode__dbt_backup"
[0m02:36:35.215504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:36:35.220469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.221511 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */
alter table "dev_db"."public"."merged_episode__dbt_tmp" rename to "merged_episode"
[0m02:36:35.223522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:36:35.249582 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: COMMIT
[0m02:36:35.251248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.252486 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: COMMIT
[0m02:36:35.255734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:36:35.266620 [debug] [Thread-1 (]: Applying DROP to: "dev_db"."public"."merged_episode__dbt_backup"
[0m02:36:35.275633 [debug] [Thread-1 (]: Using postgres connection "model.dbt_poc.merged_episode"
[0m02:36:35.276983 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "model.dbt_poc.merged_episode"} */
drop view if exists "dev_db"."public"."merged_episode__dbt_backup" cascade
[0m02:36:35.283390 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:36:35.286195 [debug] [Thread-1 (]: Timing info for model.dbt_poc.merged_episode (execute): 02:36:35.102124 => 02:36:35.285804
[0m02:36:35.287229 [debug] [Thread-1 (]: On model.dbt_poc.merged_episode: Close
[0m02:36:35.288877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80418a6c-c806-4f16-87a4-c7fa90dd2391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c50065950>]}
[0m02:36:35.290297 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.merged_episode ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m02:36:35.292255 [debug] [Thread-1 (]: Finished running node model.dbt_poc.merged_episode
[0m02:36:35.295908 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.296937 [debug] [MainThread]: On master: BEGIN
[0m02:36:35.297944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:35.314225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:36:35.315670 [debug] [MainThread]: On master: COMMIT
[0m02:36:35.316766 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:35.317778 [debug] [MainThread]: On master: COMMIT
[0m02:36:35.318886 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:36:35.319961 [debug] [MainThread]: On master: Close
[0m02:36:35.321575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:35.322507 [debug] [MainThread]: Connection 'model.dbt_poc.merged_episode' was properly closed.
[0m02:36:35.323637 [info ] [MainThread]: 
[0m02:36:35.324888 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:36:35.326796 [debug] [MainThread]: Command end result
[0m02:36:35.344494 [info ] [MainThread]: 
[0m02:36:35.345699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:35.346827 [info ] [MainThread]: 
[0m02:36:35.348132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:36:35.350227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.716077, "process_user_time": 5.505181, "process_kernel_time": 0.263028, "process_mem_max_rss": "116240", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m02:36:35.351765 [debug] [MainThread]: Command `dbt run` succeeded at 02:36:35.351555 after 2.72 seconds
[0m02:36:35.352799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c559eb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c55ab43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c55b44b90>]}
[0m02:36:35.353861 [debug] [MainThread]: Flushing usage events
[0m02:47:37.300850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d979650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de3c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d9c27d0>]}


============================== 02:47:37.312413 | 620aa082-f4ed-44d8-93ef-16786077ed13 ==============================
[0m02:47:37.312413 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:47:37.314533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m02:47:37.581704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4d9c2b50>]}
[0m02:47:37.682834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4c0b0890>]}
[0m02:47:37.684529 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:47:37.707001 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:47:37.724583 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:47:37.725934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4c087410>]}
[0m02:47:39.346946 [warn ] [MainThread]: [[33mWARNING[0m]: 'episode' is a seed node, but it is specified in the models section of
models/schema.yml. To fix this error, place the `episode` specification under
the seeds key instead.
[0m02:47:39.351225 [warn ] [MainThread]: [[33mWARNING[0m]: 'manifestation' is a seed node, but it is specified in the models section of
models/schema.yml. To fix this error, place the `manifestation` specification
under the seeds key instead.
[0m02:47:39.516192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:47:39.524399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4a03a310>]}
[0m02:47:39.550872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4dab5210>]}
[0m02:47:39.552134 [info ] [MainThread]: Found 1 model, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:47:39.553573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4c00fe50>]}
[0m02:47:39.557271 [info ] [MainThread]: 
[0m02:47:39.560369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:47:39.563179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m02:47:39.579848 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:47:39.581107 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:47:39.582244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:39.602924 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.604518 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:47:39.606167 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:47:39.617869 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:47:39.620611 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:47:39.622445 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:47:39.631198 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.632308 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.633149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:39.650111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.651202 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.652426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:39.663886 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:47:39.667712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620aa082-f4ed-44d8-93ef-16786077ed13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb509d1250>]}
[0m02:47:39.668992 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:39.670280 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.671122 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.672595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.673643 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.674796 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.675853 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.677047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.677983 [debug] [MainThread]: On master: Close
[0m02:47:39.679493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:39.681022 [info ] [MainThread]: 
[0m02:47:39.695168 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m02:47:39.696434 [info ] [Thread-1 (]: 1 of 4 START test merged_episode_test .......................................... [RUN]
[0m02:47:39.698397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m02:47:39.699945 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m02:47:39.718325 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m02:47:39.722880 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 02:47:39.700840 => 02:47:39.722319
[0m02:47:39.724046 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m02:47:39.748853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m02:47:39.752738 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:47:39.753841 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m02:47:39.754866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:39.771353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.772541 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:47:39.773628 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column


-- Test for non-null values in manifestation_eidrid column


-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m02:47:39.775497 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m02:47:39.776837 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m02:47:39.778432 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 02:47:39.724811 => 02:47:39.778089
[0m02:47:39.779490 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m02:47:39.785305 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:47:39.786672 [error] [Thread-1 (]: 1 of 4 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m02:47:39.788466 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m02:47:39.789826 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:47:39.791891 [info ] [Thread-1 (]: 2 of 4 START test not_null_episode_uid ......................................... [RUN]
[0m02:47:39.793612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_episode_uid.d5bebe17b7)
[0m02:47:39.795096 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:47:39.806189 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:47:39.810407 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (compile): 02:47:39.795992 => 02:47:39.809737
[0m02:47:39.811572 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:47:39.816553 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:47:39.820019 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:47:39.821166 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: BEGIN
[0m02:47:39.822419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:39.838798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.840100 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:47:39.841238 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_episode_uid.d5bebe17b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select uid
from "dev_db"."public"."episode"
where uid is null



      
    ) dbt_internal_test
[0m02:47:39.844178 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:47:39.847834 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (execute): 02:47:39.812943 => 02:47:39.847425
[0m02:47:39.848925 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: ROLLBACK
[0m02:47:39.850582 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: Close
[0m02:47:39.852518 [info ] [Thread-1 (]: 2 of 4 PASS not_null_episode_uid ............................................... [[32mPASS[0m in 0.06s]
[0m02:47:39.855083 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:47:39.856593 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:47:39.857914 [info ] [Thread-1 (]: 3 of 4 START test relationships_manifestation_episode_uid__uid__ref_episode_ ... [RUN]
[0m02:47:39.859730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_episode_uid.d5bebe17b7, now test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8)
[0m02:47:39.861018 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:47:39.871303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:47:39.874278 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (compile): 02:47:39.861899 => 02:47:39.873905
[0m02:47:39.875377 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:47:39.879474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:47:39.882622 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:47:39.883746 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: BEGIN
[0m02:47:39.884942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:39.902424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.903853 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:47:39.904894 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select episode_uid as from_field
    from "dev_db"."public"."manifestation"
    where episode_uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:47:39.908408 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:47:39.911460 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (execute): 02:47:39.876296 => 02:47:39.911099
[0m02:47:39.912770 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: ROLLBACK
[0m02:47:39.914180 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: Close
[0m02:47:39.916278 [info ] [Thread-1 (]: 3 of 4 PASS relationships_manifestation_episode_uid__uid__ref_episode_ ......... [[32mPASS[0m in 0.06s]
[0m02:47:39.918123 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:47:39.919391 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:47:39.920665 [info ] [Thread-1 (]: 4 of 4 START test unique_episode_uid ........................................... [RUN]
[0m02:47:39.922811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8, now test.dbt_poc.unique_episode_uid.bdfdb33d42)
[0m02:47:39.923757 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:47:39.933523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:47:39.937185 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (compile): 02:47:39.924698 => 02:47:39.936641
[0m02:47:39.938346 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:47:39.942782 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:47:39.945911 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:47:39.947405 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: BEGIN
[0m02:47:39.948894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:39.967318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.968647 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:47:39.969861 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_episode_uid.bdfdb33d42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m02:47:39.972578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:47:39.975547 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (execute): 02:47:39.939257 => 02:47:39.975211
[0m02:47:39.976855 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: ROLLBACK
[0m02:47:39.978070 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: Close
[0m02:47:39.979871 [error] [Thread-1 (]: 4 of 4 FAIL 5 unique_episode_uid ............................................... [[31mFAIL 5[0m in 0.06s]
[0m02:47:39.983164 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:47:39.987256 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.988307 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.989395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:40.007331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:40.009133 [debug] [MainThread]: On master: COMMIT
[0m02:47:40.010358 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:40.011528 [debug] [MainThread]: On master: COMMIT
[0m02:47:40.013871 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:40.015261 [debug] [MainThread]: On master: Close
[0m02:47:40.017272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:40.018530 [debug] [MainThread]: Connection 'test.dbt_poc.unique_episode_uid.bdfdb33d42' was properly closed.
[0m02:47:40.019602 [info ] [MainThread]: 
[0m02:47:40.020978 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m02:47:40.023552 [debug] [MainThread]: Command end result
[0m02:47:40.041032 [info ] [MainThread]: 
[0m02:47:40.042358 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:47:40.043751 [info ] [MainThread]: 
[0m02:47:40.045147 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:47:40.046874 [info ] [MainThread]: 
[0m02:47:40.048574 [error] [MainThread]: [31mFailure in test unique_episode_uid (models/schema.yml)[0m
[0m02:47:40.049945 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m02:47:40.051328 [info ] [MainThread]: 
[0m02:47:40.052540 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_episode_uid.sql
[0m02:47:40.053949 [info ] [MainThread]: 
[0m02:47:40.055211 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m02:47:40.057916 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.8492742, "process_user_time": 5.643108, "process_kernel_time": 0.25094, "process_mem_max_rss": "114936", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:47:40.059422 [debug] [MainThread]: Command `dbt test` failed at 02:47:40.059188 after 2.85 seconds
[0m02:47:40.060590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb51ac5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb517cc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de3c650>]}
[0m02:47:40.061907 [debug] [MainThread]: Flushing usage events
[0m02:49:56.098471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb6f639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb6f63ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb73c1610>]}


============================== 02:49:56.106664 | 0efae3c9-8cd3-4210-9384-1cca675e770c ==============================
[0m02:49:56.106664 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:49:56.108376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:49:56.329322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb60fb7d0>]}
[0m02:49:56.423895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb6113750>]}
[0m02:49:56.425881 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:49:56.440502 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:49:56.496164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:56.502386 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m02:49:56.682655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:49:56.692573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb46f7f10>]}
[0m02:49:56.744317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb46f4590>]}
[0m02:49:56.745837 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:49:56.747478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb60daa10>]}
[0m02:49:56.751179 [info ] [MainThread]: 
[0m02:49:56.753468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:49:56.756784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m02:49:56.777688 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:49:56.778802 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:49:56.779889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:56.800907 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:49:56.802240 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:49:56.803671 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:49:56.813832 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:49:56.817271 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:49:56.818932 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:49:56.827115 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.828136 [debug] [MainThread]: On master: BEGIN
[0m02:49:56.829155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:56.846296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:56.847454 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.848603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:56.859971 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:49:56.863986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0efae3c9-8cd3-4210-9384-1cca675e770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb6154f90>]}
[0m02:49:56.865381 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:56.866873 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.868142 [debug] [MainThread]: On master: BEGIN
[0m02:49:56.869911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:56.870879 [debug] [MainThread]: On master: COMMIT
[0m02:49:56.872112 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.873075 [debug] [MainThread]: On master: COMMIT
[0m02:49:56.874156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:56.875189 [debug] [MainThread]: On master: Close
[0m02:49:56.876744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:56.877829 [info ] [MainThread]: 
[0m02:49:56.890470 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m02:49:56.891975 [info ] [Thread-1 (]: 1 of 4 START test merged_episode_test .......................................... [RUN]
[0m02:49:56.894429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m02:49:56.895666 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m02:49:56.915064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m02:49:56.920084 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 02:49:56.896738 => 02:49:56.919224
[0m02:49:56.921613 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m02:49:56.948171 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m02:49:56.952646 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:49:56.954145 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m02:49:56.955323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:56.973365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:49:56.974730 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:49:56.976367 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m02:49:56.978360 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m02:49:56.979484 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m02:49:56.981336 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 02:49:56.922537 => 02:49:56.980915
[0m02:49:56.982556 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m02:49:56.989959 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:49:56.991741 [error] [Thread-1 (]: 1 of 4 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.10s]
[0m02:49:56.993950 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m02:49:56.995372 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:49:56.997796 [info ] [Thread-1 (]: 2 of 4 START test not_null_episode_uid ......................................... [RUN]
[0m02:49:57.000066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_episode_uid.d5bebe17b7)
[0m02:49:57.001492 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:49:57.020715 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:49:57.024392 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (compile): 02:49:57.002641 => 02:49:57.024024
[0m02:49:57.025416 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:49:57.029570 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:49:57.032503 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:49:57.033682 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: BEGIN
[0m02:49:57.034824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:57.053251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:49:57.054887 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:49:57.056357 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_episode_uid.d5bebe17b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select uid
from "dev_db"."public"."episode"
where uid is null



      
    ) dbt_internal_test
[0m02:49:57.060398 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:57.079804 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (execute): 02:49:57.026352 => 02:49:57.079409
[0m02:49:57.081119 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: ROLLBACK
[0m02:49:57.082621 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: Close
[0m02:49:57.084566 [info ] [Thread-1 (]: 2 of 4 PASS not_null_episode_uid ............................................... [[32mPASS[0m in 0.09s]
[0m02:49:57.086333 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:49:57.088103 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:49:57.089717 [info ] [Thread-1 (]: 3 of 4 START test relationships_manifestation_episode_uid__uid__ref_episode_ ... [RUN]
[0m02:49:57.092388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_episode_uid.d5bebe17b7, now test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8)
[0m02:49:57.093985 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:49:57.110476 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:49:57.114454 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (compile): 02:49:57.095250 => 02:49:57.114038
[0m02:49:57.115865 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:49:57.120746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:49:57.123788 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:49:57.124801 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: BEGIN
[0m02:49:57.125904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:57.142209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:49:57.143451 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:49:57.144731 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select episode_uid as from_field
    from "dev_db"."public"."manifestation"
    where episode_uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:49:57.148200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:57.150841 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (execute): 02:49:57.116918 => 02:49:57.150485
[0m02:49:57.151851 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: ROLLBACK
[0m02:49:57.153179 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: Close
[0m02:49:57.154958 [info ] [Thread-1 (]: 3 of 4 PASS relationships_manifestation_episode_uid__uid__ref_episode_ ......... [[32mPASS[0m in 0.06s]
[0m02:49:57.156554 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:49:57.158095 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:49:57.159427 [info ] [Thread-1 (]: 4 of 4 START test unique_episode_uid ........................................... [RUN]
[0m02:49:57.161782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8, now test.dbt_poc.unique_episode_uid.bdfdb33d42)
[0m02:49:57.163361 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:49:57.175540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:49:57.179267 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (compile): 02:49:57.164558 => 02:49:57.178749
[0m02:49:57.180502 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:49:57.184585 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:49:57.188086 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:49:57.189300 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: BEGIN
[0m02:49:57.190656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:57.208611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:49:57.209978 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:49:57.211364 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_episode_uid.bdfdb33d42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m02:49:57.214961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:57.218029 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (execute): 02:49:57.181306 => 02:49:57.217674
[0m02:49:57.219253 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: ROLLBACK
[0m02:49:57.220606 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: Close
[0m02:49:57.222430 [error] [Thread-1 (]: 4 of 4 FAIL 5 unique_episode_uid ............................................... [[31mFAIL 5[0m in 0.06s]
[0m02:49:57.224285 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:49:57.227762 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:57.228769 [debug] [MainThread]: On master: BEGIN
[0m02:49:57.229693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:57.245858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:57.247074 [debug] [MainThread]: On master: COMMIT
[0m02:49:57.247967 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:57.249466 [debug] [MainThread]: On master: COMMIT
[0m02:49:57.251249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:57.252557 [debug] [MainThread]: On master: Close
[0m02:49:57.254506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:57.255662 [debug] [MainThread]: Connection 'test.dbt_poc.unique_episode_uid.bdfdb33d42' was properly closed.
[0m02:49:57.256847 [info ] [MainThread]: 
[0m02:49:57.258510 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m02:49:57.261355 [debug] [MainThread]: Command end result
[0m02:49:57.282447 [info ] [MainThread]: 
[0m02:49:57.284384 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:49:57.285814 [info ] [MainThread]: 
[0m02:49:57.288473 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:49:57.289947 [info ] [MainThread]: 
[0m02:49:57.291398 [error] [MainThread]: [31mFailure in test unique_episode_uid (models/schema.yml)[0m
[0m02:49:57.293347 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m02:49:57.295160 [info ] [MainThread]: 
[0m02:49:57.296788 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_episode_uid.sql
[0m02:49:57.298484 [info ] [MainThread]: 
[0m02:49:57.300143 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m02:49:57.302664 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2744589, "process_user_time": 3.88385, "process_kernel_time": 0.251818, "process_mem_max_rss": "109400", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:49:57.304656 [debug] [MainThread]: Command `dbt test` failed at 02:49:57.304368 after 1.28 seconds
[0m02:49:57.306419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb61272d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb73c1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeba230250>]}
[0m02:49:57.307953 [debug] [MainThread]: Flushing usage events
[0m02:53:14.787132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a823c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a88a6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a8700790>]}


============================== 02:53:14.798555 | b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2 ==============================
[0m02:53:14.798555 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:53:14.800700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m02:53:15.108490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6996210>]}
[0m02:53:15.198155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a698b0d0>]}
[0m02:53:15.200019 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:53:15.215868 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:53:15.282998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:15.284573 [debug] [MainThread]: Partial parsing: updated file: dbt_poc://tests/merged_episode_test.sql
[0m02:53:15.445007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.episode
- seeds.dbt-poc.manifestation
[0m02:53:15.453011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6a65450>]}
[0m02:53:15.479500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6a2a910>]}
[0m02:53:15.481100 [info ] [MainThread]: Found 1 model, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:53:15.482481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6818c90>]}
[0m02:53:15.485977 [info ] [MainThread]: 
[0m02:53:15.488045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:15.490875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m02:53:15.507100 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:53:15.508522 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:53:15.509432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:15.528831 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.529941 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:53:15.530954 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:53:15.539945 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:53:15.542422 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:53:15.543576 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:53:15.551623 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:15.552626 [debug] [MainThread]: On master: BEGIN
[0m02:53:15.553556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:15.570026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.571409 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:15.572661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:15.584288 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:53:15.588582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f8fbba-13dc-4aa9-a6fc-82c102ce9cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a68f9250>]}
[0m02:53:15.589780 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:15.591129 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:15.592065 [debug] [MainThread]: On master: BEGIN
[0m02:53:15.593770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.594678 [debug] [MainThread]: On master: COMMIT
[0m02:53:15.595513 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:15.596362 [debug] [MainThread]: On master: COMMIT
[0m02:53:15.597417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:15.598230 [debug] [MainThread]: On master: Close
[0m02:53:15.599833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:15.601028 [info ] [MainThread]: 
[0m02:53:15.613657 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m02:53:15.614797 [info ] [Thread-1 (]: 1 of 4 START test merged_episode_test .......................................... [RUN]
[0m02:53:15.616529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m02:53:15.618040 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m02:53:15.636117 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m02:53:15.640722 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 02:53:15.619000 => 02:53:15.640296
[0m02:53:15.641830 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m02:53:15.666952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m02:53:15.670551 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:53:15.671515 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m02:53:15.672444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:15.688596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.689842 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:53:15.690880 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m02:53:15.692382 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m02:53:15.693543 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m02:53:15.694942 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 02:53:15.642944 => 02:53:15.694624
[0m02:53:15.696007 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m02:53:15.701804 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:53:15.703107 [error] [Thread-1 (]: 1 of 4 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m02:53:15.704807 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m02:53:15.706017 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:53:15.707878 [info ] [Thread-1 (]: 2 of 4 START test not_null_episode_uid ......................................... [RUN]
[0m02:53:15.709824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_episode_uid.d5bebe17b7)
[0m02:53:15.710795 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:53:15.726657 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:53:15.730071 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (compile): 02:53:15.711617 => 02:53:15.729708
[0m02:53:15.731074 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:53:15.735432 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:53:15.738801 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:53:15.739994 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: BEGIN
[0m02:53:15.741824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:15.757942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.759083 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_episode_uid.d5bebe17b7"
[0m02:53:15.760210 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_episode_uid.d5bebe17b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select uid
from "dev_db"."public"."episode"
where uid is null



      
    ) dbt_internal_test
[0m02:53:15.762897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:53:15.766271 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_episode_uid.d5bebe17b7 (execute): 02:53:15.731954 => 02:53:15.765938
[0m02:53:15.767291 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: ROLLBACK
[0m02:53:15.768674 [debug] [Thread-1 (]: On test.dbt_poc.not_null_episode_uid.d5bebe17b7: Close
[0m02:53:15.770546 [info ] [Thread-1 (]: 2 of 4 PASS not_null_episode_uid ............................................... [[32mPASS[0m in 0.06s]
[0m02:53:15.772106 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_episode_uid.d5bebe17b7
[0m02:53:15.773280 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:53:15.774515 [info ] [Thread-1 (]: 3 of 4 START test relationships_manifestation_episode_uid__uid__ref_episode_ ... [RUN]
[0m02:53:15.776157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_episode_uid.d5bebe17b7, now test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8)
[0m02:53:15.777511 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:53:15.789640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:53:15.793005 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (compile): 02:53:15.778283 => 02:53:15.792606
[0m02:53:15.794099 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:53:15.798445 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:53:15.800973 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:53:15.801961 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: BEGIN
[0m02:53:15.803109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:15.820008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.821253 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:53:15.822445 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select episode_uid as from_field
    from "dev_db"."public"."manifestation"
    where episode_uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:53:15.825925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:53:15.828717 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (execute): 02:53:15.794936 => 02:53:15.828269
[0m02:53:15.829801 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: ROLLBACK
[0m02:53:15.831009 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: Close
[0m02:53:15.832733 [info ] [Thread-1 (]: 3 of 4 PASS relationships_manifestation_episode_uid__uid__ref_episode_ ......... [[32mPASS[0m in 0.06s]
[0m02:53:15.834648 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:53:15.835824 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:53:15.836940 [info ] [Thread-1 (]: 4 of 4 START test unique_episode_uid ........................................... [RUN]
[0m02:53:15.838902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8, now test.dbt_poc.unique_episode_uid.bdfdb33d42)
[0m02:53:15.840015 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:53:15.853255 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:53:15.859648 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (compile): 02:53:15.840988 => 02:53:15.858889
[0m02:53:15.861525 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:53:15.868867 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:53:15.874727 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:53:15.876867 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: BEGIN
[0m02:53:15.878818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:15.918913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:53:15.923137 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_episode_uid.bdfdb33d42"
[0m02:53:15.928233 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_episode_uid.bdfdb33d42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m02:53:15.942048 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:53:15.950227 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_episode_uid.bdfdb33d42 (execute): 02:53:15.863153 => 02:53:15.948916
[0m02:53:15.952708 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: ROLLBACK
[0m02:53:15.956808 [debug] [Thread-1 (]: On test.dbt_poc.unique_episode_uid.bdfdb33d42: Close
[0m02:53:15.960863 [error] [Thread-1 (]: 4 of 4 FAIL 5 unique_episode_uid ............................................... [[31mFAIL 5[0m in 0.12s]
[0m02:53:15.964738 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_episode_uid.bdfdb33d42
[0m02:53:15.971228 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:15.972662 [debug] [MainThread]: On master: BEGIN
[0m02:53:15.973851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:15.998425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:16.000067 [debug] [MainThread]: On master: COMMIT
[0m02:53:16.002118 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:16.003947 [debug] [MainThread]: On master: COMMIT
[0m02:53:16.009688 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:16.012519 [debug] [MainThread]: On master: Close
[0m02:53:16.015153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:16.018033 [debug] [MainThread]: Connection 'test.dbt_poc.unique_episode_uid.bdfdb33d42' was properly closed.
[0m02:53:16.038115 [info ] [MainThread]: 
[0m02:53:16.040529 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m02:53:16.044207 [debug] [MainThread]: Command end result
[0m02:53:16.083756 [info ] [MainThread]: 
[0m02:53:16.085371 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:53:16.086949 [info ] [MainThread]: 
[0m02:53:16.088833 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:53:16.090595 [info ] [MainThread]: 
[0m02:53:16.092160 [error] [MainThread]: [31mFailure in test unique_episode_uid (models/schema.yml)[0m
[0m02:53:16.093983 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m02:53:16.095424 [info ] [MainThread]: 
[0m02:53:16.096596 [info ] [MainThread]:   compiled Code at target/compiled/dbt_poc/models/schema.yml/unique_episode_uid.sql
[0m02:53:16.097824 [info ] [MainThread]: 
[0m02:53:16.098916 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m02:53:16.100992 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.4109228, "process_user_time": 3.872849, "process_kernel_time": 0.259489, "process_mem_max_rss": "109256", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:53:16.102872 [debug] [MainThread]: Command `dbt test` failed at 02:53:16.102565 after 1.41 seconds
[0m02:53:16.104709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a827ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a69d7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a9719690>]}
[0m02:53:16.107193 [debug] [MainThread]: Flushing usage events
[0m02:56:17.696830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7d50d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7c0562d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7c5897d0>]}


============================== 02:56:17.706234 | c07a16c7-7207-46c1-ac63-dbd0e7db7bc5 ==============================
[0m02:56:17.706234 [info ] [MainThread]: Running with dbt=1.7.14
[0m02:56:17.707912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/app/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:56:17.945317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7d902bd0>]}
[0m02:56:18.035140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7a948b90>]}
[0m02:56:18.037064 [info ] [MainThread]: Registered adapter: postgres=1.7.14
[0m02:56:18.053096 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m02:56:18.069549 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:56:18.071581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7a723310>]}
[0m02:56:19.676728 [warn ] [MainThread]: [[33mWARNING[0m]: 'manifestation' is a seed node, but it is specified in the models section of
models/schema.yml. To fix this error, place the `manifestation` specification
under the seeds key instead.
[0m02:56:19.842860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt-poc
- seeds.dbt-poc.manifestation
- seeds.dbt-poc.episode
[0m02:56:19.850941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c787335d0>]}
[0m02:56:19.876240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7a785c10>]}
[0m02:56:19.877654 [info ] [MainThread]: Found 1 model, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:56:19.879107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c786755d0>]}
[0m02:56:19.882643 [info ] [MainThread]: 
[0m02:56:19.884491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:19.887520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_db_public'
[0m02:56:19.903476 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:56:19.904756 [debug] [ThreadPool]: On list_dev_db_public: BEGIN
[0m02:56:19.905785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:19.924953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:56:19.926039 [debug] [ThreadPool]: Using postgres connection "list_dev_db_public"
[0m02:56:19.927184 [debug] [ThreadPool]: On list_dev_db_public: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "list_dev_db_public"} */
select
      'dev_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dev_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:56:19.936877 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:56:19.939488 [debug] [ThreadPool]: On list_dev_db_public: ROLLBACK
[0m02:56:19.940956 [debug] [ThreadPool]: On list_dev_db_public: Close
[0m02:56:19.948988 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:19.950002 [debug] [MainThread]: On master: BEGIN
[0m02:56:19.950988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:19.967558 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:19.968791 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:19.969938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:19.982467 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m02:56:19.986031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07a16c7-7207-46c1-ac63-dbd0e7db7bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7a900f50>]}
[0m02:56:19.987338 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:19.988614 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:19.989809 [debug] [MainThread]: On master: BEGIN
[0m02:56:19.991358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:19.992444 [debug] [MainThread]: On master: COMMIT
[0m02:56:19.993416 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:19.994491 [debug] [MainThread]: On master: COMMIT
[0m02:56:19.995647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:19.996682 [debug] [MainThread]: On master: Close
[0m02:56:19.998211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:19.999420 [info ] [MainThread]: 
[0m02:56:20.011804 [debug] [Thread-1 (]: Began running node test.dbt_poc.merged_episode_test
[0m02:56:20.013121 [info ] [Thread-1 (]: 1 of 4 START test merged_episode_test .......................................... [RUN]
[0m02:56:20.015125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_db_public, now test.dbt_poc.merged_episode_test)
[0m02:56:20.016358 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.merged_episode_test
[0m02:56:20.035126 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.merged_episode_test"
[0m02:56:20.039184 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (compile): 02:56:20.017481 => 02:56:20.038743
[0m02:56:20.040746 [debug] [Thread-1 (]: Began executing node test.dbt_poc.merged_episode_test
[0m02:56:20.065119 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.merged_episode_test"
[0m02:56:20.068506 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:56:20.069584 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: BEGIN
[0m02:56:20.070741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:20.087199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:20.088429 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.merged_episode_test"
[0m02:56:20.089597 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.merged_episode_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/merged_episode_test.sql https://docs.getdbt.com/docs/build/unit-tests
-- tests/merged_episode_test.sql

-- -- Test for unique combination of episode_id and manifestation_eidrid
-- 

-- Test for non-null values in episode_id column
-- 

-- -- Test for non-null values in manifestation_eidrid column
-- 

-- -- Test for referential integrity with manifestation table
-- 
-- 

-- Test for referential integrity with episode table
-- 
-- 


-- tests/test_uid_match.sql
-- 
-- 
      
    ) dbt_internal_test
[0m02:56:20.091495 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:     ) dbt_internal_test
             ^

[0m02:56:20.092528 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: ROLLBACK
[0m02:56:20.094105 [debug] [Thread-1 (]: Timing info for test.dbt_poc.merged_episode_test (execute): 02:56:20.041684 => 02:56:20.093772
[0m02:56:20.095081 [debug] [Thread-1 (]: On test.dbt_poc.merged_episode_test: Close
[0m02:56:20.101211 [debug] [Thread-1 (]: Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:56:20.102807 [error] [Thread-1 (]: 1 of 4 ERROR merged_episode_test ............................................... [[31mERROR[0m in 0.09s]
[0m02:56:20.104519 [debug] [Thread-1 (]: Finished running node test.dbt_poc.merged_episode_test
[0m02:56:20.106159 [debug] [Thread-1 (]: Began running node test.dbt_poc.not_null_merged_episode_uid.ac13b67476
[0m02:56:20.108486 [info ] [Thread-1 (]: 2 of 4 START test not_null_merged_episode_uid .................................. [RUN]
[0m02:56:20.110781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.merged_episode_test, now test.dbt_poc.not_null_merged_episode_uid.ac13b67476)
[0m02:56:20.111918 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.not_null_merged_episode_uid.ac13b67476
[0m02:56:20.124032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.not_null_merged_episode_uid.ac13b67476"
[0m02:56:20.127866 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_uid.ac13b67476 (compile): 02:56:20.113031 => 02:56:20.127354
[0m02:56:20.128961 [debug] [Thread-1 (]: Began executing node test.dbt_poc.not_null_merged_episode_uid.ac13b67476
[0m02:56:20.132912 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.not_null_merged_episode_uid.ac13b67476"
[0m02:56:20.136054 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_uid.ac13b67476"
[0m02:56:20.137295 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_uid.ac13b67476: BEGIN
[0m02:56:20.138429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:20.155206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:20.156353 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.not_null_merged_episode_uid.ac13b67476"
[0m02:56:20.157477 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_uid.ac13b67476: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.not_null_merged_episode_uid.ac13b67476"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select uid
from "dev_db"."public"."merged_episode"
where uid is null



      
    ) dbt_internal_test
[0m02:56:20.162001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:20.165588 [debug] [Thread-1 (]: Timing info for test.dbt_poc.not_null_merged_episode_uid.ac13b67476 (execute): 02:56:20.129685 => 02:56:20.165208
[0m02:56:20.166919 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_uid.ac13b67476: ROLLBACK
[0m02:56:20.168445 [debug] [Thread-1 (]: On test.dbt_poc.not_null_merged_episode_uid.ac13b67476: Close
[0m02:56:20.170614 [info ] [Thread-1 (]: 2 of 4 PASS not_null_merged_episode_uid ........................................ [[32mPASS[0m in 0.06s]
[0m02:56:20.172996 [debug] [Thread-1 (]: Finished running node test.dbt_poc.not_null_merged_episode_uid.ac13b67476
[0m02:56:20.174902 [debug] [Thread-1 (]: Began running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:56:20.176194 [info ] [Thread-1 (]: 3 of 4 START test relationships_manifestation_episode_uid__uid__ref_episode_ ... [RUN]
[0m02:56:20.178391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.not_null_merged_episode_uid.ac13b67476, now test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8)
[0m02:56:20.180037 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:56:20.193068 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:56:20.197516 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (compile): 02:56:20.181160 => 02:56:20.197099
[0m02:56:20.198880 [debug] [Thread-1 (]: Began executing node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:56:20.204201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:56:20.212804 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:56:20.214132 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: BEGIN
[0m02:56:20.215293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:20.237493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:20.238891 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"
[0m02:56:20.240050 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select episode_uid as from_field
    from "dev_db"."public"."manifestation"
    where episode_uid is not null
),

parent as (
    select uid as to_field
    from "dev_db"."public"."episode"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:56:20.243335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:20.246420 [debug] [Thread-1 (]: Timing info for test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8 (execute): 02:56:20.200363 => 02:56:20.246077
[0m02:56:20.247465 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: ROLLBACK
[0m02:56:20.249074 [debug] [Thread-1 (]: On test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8: Close
[0m02:56:20.250907 [info ] [Thread-1 (]: 3 of 4 PASS relationships_manifestation_episode_uid__uid__ref_episode_ ......... [[32mPASS[0m in 0.07s]
[0m02:56:20.252446 [debug] [Thread-1 (]: Finished running node test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8
[0m02:56:20.253890 [debug] [Thread-1 (]: Began running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m02:56:20.255034 [info ] [Thread-1 (]: 4 of 4 START test unique_merged_episode_uid .................................... [RUN]
[0m02:56:20.256917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_poc.relationships_manifestation_episode_uid__uid__ref_episode_.45de492fc8, now test.dbt_poc.unique_merged_episode_uid.71e270e35b)
[0m02:56:20.258099 [debug] [Thread-1 (]: Began compiling node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m02:56:20.267843 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m02:56:20.272801 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (compile): 02:56:20.258953 => 02:56:20.272249
[0m02:56:20.274031 [debug] [Thread-1 (]: Began executing node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m02:56:20.278525 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m02:56:20.281353 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m02:56:20.282537 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: BEGIN
[0m02:56:20.283702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:20.300347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:20.301909 [debug] [Thread-1 (]: Using postgres connection "test.dbt_poc.unique_merged_episode_uid.71e270e35b"
[0m02:56:20.303067 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_poc", "target_name": "dev", "node_id": "test.dbt_poc.unique_merged_episode_uid.71e270e35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    uid as unique_field,
    count(*) as n_records

from "dev_db"."public"."merged_episode"
where uid is not null
group by uid
having count(*) > 1



      
    ) dbt_internal_test
[0m02:56:20.307459 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:20.310838 [debug] [Thread-1 (]: Timing info for test.dbt_poc.unique_merged_episode_uid.71e270e35b (execute): 02:56:20.275086 => 02:56:20.310387
[0m02:56:20.312010 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: ROLLBACK
[0m02:56:20.313533 [debug] [Thread-1 (]: On test.dbt_poc.unique_merged_episode_uid.71e270e35b: Close
[0m02:56:20.316055 [info ] [Thread-1 (]: 4 of 4 PASS unique_merged_episode_uid .......................................... [[32mPASS[0m in 0.06s]
[0m02:56:20.318346 [debug] [Thread-1 (]: Finished running node test.dbt_poc.unique_merged_episode_uid.71e270e35b
[0m02:56:20.322539 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:20.323778 [debug] [MainThread]: On master: BEGIN
[0m02:56:20.324755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:20.341181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:20.342230 [debug] [MainThread]: On master: COMMIT
[0m02:56:20.343168 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:20.343925 [debug] [MainThread]: On master: COMMIT
[0m02:56:20.344956 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:20.345763 [debug] [MainThread]: On master: Close
[0m02:56:20.347269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:20.348066 [debug] [MainThread]: Connection 'test.dbt_poc.unique_merged_episode_uid.71e270e35b' was properly closed.
[0m02:56:20.349006 [info ] [MainThread]: 
[0m02:56:20.350509 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m02:56:20.353575 [debug] [MainThread]: Command end result
[0m02:56:20.374023 [info ] [MainThread]: 
[0m02:56:20.376312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:56:20.378001 [info ] [MainThread]: 
[0m02:56:20.379251 [error] [MainThread]:   Database Error in test merged_episode_test (tests/merged_episode_test.sql)
  syntax error at or near ")"
  LINE 32:     ) dbt_internal_test
               ^
  compiled Code at target/run/dbt_poc/tests/merged_episode_test.sql
[0m02:56:20.380869 [info ] [MainThread]: 
[0m02:56:20.382511 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m02:56:20.385162 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.7592726, "process_user_time": 5.423948, "process_kernel_time": 0.250163, "process_mem_max_rss": "114992", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m02:56:20.386856 [debug] [MainThread]: Command `dbt test` failed at 02:56:20.386550 after 2.76 seconds
[0m02:56:20.387984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7c00c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c80160f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c80004650>]}
[0m02:56:20.389146 [debug] [MainThread]: Flushing usage events
